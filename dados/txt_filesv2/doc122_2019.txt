Long Memory and Term Structure of Interest Rates

Fernanda C. Valente∗

M´arcio P. Laurini∗

Abstract

This article presents a modiﬁed version of Dynamic Nelson-Siegel term structure model with
long memory properties. The evolution of the latent factors is given by fractional Gaussian
noise (fGn) processes, which are approximated with a weighted sum of independent ﬁrst-
order autoregressive components, that can be represented as a Gaussian Markov Random
Field, allowing the use of computationally eﬃcient Bayesian methods. The purpose is to
assess if a long memory structure on the Dynamic Nelson-Siegel model helps to obtain
more accurate forecasts of the term structure of interest rates. We compare our model
with alternative speciﬁcations for the factors, including autoregressive and autoregressive
fractionally integrated models. The results indicate that long memory is indeed helpful for
longer forecasting horizons. However, the fGn components do not seem to improve short
horizon forecasts.

JEL: G12, C22, C11.

Keywords: Term Structure, Long Memory, Bayesian Forecasting, Laplace Approxima-
tions. ´Area de submiss˜ao: ´Area 8 - Microeconomia, M´etodos Quantitativos e
Finan¸cas

Resumo

Este artigo prop˜oe uma vers˜ao modiﬁcada do modelo Nelson-Siegel Dinˆamico com pro-
priedades de mem´oria longa. A evolu¸c˜ao dos fatores latentes ´e dada por processos de
ruido Gaussiano fracion´arios, aproximados por uma soma ponderada de processos autor-
regressivos de primeira ordem, que podem ser representados como um Campo Aleat´orio
Gaussiano Markoviano, permitindo o uso de m´etodos Bayesianos computacionalmente
eﬁcientes. O objetivo ´e avaliar se a inclus˜ao de mem´oria longa no modelo Nelson-Siegel
Dinˆamico contribui para obter previs˜oes mais acuradas para a estrutura a termo da taxa
de juros. O modelo proposto ´e comparado com especiﬁca¸c˜oes alternativas para os fatores,
como processos autorregressivos e processos autorregressivos com ordem de integra¸c˜ao
fracion´aria. Os resultados indicam que o componente de mem´oria longa ´e, de fato, ´util

∗Department of Economics - FEA-RP - Universidade de S˜ao Paulo. - Av. dos Bandeirantes 3900, 14040-905,
Ribeir˜ao Preto, SP, Brazil. Tel.: +55-16-33290867 - emails - fernanda.valente@usp.br and laurini@fearp.usp.br. The
authors also acknowledge the ﬁnancial support by CAPES, CNPq (303738/2015-4) and FAPESP (2018/04654-9).

1

para previs˜oes de longo prazo. Entretanto, componentes de persistˆencia longa n˜ao parecem
contribuir para previs˜oes de curto prazo.

Palavras-chave: Estrutura a termo, Mem´oria Longa, Previs˜oes Bayesianas, Aproxima¸c˜oes
de Laplace.

1 Introduction

The term structure of interest rates represents the relationship between the interest rates
and time to maturity, therefore, is a high-dimensional object, which often is not directly observed.
As discussed by Pooter, Ravazzolo and Dijk (2010), long yields are risk-adjusted averages of
expected future short rates, consequently, yields of diﬀerent maturities are related and move
together, in the cross-section as well as over time. At the same time, shocks in the economy tends
to cause diﬀerent eﬀects on long and short maturities. Furthermore, monetary policy authorities
are actively targeting the short end of the yield curve to achieve their macroeconomic goals.
Thus, it is easy to see that many forces are at work at moving interest rates. Understanding the
dynamic evolution of the yield curve and the construction of forecasts is important for many
tasks, such as bond portfolio management, derivatives pricing and risk management.

Hence, it is not surprising the meaningful number of researches dedicated to model
and forecast the term structure of interest rates. Nevertheless, it is not an easy task and, it is
not diﬃcult to ﬁnd in ﬁnancial literature simple random walk forecasts more accurate than
theoretically sophisticated models (see Duﬀee (2002)). As discussed by Carriero, Kapetanios
and Marcellino (2012), the existing methods for producing forecasts of the term structure of
the interest rates can be roughly categorized in three groups: models based on forward rate
regressions (Fama and Bliss (1987) and Cochrane and Piazzesi (2005)), models based on the
No-arbitrage paradigm (Duﬀee (2002)) and a class of models that uses the Nelson and Siegel
(1987) exponential components framework (Diebold and Li (2006) and Christensen, Diebold
and Rudebusch (2011)).

The Nelson-Siegel class is due to Nelson and Siegel (1987), who proposed ﬁt the term
structure of interest rates adopting a ﬂexible, smooth parametric function. The model proposed
by Nelson and Siegel (1987) has been widely explored in the literature because it has some
desirable characteristics, according to Diebold and Rudebusch (2013). Parsimony and ﬂexibility
are appealing features because it promotes smoothness and allows the yield curve to assume a
variety of shapes at diﬀerent times. Moreover, Diebold and Rudebusch (2013) comment that
from a mathematical point of view, the form proposed by Nelson and Siegel (1987) is far from
arbitrary. In fact, the forward rate curve is a constant plus a Laguerre function.

A step further, Diebold and Li (2006) suggest the Dynamic Nelson-Siegel (DNS) model.
They used the Nelson-Siegel form with time-varying parameters, introducing dynamics in the
model. According to Diebold and Rudebusch (2013), the DNS model distills the yield curve
into three dynamic, latent factors, providing interpretations corresponding to level, slope, and
curvature of the interest rates. The evolution of the latent factors is modeled as either an
autoregressive (AR) model for each individual latent factor or as a vector autoregressive (VAR)
model for the three latent factors, simultaneously. Diebold and Li (2006) show that AR forecasts
performs better than many alternatives, including the VAR speciﬁcation.

Due to good results of Diebold and Li (2006), many papers have been developed in
diﬀerent dynamic approaches of Nelson-Siegel and deliver good results in terms of forecasting.
For example, Koopman, Mallee and Wel (2010) propose to introduce time-varying loading and
variance parameters, Pooter (2007) adds a second slope factor and Diebold, Li and Yue (2008)

2

extend the DNS model to a global context, modeling to a large set of country yield curves in a
framework that allows for both global and country-speciﬁc factors.

However, as pointed out by Zivot and Wang (2007), many macroeconomic and ﬁnancial
time series like nominal and real interest rates, real exchange rates, interest rates diﬀerentials
and volatility measures are very persistent. The AR speciﬁcation, proposed by Diebold and
Li (2006), albeit a good forecast performance compared with alternative models, often cannot
capture the high degree of persistence in time series. Evidences of the presence of long memory
in interest rates can be found in Backus and Zin (1993), Couchman, Gounder and Su (2006),
Tsay (2000) and Goli´nski and Zaﬀaroni (2016).

One way to model persistence is by long memory dependency structures. Long memory
process can be characterized in terms of the autocorrelation function that decays slowly at
a hyperbolic rate. In fact, long memory implies that the autocorrelations are not absolutely
summable (Palma (2007)). Fractional Brownian motion (fBm) are particularly useful to model
long range dependency structures. The fBm is a self-similar continuous-time Gaussian process,
with stationary increments. The increment process of fBm is deﬁned as fractional Gaussian
noise (fGn), which is stationary and a parsimoniously parameterized model, with dependency
structure characterized by the Hurst exponent H, that gives long memory when 1/2 < H < 1
(Sørbye, Myrvoll-Nilsen and Rue (2017)).

Recognizing that the notion of long memory permits to obtain a degree of persistence,
we purpose to modify the structure of DNS latent factors to embody persistence into the model,
using an approximation for a fGn process, proposed by Sørbye, Myrvoll-Nilsen and Rue (2017).
The key point of the approximate fGn model is the possibility to represent it as a Gaussian
Markov random ﬁeld (GMRF). This representation allows to obtain Bayesian estimates of the
latent factors and the parameter H through the Integrated Nested Laplace Approximations
(INLA) method, proposed by Rue, Martino and Chopin (2009). According to Laurini and
Hotta (2014), the INLA method provides accurate analytical approximations for the posterior
distribution of the latent factors parameters in generalized Gaussian models without the need
for procedures such as numerical simulation methods based on Markov Chain Monte Carlo
(MCMC).

In this paper we assess the extent to which a persistence component on the Dynamic
Nelson-Siegel model provides additional forecasting gains in relation to DNS model with alter-
native speciﬁcation for the factors, including ﬁrst order autoregressive model and autoregressive
fractionally integrated moving average model. The data set considered consists of time series
of monthly unsmoothed Fama-Bliss US Treasury zero-coupon yields from January 1985 until
December 2000, for maturities of 3, 6, 9, 12, 15, 18, 21, 30, 36, 48, 60, 72, 84, 96, 108, 120 months,
and Interbank Deposits (Dep´ositos Interbanc´arios - DI ) Futures in Brazil, from January 2003
until August 2017, for maturities from 1 to 72 months. We adopt a rolling estimation to obtain
out-of-sample forecasts for 1-month, 6-months and 12-months ahead. Moreover, we evaluate
forecasting accuracy by root mean squared error (RMSE). The results suggest that, considering
a short forecast horizon, the persistence component do not seem to improve forecasts accuracy.
However, it is possible to see that when longer forecasting horizon is considered, a persistence
component appears to be helpful.

This article is organized as follow. Section 2 contains a description of the DNS model
with long memory. Section 3 brieﬂy summarizes the INLA method. Section presents the results
of the estimation and forecasts. Section 5 concludes.

3

2 Dynamic Nelson-Siegel model

Following Diebold and Li (2006), the DNS model can be represented by a state-space
interpretation. The model can be formulated through a measurement equation for the observed
yield curve, written as

and the transition equations, which represents the latent factors dynamics:

yt(τ) = β1t + β2t

+ t(τ)

!

τ λ

 1 − e−τ λ
 µ1
 =

+ β3t

!
 + φ

τ λ

 1 − eτ λ
 + βt
 β1t−1

− e−τ λ

β2t−1
β3t−1

µ2
µ3

 β1t

β2t
β3t

(1)

(2)

where yt(τ) represents the yield vector, the parameters βit, i = 1, 2, 3, are the latent factors with
interpretations of level, slope and curvature, respectively, and λ is the decay parameter. Finally,
t(τ) and βt are innovations process of the measurement and transition equations, respectively.
Under the assumption that the shocks t(τ) and βt are independent Gaussian process
and the decay parameter λ is constant and known, the state space representation becomes
Gaussian and linear, allowing a simple estimation in two-steps, as proposed by Diebold and Li
(2006). In this method, in the ﬁrst stage, with λ held ﬁxed, it is possible to estimate the level,
slope and curvature parameters through a linear regression for each monthly yield curve and, in
the second stage, model the dynamic of the latent factors through a ﬁrst-order autoregressive
model to the time series of the factors obtained in the ﬁrst stage.

Alternatively, one can assume that the decay parameter λ is constant but unknown. In
order to obtain inferences about the parameters and the latent factors, maximum likelihood
estimation via Kalman ﬁlter can be adopted, as used, for example, in Diebold, Rudebusch and
Aruoba (2006).

2.1 Long Memory Dynamics in DNS framework

2.1.1 Autoregressive fractionally integrated moving average (ARFIMA) model

The AR model often used to determine the evolution of the latent factors cannot capture
the highly persistence of interest rates. Alternatively, the evolution of the latent factors can
be modeled as a stationary process with long memory. According to Zivot and Wang (2007), a
stationary process yt has long memory if its autocorrelation function satisﬁes

(3)
as k → ∞ and C1 is a positive constant. Therefore, the autocorrelation function of a long
memory process decays slowly at a hyperbolic rate, i.e., so slowly that are not summable:

γ(h) ∼ C1hH−1

∞X

k=−∞

γ(h) = ∞.

(4)

An approach is to model the DNS latent factors as an autoregressive fractionally integrated
moving average (ARFIMA) model. According to Palma (2007), an ARFIMA {yt} process can
be deﬁned by

φ(B)yt = θ(B)(1 − B)−dt,

(5)

4

where B is a lag operator and φ(B) and θ(B) are the autoregressive and moving average
operators, respectively. Plus, φ(B) and θ(B) have no common roots, (1 − B)−d is a fractional
diﬀerencing operator deﬁned by the binomial expansion

(1 − B)−d =

ηjBj = η(B)

∞X

j=0

ηj = Γ(j + d)

Γ(j + 1)Γ(d),

(6)

(7)

where

for d < 1/2, d 6= 0,−1,−2, . . ., and {t} is a white noise process with ﬁnite variance.

It is important to note that long memory processes are not Markovian, thus, all the state
space representations are inﬁnite dimensional and, therefore the estimation is not straightforward.

2.1.2 Fractional Gaussian noise

An alternative way of introducing long persistence is through the use of fractional
Gaussian noise. Although conceptually diﬀerent, ARFIMA and fGn are related processes,
especially when the autoregressive and the moving average order of ARFIMA are zero. The
use of a fGn is interesting in the context of state space modeling since it is possible to obtain a
Markovian representation for this process, which allows one-step estimation of the DNS model
with long memory. Following Sørbye, Myrvoll-Nilsen and Rue (2017) is possible to approximate
fGn model by an aggregated model of a few AR(1) components and take advantages of this
approach.

The evolution of the DNS latent factors with fGn dynamics is given by:

βit = f Gn(H, τ),

i = 1, 2, 3,

(8)

where f Gn is a fractional Gaussian noise deﬁned by its autocorrelation function

γ(h) = 1

2(|h + 1|2H − 2|h|2H + |h − 1|2H),

(9)
where H ∈ (0, 1) is referred to as the Hurst exponent (or self-similarity parameter) and τ denotes
the precision parameter. Note that the fGn reduces to uncorrelated white noise when H = 0.5.
If H > 0.5 the process has positive correlation, and, similarly, if H < 0.5, the autocorrelation is
negative. In this work we allow each latent factor to have a distinct H parameter.

h = 0, . . . , n − 1,

Sørbye, Myrvoll-Nilsen and Rue (2017) propose to approximate fGn model with a
weighted sum of independent ﬁrst-order autoregressive process, which can be represented as
a Gaussian Markov Random Field. In their approach, they propose to ﬁt the weights and the
coeﬃcients of the approximation to mimic the autocorrelation function (9) of a fGn.

Consider m independent AR(1) process

zj,t = φzzj,t−1 + νj,t,

j = 1, . . . , m,

t = 1, . . . , n,

(10)

where 0 < φj < 1 denotes the ﬁrst-order autoregressive parameter of the jth process. In addition,
let νj,t be independent zero-mean Gaussian shocks with variance σ2
j . Deﬁne the
cross-sectional aggregation of the m processes as
√

ν,j = 1 − φ2

mX

¯xm = σ

wjz(j),

(11)

j=1

5

where z(j) = (zj,1, . . . , zj,n)T and the weights wj sum to one. This implies that var(¯xm) = σ2.
The autocorrelation function of (11) is given by

γ¯xm(h) =

|h|
j ,

wjφ

h = 0, 1, . . . , n − 1.

(12)

mX

j=1

j=1 and the autocorrelation coeﬃcients φ = {φj}m

The idea proposed by Sørbye, Myrvoll-Nilsen and Rue (2017) is to ﬁt the weights w =
{wj}m
j=1 in (11) to match the autocorrelation
function of fGn process as in (9). In order to obtain values of (w, φ), the weighted squared error
is minimized

(w, φ)H = argmin
(w,φ)

(γ¯xm(h) − γx(h))2,

(13)

hmaxX

h=1

1
h

where hmax represents an arbitrary upper limit to the number of lags included1. The key point
of this approximation of the fGn process is the possibility to represent the DNS model with
long memory as a latent GMRF, which allow us to estimate it using the INLA method.

3 Integrated Nested Laplace Approximations

The INLA method, proposed by Rue, Martino and Chopin (2009), provides accurate and
eﬃcient approximations on Bayesian hierarchical models that can be represented as a latent
Gaussian model (LGN), focuses on models known as Gaussian Markov random ﬁeld (GMRF).

A latent GMRF model is a hierarchical model with the ﬁrst stage deﬁning a distributional
assumption for the observed variable y, usually assumed to be conditionally independent given
the latent factors x and some additional parameter θ

π(yj|xj, θ),

j ∈ J

(14)

where yj with j ∈ J, are observed values and J is a subset of the latent factors; and π(y|x, θ) is
a likelihood function of observed variables. The latent parameter constitutes the second stage,

xi = Oﬀseti +

ωkifk(cki) + zT

i β + i,

i = 0, . . . , ηx − 1

(15)

π(y|x, θ) =Y

j

ηf−1X

k=0

where Oﬀset is a prior known component to be included in the linear prediction; ωk are known
weights for each observed data point; fk(cki) is the eﬀect of generic covariates with value cki for
observation i; β are the regression parameters of linear covariates zi. Finally, the third stage of
the model consists of the prior distribution for the hyperparameters θ.

The INLA approach obtains accurate approximations of the posterior distributions of

the latent factors, written as

π(xi|Y ) =

Z

and the marginal posterior distribution of hyperparameters, given by

π(xi|θ, Y )π(Θ, Y )dθ
Z

π(θ|Y )dθ j

π(θj|Y ) =

(16)

(17)

where θ j denotes the vector θ without its jth element. In practice, the INLA method can be
implemented in three steps. The ﬁrst step is to obtain an approximation to the full posterior

1 See Sørbye, Myrvoll-Nilsen and Rue (2017) for more details on the implementation.

6

distribution π(θ|y) by Laplace approximation. The second step is to ﬁnd an approximation to
the full conditional distributions π(xi|θ, y) for particular values of θ. The last step is to obtain
the marginal posterior distributions in (16) and (17) by combining the two approximations in
the previous steps and integrating out the irrelevant factors2.

In this work we use an estimation structure generalizing the method of Laurini and Hotta
(2014), which propose the use of INLA to estimate and forecast the term structure of interest
rates. In the same way as this work, we use an additive structure where the decay λ parameter
is kept ﬁxed and determined before the estimation process. The use of a ﬁxed λ parameter is
necessary due to the need for an additive structure in the measurement equation. To directly
measure the impact of the long memory structure on predictions for the term structure of
Treasury Bonds we ﬁrst use the same λ value used in Diebold and Li (2006), and after the
generalized cross validation procedure proposed in Laurini and Hotta (2014) to obtain the
optimal λ parameter. The analysis for the DI Futures contracts is based on the optimal choice
λ by generalized cross validation.

4 Results

4.1 Fama-Bliss US Treasury zero-coupon data - Full Sample Analysis

In order to compare the DNS with long memory and the AR(1) speciﬁcation proposed by
Diebold and Li (2006), we use the same database of time series of monthly unsmoothed Fama-
Bliss US Treasury zero-coupon yields from January 1985 until December 2000, for maturities
of 3, 6, 9, 12, 15, 18, 21, 24, 30, 36, 48, 60, 72, 84, 96, 108, 120 months. Figure 1 shows a
three-dimensional plot of the yields used in this paper.

Figure 1 – Unsmoothed Fama-Bliss US Treasury zero-coupon yields. January 1985 - December

2000

2 See Rue, Martino and Chopin (2009) for more details.

7

Time50100150Matirity in months20406080100120% Yield46810Assuming that the parameter λ is constant and known, we follow Diebold and Li (2006),
assuming the value of λ being equal to 0.0609. Under this assumption, we estimate a DNS
model with long memory, as described in section 2, using the INLA method. Following Sørbye,
Myrvoll-Nilsen and Rue (2017), we adopt three independent AR(1) process to approximate
the fGn model. According to equation (8), the fGn process has two parameters, τ and H. The
marginal precision, τ , is represented as

τ = exp(θ1)

and the Hurst parameter H is represented as

H = 1

2 + 1
2

!

  exp(θ2)

1 + exp(θ2)

and the prior is deﬁned on the hyperparameters θ1 and θ2. Speciﬁcally

θ1 ∼ pcprior(3, 0.01)
θ2 ∼ pcpriorf orf Gn(0.9, 0.1).

(18)

(19)

where pc prior refers to the family of penalized complexity priors for the fGn process introduced
in Sørbye and Rue (2018).

Table 1 contains results about the posterior distributions obtained for the precision of
the Gaussian observations, the Hurst exponent H and the precision for the latent factors. The
mean of the parameters H for β1t, β2t and β3t lie inside 1/2 and 1, consistent with persistent
patterns often found in ﬁnancial time series. In addition, we created 95% credibility intervals,
based on the empirical quantiles of 0.025 and 0.975 of the posterior distributions, also reported
in Table 1. Finally, Figures 2 and 3 shows the posterior distributions of Hurst exponent and
precision parameters of latent factors, respectively.

Table 1 – Summary Hyperparameters

Precision τ for Gaussian obs.
Precision τ1 for β1t
H for β1t
Precision τ2 for β2t
H for β2t
Precision τ3 for β3t
H for β3t

Mean
197.788
0.084
0.997
0.153
0.993
0.155
0.979

SD 0.025 quant.
5.369
0.037
0.001
0.075
0.004
0.072
0.010

187.501
0.030
0.994
0.049
0.984
0.053
0.955

0.5 quant.

197.697
0.078
0.997
0.140
0.993
0.142
0.981

0.975 quant. Mode
197.494
0.065
0.998
0.112
0.995
0.117
0.985

208.589
0.175
0.999
0.336
0.998
0.331
0.994

8

Figure 2 – Posterior distribution of Hurst exponents. (a) H(β1t); (b) H(β2t); (c) H(β3t)

(a) H(β1t)

(b) H(β2t)

(c) H(β3t)

Figure 3 – Posterior distribution of precision parameters. (a) τ1 precision β1t; (b) τ2 precision

β2t; (c) τ3 precision β3t

(a) τ1 precision for β1t

(b) τ2 precision for β2t

(c) τ3 precision for β3t

9

0.850.900.951.00050100150200250300350Probability0.60.70.80.91.0020406080100120Probability0.60.70.80.91.0010203040Probability012345024681012Probability0510152025012345Probability05101520253001234Probability4.2 Out-of-sample Forecasts

We compare out-of-sample forecasting performance of the DNS model considering three
diﬀerent speciﬁcations for the latent factors: AR(1), ARFIMA(0,d,0) and fGn. The models will be
denominated DNS-AR(1), DNS-ARFIMA and DNS-fGn henceforward. We assess out-of-sample
1-month, 6-months and 12-months ahead forecasting for maturities of 3 months and 1, 3, 5 and
10 years.

The DNS-fGn model is estimated Bayesian using INLA, following the methodology
proposed in Laurini and Hotta (2014) and its modiﬁcation to the fGn process proposed in
our article. The estimation of the ARFIMA model is based on a modiﬁcation of the two-step
estimation method proposed in Diebold and Li (2006), where in the case we used an ARFIMA
process in the second estimation step, where the dynamics of the time series of Betas estimated
in the ﬁrst step (cross-section in each day) is modeled by an ARFIMA process estimated by the
maximum-likelihood method based on the Whittle estimator.

Tables 2, 3 and 4 report the RMSE for each of the forecasting models, and each of the
forecasting horizons. Moreover, following the same structure as Diebold and Li (2006), Tables 2,
3 and 4 shows the mean, standard deviation and autocorrelations of forecast errors.

Table 2 – Out of Sample 1-Month Ahead Forecasting Results

Mean

Std.Dev RMSE ACF1

ACF12

Dynamic Nelson-Siegel with AR(1) Factor Dynamics
3 months
1 year
3 years
5 years
10 years

-0.036
0.033
-0.047
-0.081
-0.053

0.275
0.449
0.352
0.352
0.269

0.172
0.236
0.276
0.288
0.257

0.169
0.235
0.274
0.278
0.253

0.013
-0.227
-0.132
-0.128
-0.115

Dynamic Nelson-Siegel with fGn Factor Dynamics
3 months
1 year
3 years
5 years
10 years

0.005
0.049
-0.086
-0.156
-0.169

0.618
0.700
0.648
0.661
0.623

0.197
0.293
0.342
0.375
0.351

0.198
0.291
0.333
0.343
0.310

-0.037
-0.214
-0.213
-0.246
-0.213

Dynamic Nelson-Siegel with ARFIMA(0,d,0) Factor Dynamics
3 months
1 year
3 years
5 years
10 years

0.005
0.039
-0.108
-0.182
-0.197

-0.059
-0.202
-0.212
-0.248
-0.218

0.714
0.752
0.708
0.720
0.692

0.222
0.321
0.376
0.411
0.387

0.224
0.320
0.362
0.371
0.335

10

Table 3 – Out of Sample 6-Month Ahead Forecasting Results

Mean

Std.Dev RMSE ACF6

ACF18

Dynamic Nelson-Siegel with AR(1) Factor Dynamics
3 months
1 year
3 years
5 years
10 years

-0.056
-0.031
-0.220
-0.336
-0.410

0.378
0.153
0.004
0.037
0.009

0.542
0.664
0.765
0.813
0.765

0.543
0.668
0.737
0.745
0.650

-0.242
-0.190
-0.219
-0.247
-0.253

Dynamic Nelson-Siegel with fGn Factor Dynamics
3 months
1 year
3 years
5 years
10 years

0.076
0.043
-0.242
-0.409
-0.533

0.440
0.225
0.091
0.106
0.117

0.541
0.663
0.774
0.846
0.850

0.539
0.666
0.740
0.746
0.666

-0.258
-0.189
-0.215
-0.260
-0.252

Dynamic Nelson-Siegel with ARFIMA(0,d,0) Factor Dynamics
3 months
1 year
3 years
5 years
10 years

0.068
0.026
-0.268
-0.436
-0.560

-0.242
-0.177
-0.207
-0.255
-0.250

0.457
0.240
0.099
0.111
0.125

0.554
0.673
0.787
0.861
0.866

0.553
0.676
0.745
0.747
0.665

Table 4 – Out of Sample 12-Month Ahead Forecasting Results

Mean

Std.Dev RMSE ACF12

ACF24

Dynamic Nelson-Siegel with AR(1) Factor Dynamics
3 months
1 year
3 years
5 years
10 years

-0.248
-0.322
-0.654
-0.856
-1.030

-0.065
-0.099
-0.182
-0.187
-0.228

0.785
0.860
1.069
1.214
1.277

0.750
0.803
0.851
0.867
0.761

-0.084
-0.070
-0.076
-0.093
-0.138

Dynamic Nelson-Siegel with fGn Factor Dynamics
3 months
1 year
3 years
5 years
10 years

0.040
-0.064
-0.439
-0.660
-0.851

-0.145
-0.230
-0.302
-0.321
-0.332

0.656
0.696
0.867
1.008
1.094

0.660
0.698
0.753
0.767
0.692

-0.130
-0.088
-0.058
-0.077
-0.121

Dynamic Nelson-Siegel with ARFIMA(0,d,0) Factor Dynamics
3 months
1 year
3 years
5 years
10 years

0.029
-0.085
-0.470
-0.693
-0.885

-0.133
-0.091
-0.059
-0.079
-0.124

-0.121
-0.210
-0.288
-0.311
-0.320

0.671
0.707
0.886
1.029
1.118

0.675
0.707
0.756
0.766
0.689

According to Table 2, our empirical evidence suggests that when a short forecasting
horizon is considered, the DNS-AR factor dynamics performs more accurate forecasts compared

11

to the ARFIMA and fGn speciﬁcations, for all maturities. In addition, DNS-fGn has better
performance in relation to DNS-ARFIMA, for all maturities.

When longer forecasting horizons are considered (6-months and 12-months ahead), the
DNS-fGn are competitive and, in some dimensions, superior to DNS-AR and DNS-ARFIMA. For
6-months ahead, the DNS-fGn shows the lowest RMSE for shorter maturities, whereas, DNS-AR
forecasts are more accurate for maturities higher than 3 years. Results are shown in Table 3.
However, considering 12-months ahead forecasting, the DNS-fGn performance is clearly superior
than DNS-AR and DNS-ARFIMA, for all maturities. In addition, DNS-ARFIMA forecasts are
also more accurate than those from DNS-AR, for all maturities. Table 4 reports the results.

In summary, our results suggest that when a short horizon is considered, a persistence
component on DNS model do not provide forecasting gains, i.e., the DNS-AR forecasts are
more accurate than those from DNS-fGn and DNS-ARFIMA. However, when longer forecasting
horizons are considered, both, DNS-fGn and DNS-ARFIMA allows accurate forecasts.

4.3 Optimal selection of λ parameter

As discussed in Laurini and Hotta (2014), the use of the INLA approach is based on a
linear additive structure in the state space form, and similarly to the methodology of Diebold
and Li (2006), we must assume that the parameter λ is known to perform the estimation of the
dynamic Nelson-Siegel model using this methodology. To circumvent this limitation, Laurini
and Hotta (2014) propose the use of a generalized cross-validation mechanism to determine the
optimal value of the λ parameter.

We repeat here the fundamentals of this procedure. The idea is to choose the parameter
λ as an optimization problem by ﬁnding the value of λ which maximizes some measure of model
ﬁt. In this work we use as a measure the cross-validated log-score of the model. We can calculate
measures of generalized cross validation using INLA without having to re-estimate the model for
each observation left out in the cross validation procedure. The conditional predictive ordinates
(CPO) relative to the observation yi, conditional on the full sample, except for this observation,
is given by:

CP Oi = π(yobs

i

|y−1),

and the CPO of observation i is obtained as:

Z

CP Oi =

π(yobs

i

|y−1, θ)π(θ|y−i)dθ

with the ﬁrst term in this integral represented by:

π(yobs

i

|y−1) = 1/

Z

π(xi|y, θ)
|xi, θ)
π(yobs

i

(20)

(21)

(22)

and calculated by numerical integration. The leave-one-out cross-validation likelihood (cross-
validated log-score) is deﬁned as:

LSCV =

−log(CP Oi).

(23)

nX

i=1

With this approximation we can estimate the optimal λ parameter optimizing the cross-
validated log-score model using a numerical minimization algorithm. In this problem we use

12

a box constrained BFGS optimization method. We apply this method to select the optimal λ
parameter for the ﬁrst estimation sample for the Bayesian estimation with the fGn process in
the forecasting procedure, and maintain this ﬁxed value for the other forecast periods. The
estimated optimal value was 0.1482749, and the out-of-sample forecast results with this value
are shown in Table 5.

Table 5 – Forecasting results with optimal selection of λ for the Dynamic Nelson-Siegel with

fGn factor dynamics - λ = 0.1482749

Mean

Std.Dev RMSE ACF12 ACF24

Out of Sample 1-Month Ahead Forecasting Results
3 months
1 year
3 years
5 years
10 years

0.016
0.054
-0.112
-0.164
-0.150

0.211
0.290
0.324
0.340
0.327

0.211
0.294
0.341
0.375
0.358

0.653
0.685
0.645
0.662
0.649

-0.072
-0.192
-0.215
-0.238
-0.174

Out of Sample 6-Month Ahead Forecasting Results
3 months
1 year
3 years
5 years
10 years

0.064
0.062
-0.291
-0.429
-0.492

0.531
0.676
0.725
0.738
0.687

0.531
0.675
0.777
0.849
0.841

0.439
0.215
0.097
0.111
0.111

-0.260
-0.178
-0.227
-0.266
-0.232

Out of Sample 12-Month Ahead Forecasting Results
3 months
1 year
3 years
5 years
10 years

0.015
-0.036
-0.500
-0.686
-0.796

-0.139
-0.237
-0.297
-0.317
-0.339

0.641
0.703
0.897
1.025
1.058

0.646
0.707
0.750
0.767
0.702

-0.137
-0.082
-0.067
-0.082
-0.106

The use of this optimal selection procedure leads to forecasting gains, using the RMSE
metric, for some forecasting maturities and horizons. For example, we obtain improvements in
this criterion for 9 of the 15 combinations of forecast-maturity horizons analyzed by Dynamic
Nelson-Siegel with fGn model. In the other comparisons the value of λ proposed by Diebold
and Li (2006) seems to be robust in terms of predictive performance.

4.4 Brazilian DI Futures Term Structure

We performed a second application of the proposed model, using the term structure
of Interbank Deposits (DI) Futures contracts in Brazil. This is the most important market
of interest curves in Brazil, and is the main reference of term structure. This application is
particularly interesting since the interest rate market in Brazil is subject to several regime
changes and possible structural breaks, and in this case the use of a long memory structure can
be a parsimonious way of constructing forecasts in this context.

We used in this analysis monthly data for the period January 2003 through August
2017 (176 observations) constructed from the daily data of DI operations at B3, using the
end-of-period value as a month observation. The data were interpolated using cubic spline for a
set of 17 maturities ranging from 1 to 72 months. Figure 4 shows the evolution of the interest
curve used in this study, and the table 6 shows some descriptive statistics of this data set.

13

Figure 4 – DI Futures - January 2003 - August 2017

Table 6 – Descriptive Statistics - DI Futures - January 2003 - August 2017

Mean Std.Dev
4.143
4.100
4.020
3.966
3.939
3.915
3.896
3.893
3.905
3.931
3.967
4.007
4.047
4.118
4.245
4.088
4.531

1 M 12.998
3 M 12.976
6 M 12.979
9 M 13.012
12 M 13.078
15 M 13.157
18 M 13.235
21 M 13.306
24 M 13.376
27 M 13.436
30 M 13.486
33 M 13.533
36 M 13.578
40 M 13.640
48 M 13.725
60 M 13.717
72 M 13.906

Max Min
6.973
7.035
7.066
7.084
7.148
7.224
7.397
7.593
7.761
7.908
7.998
8.097
8.202
8.333
8.448
8.683
8.812

26.819
27.577
28.246
28.664
29.328
30.264
31.180
32.168
33.236
34.184
35.095
35.931
36.733
37.993
39.650
40.341
40.725

We performed a prediction experiment similar to that performed with the data from
Fama-Bliss Treasury Bonds data, making forecasts 1, 6 and 12 months-ahead. We used as
the initial sample of estimation the period from 2003-01 to 2014-09 (140 months), and from
that date increased one month at time, constructing the forecasts, and similarly followed this
procedure until the end of the sample. For space issues we show only the predictive performance
measures for using Dynamic Nelson-Siegel with AR(1) factor dynamics estimated by OLS and

14

Values0.100.150.200.250.300.350.402003/012005/012007/012009/012011/012013/012015/012017/011 M3 M6 M9 M12 M15 M18 M21 M24 M27 M30 M33 M36 M40 M48 M60 M72 Mthe Bayesian model using fGn as described in the methodology section. We used a λ value
of 0.07317 for the two estimation methodologies, which is determined by the cross-validation
criterion described in the 4.3 section.

Table 7 – Out of Sample 1-Month Ahead Forecasting Results - DI Futures

Mean

Std.Dev RMSE ACF1 ACF12

Dynamic Nelson-Siegel with AR(1) Factor Dynamics
3 months
9 months
27 months
33 months
72 months

0.133
0.095
-0.050
-0.042
-0.100

0.439
0.890
0.807
0.785
0.844

0.768
0.828
0.646
0.614
0.607

0.425
0.898
0.817
0.796
0.850

-0.043
0.020
-0.021
-0.024
-0.027

Dynamic Nelson-Siegel with fGn Factor Dynamics
3 months
9 months
27 months
33 months
72 months

0.097
-0.025
-0.205
-0.190
-0.196

0.676
1.061
0.967
0.942
0.967

0.875
0.874
0.770
0.755
0.751

0.678
1.076
0.959
0.936
0.961

-0.043
0.020
-0.051
-0.070
-0.118

Table 8 – Out of Sample 6-Month Ahead Forecasting Results - DI Futures

Mean

Std.Dev RMSE ACF6 ACF18

Dynamic Nelson-Siegel with AR(1) Factor Dynamics
3 months
9 months
27 months
33 months
72 months

0.617
0.144
-0.199
-0.183
-0.126

1.783
2.235
2.265
2.240
2.136

0.223
0.347
0.263
0.213
0.097

1.701
2.269
2.295
2.270
2.169

-0.258
-0.410
-0.426
-0.406
-0.346

Dynamic Nelson-Siegel with fGn Factor Dynamics
3 months
9 months
27 months
33 months
72 months

0.436
-0.116
-0.519
-0.509
-0.447

2.031
2.467
2.450
2.409
2.260

0.278
0.396
0.345
0.303
0.197

2.017
2.507
2.436
2.395
2.253

-0.297
-0.426
-0.445
-0.426
-0.365

15

Table 9 – Out of Sample 12-Month Ahead Forecasting Results - DI Futures

Mean

Std.Dev RMSE ACF12 ACF24

Dynamic Nelson-Siegel with AR(1) Factor Dynamics
3 months
9 months
27 months
33 months
72 months

-0.311
-0.297
-0.316
-0.322
-0.348

1.324
0.464
-0.004
0.010
0.030

2.496
2.946
3.039
2.991
2.708

2.161
2.972
3.105
3.055
2.766

Dynamic Nelson-Siegel with fGn Factor Dynamics
3 months
9 months
27 months
33 months
72 months

0.577
-0.340
-0.799
-0.769
-0.658

-0.223
-0.255
-0.296
-0.304
-0.328

2.393
2.981
3.091
3.029
2.734

2.373
3.026
3.050
2.993
2.710

Figure 5 – Estimated Latent Factors - DNS-AR(1) and DNS-fGn - DI-Futures - January 2003 -

August 2017

Tables 7-9 show the predictive performance measures for this data set. In a similar way
to the results obtained with the data of Treasury Bonds, the results show that the methodology
based on the AR(1) dynamics for latent factors and OLS estimation has better performance
for short maturities and short horizons (1 and 6 months) while the Bayesian method using the
fractional Gaussian noise structure for latent factors presents a superior performance in terms
of RMSE for the 12-month forecast horizon and the longest maturities in the sample (27, 33
and 72 months).

16

Values10203040502003/012004/012005/012006/012007/012008/012009/012010/012011/012012/012013/012014/012015/012016/012017/01Beta_1 FGNBeta_1 AR1Values10203040502003/012004/012005/012006/012007/012008/012009/012010/012011/012012/012013/012014/012015/012016/012017/01Beta_2 FGNBeta_2 AR1Values−20−10052003/012004/012005/012006/012007/012008/012009/012010/012011/012012/012013/012014/012015/012016/012017/01Beta_1 FGNBeta_3 AR1To show a comparison between latent factors estimated using the two methods, we show
in Figure 5 the estimated factors using the complete sample of DI data. We can observe that
the estimated factors are very similar, and the main diﬀerences occur in the construction of the
forecasts outside the sample of these factors.

Conclusions

In this paper we propose a diﬀerent speciﬁcation for the factor dynamics of the Dynamic
Nelson-Siegel model in order to embody long range persistence into the model. The main goal
is to assess if a long memory component helps to obtain more accurate forecasts of the term
structure of interest rates. The evolution of the latent factors are given by a fractional Gaussian
noise, which is approximated with a weighted sum of independent ﬁrst-order autoregressive
process, that can be represented as a Gaussian Markov Random Field, and through this approach,
Integrated Nested Laplace Approximations method was used to obtain the Bayesian estimation
of the parameters.

We compare our model with alternative speciﬁcations for the latent factors in the analysis
of the Fama-Bliss dataset: ﬁrst order autoregressive model and autoregressive fractionally
integrated moving average model. For 3-months ahead, the DNS model with AR(1) factor
dynamics outperform DNS with fGn and DNS with ARFIMA(0,d,0), for all maturities. However,
for 6-months ahead, the fGn speciﬁcation shows the lowest RMSE for shorter maturities,
whereas, DNS with AR(1) forecasts are more accurate for maturities higher than 3 years. Finally,
considering 12-months ahead forecasting, the DNS with fGn dynamics presents good forecasting
properties, superior to the AR(1) and ARFIMA(0,d,0) speciﬁcations, for all maturities. The
analysis for the DI Futures term structure show similar results, with a better forecasting
performance for the DNS-AR(1) for short forecasting horizons and a more favorable performance
to the DNS-fGn model in the longer forecasting horizon and maturities. Therefore, we provide
evidence that long memory is indeed helpful for longer forecasting horizons.

Bibliography

BACKUS, D. K.; ZIN, S. E. Long-memory inﬂation uncertainty: Evidence from the term
structure of interest rates. Journal of Money, Credit and Banking, [Wiley, Ohio State
University Press], v. 25, n. 3, p. 681–700, 1993. ISSN 00222879, 15384616. Available at:
<http://www.jstor.org/stable/2077735>.

CARRIERO, A.; KAPETANIOS, G.; MARCELLINO, M. Forecasting government bond yields
with large Bayesian vector autoregressions. Journal of Banking & Finance, Elsevier, v. 36, n. 7,
p. 2026–2047, 2012.

CHRISTENSEN, J. H.; DIEBOLD, F. X.; RUDEBUSCH, G. D. The aﬃne arbitrage-free class
of Nelson–Siegel term structure models. Journal of Econometrics, Elsevier, v. 164, n. 1, p. 4–20,
2011.

COCHRANE, J. H.; PIAZZESI, M. Bond risk premia. American Economic Review, v. 95, n. 1,
p. 138–160, 2005.

COUCHMAN, J.; GOUNDER, R.; SU, J.-J. Long memory properties of real interest rates for
16 countries. Applied Financial Economics Letters, Routledge, v. 2, n. 1, p. 25–30, 2006.

17

DIEBOLD, F. X.; LI, C. Forecasting the term structure of government bond yields. Journal of
Econometrics, Elsevier, v. 130, n. 2, p. 337–364, 2006.

DIEBOLD, F. X.; LI, C.; YUE, V. Z. Global yield curve dynamics and interactions: a dynamic
Nelson–Siegel approach. Journal of Econometrics, Elsevier, v. 146, n. 2, p. 351–363, 2008.

DIEBOLD, F. X.; RUDEBUSCH, G. D. Yield Curve Modeling and Forecasting: the Dynamic
Nelson-Siegel Approach. [S.l.]: Princeton University Press, 2013.

DIEBOLD, F. X.; RUDEBUSCH, G. D.; ARUOBA, S. B. The macroeconomy and the yield
curve: a dynamic latent factor approach. Journal of Econometrics, Elsevier, v. 131, n. 1-2, p.
309–338, 2006.

DUFFEE, G. R. Term premia and interest rate forecasts in aﬃne models. The Journal of
Finance, Wiley Online Library, v. 57, n. 1, p. 405–443, 2002.

FAMA, E. F.; BLISS, R. R. The information in long-maturity forward rates. The American
Economic Review, JSTOR, p. 680–692, 1987.

GOLI´nSKI, A.; ZAFFARONI, P. Long memory aﬃne term structure models. Journal of
Econometrics, v. 191, n. 1, p. 33 – 56, 2016. ISSN 0304-4076.

KOOPMAN, S. J.; MALLEE, M. I.; WEL, M. Van der. Analyzing the term structure of
interest rates using the dynamic Nelson–Siegel model with time-varying parameters. Journal of
Business & Economic Statistics, Taylor & Francis, v. 28, n. 3, p. 329–343, 2010.

LAURINI, M. P.; HOTTA, L. K. Forecasting the term structure of interest rates using
integrated nested Laplace approximations. Journal of Forecasting, Wiley Online Library, v. 33,
n. 3, p. 214–230, 2014.

NELSON, C. R.; SIEGEL, A. F. Parsimonious modeling of yield curves. Journal of business,
JSTOR, p. 473–489, 1987.

PALMA, W. Long-memory Time Series: Theory and Methods. [S.l.]: John Wiley & Sons, 2007.

POOTER, M. D. Examining the Nelson-Siegel class of term structure models: In-sample ﬁt
versus out-of-sample forecasting performance. Available at SSRN 992748, 2007.

POOTER, M. D.; RAVAZZOLO, F.; DIJK, D. J. V. Term structure forecasting using macro
factors and forecast combination. FRB International Finance Discussion Paper, n. 993, 2010.

RUE, H.; MARTINO, S.; CHOPIN, N. Approximate bayesian inference for latent Gaussian
models by using integrated nested Laplace approximations. Journal of the Royal Statistical
Society: Series B (Statistical Methodology), Wiley Online Library, v. 71, n. 2, p. 319–392, 2009.

SØRBYE, S. H.; MYRVOLL-NILSEN, E.; RUE, H. An approximate fractional Gaussian noise
model with O(n) computational cost. Statistics and Computing, Springer, p. 1–13, 2017.

SØRBYE, S. H.; RUE, H. Fractional Gaussian noise: Prior speciﬁcation and model comparison.
Environmetrics, v. 29, n. 5-6, p. e2457, 2018.

TSAY, W.-J. Long memory story of the real interest rate. Economics Letters, v. 67, n. 3, p. 325
– 330, 2000. ISSN 0165-1765.
ZIVOT, E.; WANG, J. Modeling Financial Time Series with S-Plus R(cid:13). [S.l.]: Springer Science
& Business Media, 2007.

18

