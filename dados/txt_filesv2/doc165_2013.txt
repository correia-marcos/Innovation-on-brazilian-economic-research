Evidências de Bull e Bear Market no índice Bovespa:
Uma aplicação de modelos de regime markoviano e

duration dependence

Fernando Henrique de Paula e Silva Mendes∗

Guilherme Valle Moura†

Resumo

O objetivo deste trabalho é identiﬁcar tendências de alta e de baixa no índice Bovespa através de
modelos de mudança de regime markoviano que incorporam dependência de duração. Conforme
evidenciado pela literatura, os resultados mostraram um regime de retorno positivo e baixa volatili-
dade e outro com alta volatilidade e retorno negativo. Nestes modelos a probabilidade de transição
não é só função do regime atual como também do número de períodos em que o processo se encontra
em determinado estado. A parametrização proposta revelou que a probabilidade de troca de regime
diminui com a persistência do mercado de alta e de baixa. A análise das probabilidades suavizadas
destaca que as especiﬁcações captaram os principais episódios de instabilidade na bolsa brasileira.
Por ﬁm, os modelos propostos são usados na construção de uma estratégia de investimento.

Palavras-Chave: Dependência de Duração, Mudança Markoviana, Volatilidade

Abstract

This study proposes to identify Bull and Bear Market for the Brazilian stock market using a markov
switching model that incorporates duration dependence. Following the existing literature, the model
sorts returns into a high return stable state and a low return volatile state, which are labeled as Bull
and Bear Market. In these models the transition probabilities are functions of both the inferred cur-
rent state and also the number of periods that the process has been in that state. The parameterization
showed that the probability of switching out of the states declines with duration in that state. The
smoothed probabilities highlighted the major instabilities phases at Brazilian stock market. Finally,
the proposed models are used in order to develop an investment strategy.

Key-Words: Duration Dependence, Markov Switching, Volatility

JEL: C22, G17

Anpec: Área 8 - Microeconomia, Métodos Quantitativos e Finanças

∗Programa de Pós-Graduação em Economia, UFSC. Email: fernandohpsm@hotmail.com
†PPGE, UFSC. Email: guilherme.moura@cse.ufsc.br

1

1

Introdução

Nas últimas décadas, diversos trabalhos na área de ﬁnanças empíricas vêm documentando
algumas peculiaridades dos retornos ﬁnanceiros. Os principais fatos estilizados desses retornos
são: observações atípicas, agrupamento de volatilidade e distribuições com caudas pesadas, que
em geral são assimetricas (Campbell et al. 1997). Em contrapartida, pouca atenção tem sido
dada às tendências em que esses ativos se mantém valorizados (desvalorizados)..

Os termos, Bull Market e Bear Market, mercado de alta e mercado de baixa, respectiva-
mente, há décadas descrevem tendências ascendentes e descendentes nas cotações das ações.
Segundo Harris (2003), a expressão Bull Market advém do movimento que o touro faz quando
ataca - de baixo para cima, Bear Market assemelha-se ao ataque do urso - de cima para baixo.
Apesar da conotação folclórica trazida aqui não há uma deﬁnição formal quanto o uso desses
termos na literatura. Um investidor que possa prever antecipadamente um mercado de alta ou de
baixa pode evitar perdas inesperadas ou até mesmo aferir lucros. Para as empresas, é preferível
emitir ações em um mercado de alta, isso devido à baixa captação de recursos em momentos de
pessimismo (Kole & Dijk 2012).

Identiﬁcar mercado de alta (baixa) não interessa apenas às estratégias de investimento ou a
avaliação de risco entre os agentes econômicos. Para Stock & Watson (2006) a cotação acionária
não deixa de ser uma indicativa sobre o ambiente econômico, uma vez que elas antecipam
futuros dividendos1. O conhecimento destes estados pode ajudar na predição de ciclos (Chauvet
1999) e na formulação de política econômica (Rigobon & Sack 2003).

Os métodos tradicionais na avaliação de Bull e Bear Market remontam aos trabalhos de Pa-
gan & Sossounov (2003) e Lunde & Timmermann (2004). A metodologia explorada por estes
autores busca determinar pontos extremos nos dados e em seguida aplica regras que caracter-
izam esses “picos” e “depressões” como possíveis pontos de reversão (turning points) entre
períodos ascendentes e descendentes. Para tanto, os trabalhos se baseiam na metodologia pro-
posta por Bry & Boschan (1971), usada na delineação de recessões e expansões econômicas.

Em contraste com o seu vasto uso, a metodologia acima apresenta algumas limitações. O
uso de um algoritmo ex-post indentiﬁca pontos de reversão várias observações após as suas
ocorrências. Porém, na maioria das vezes, os investidores estão interessados em estimar a
probabilidade desses momentos no futuro. Por exemplo, montar uma estratégia de investimento
levando em conta a chance do mercado estar em um Bear Market na próxima semana?

Paralelamente a abordagem apresentada, o emprego de modelos de mudança de regime gan-
hou bastante destaque na literatura. Um grande atrativo dessa metodologia é fazer inferências
quanto à probabilidade de permanência no regime não observado. Neste contexto, o trabalho de
Hamilton (1989) foi fundamental para o desenvolvimento do tema. O autor mostrou que o PIB
norte americano podia ser modelado como um processo que possui dois estados, um no qual a
economia encontra-se em expansão e outra em que a economia está em um processo recessivo.
Neste modelo a mudança de estado se dá através de uma cadeia de markov de primeira ordem,
a estimação é realizada pelo método da máxima verossimilhança. O trabalho tentou com isto
caracterizar os ciclos econômicos pelos quais a economia americana passou.

Nos últimos anos diversos trabalhos buscaram estender a metodologia de Hamilton. Por

1Para mais informações ver Estrella & Mishkin (1998), Stock & Watson (2003), Marcellino (2006) entre outros.

2

exemplo, Cai (1994) e Hamilton & Susmel (1994) não só abrangem a metodologia acima como
também generalizam os trabalhos de Engle (1982) e Bollerslev (1986) ao incorporar mudança
de regime na estrutura da variância dos dados. Já Durland & McCurdy (1994) buscam explo-
rar o papel da dependência cíclica dos dados. A modelagem proposta pelos autores condiz
com o fato de que a dinâmica de mudança dos regimes é governada não só pelo regime atual
como também pelo número de períodos em que o processo se encontra em determinado estado.
Diferentemente de Hamilton (1989), o artigo dinamiza a matriz de transição de probabilidade
até então considerada estática e introduz o conceito dependência de duração (duration depen-
dence).

Devido à característica cíclica do mercado de ações, um trabalho pioneiro na tentativa de
identiﬁcar mercado de alta e de baixa é o de Maheu & McCurdy (2000). Através de diversos
modelos da classe, Duration Dependent Markov Switching Models (DDMS), os autores encon-
tram evidências de não linearidade dos retornos mensais das ações da bolsa de Nova York. O
artigo estende a metodologia de Durland & McCurdy (1994) ao modelar a volatilidade e explo-
ram modelos em que a duração do regime é vista como uma variável dependente tanto na média
como na variância do processo. Os resultados obtidos pelos autores destacam que períodos
de retorno positivo, Bull Market, corresponderam a menor volatilidade do que em períodos de
retorno negativo, Bear Market.

A ideia do duration dependence é retratar a dependência na cotação acionária. Por exemplo,
a persistência de um estado ascendente, Bull Market, torna os investidores otimistas em relação
ao futuro, atraindo mais investimento para um determinando ativo. Consequentemente essa
resposta positiva faz com que a probabilidade de troca de regime varie no tempo. Essa mesma
análise é vista na baixa, Bear Market, devido o pessimismo dos investidores. Após o trabalho
de Maheu & McCurdy (2000) uma vasta literatura foi desenvolvida no âmbito Bull e Bear
Market 2, porém, nenhum trabalho que usa dependência de duração foi feito para o mercado
brasileiro.

O objetivo deste trabalho é identiﬁcar períodos de Bull e Bearl Market no índice Bovespa
utilizando modelos econométricos da classe DDMS - Duration Dependece Markov Switching
Models. Adicionalmente, as especiﬁcações usadas serão usadas para construir uma estratégia
de investimento para o índice Bovespa. As rentabilidades obtidas serão comparadas com o buy
and hold, isto é comprar um ativo e vende-lo no ﬁnal do período.

O artigo está organizado da seguinte maneira, a presente introdução, a seção 2 explora o
conceito duration dependence e os modelos da classe DDMS. Na seção 3 são apresentadas as
estimativas dos parâmetros e a análise dos pontos de reversão. Na penútima seção é elaborada
uma estratégia de investimento e na seção ﬁnal a conclusão

2Para mais informações ver Chena & Shen (2007), Castro (2011), Shibata (2011) entre outros.

3

2 Mudança de Regime e Dependência de Duração
2.1 Duration Dependence

A metodologia do trabalho caracteriza Bull e Bear Market através da variável de estado
St = i, em que, i = 0,1, onde t = 1, . . . ,T 3. Diferentemente dos modelos tradicionais de mu-
dança de regime, a idéia do duration dependence é capturar da dependência temporal da variável
de estado. Neste contexto, busca-se dinamizar a matriz de probabilidade de transição entre os
estados através da variável D(St). Esta variavél retrata a memória na ocorrência consecutiva do
estado St e pode ser deﬁnida pela equação abaixo:

D(St) = min(D(St−1)I(St,St−1) + 1,τ).

(1)
A função indicadora I(St,St−1) é 1 caso St = St−1 e 0 no contrário. Nota-se que um parâmetro
limite τ é estabelecido na equação. O valor da estimativa do paramêtro é um número discreto e
será estabelecido através da estimação de verossimilhança4.

Segundo Maheu & McCurdy (2000), uma maneira de parametrizar as probabilidades de
transição é através do emprego de uma função logística. Isso garante que as probabilidades
estejam entre 0 e 1. Usando i e d para indexar a realização de estados e duração, a probabilidade
de transição para i = 0,1 e para os parâmetros γ1(i) e γ2(i) é dada por:

(cid:40) exp(γ1(i)+γ2(i)d)

1+exp(γ1(i)+γ2(i)d),
exp(γ1(i)+γ2(i)τ)
1+exp(γ1(i)+γ2(i)τ),

d ≤ τ
d > τ

i = 0,1,

(2)

P(St = i|St−1 = i,D(St−1) = d) =

Conforme proposto por Durland & McCurdy (1994), o efeito duração permite que a matriz
de transição de probabilidade varie no tempo até atingir τ. Uma maneira útil de discutir estes
efeitos é através de uma função de troca de estado. Essa função é a probabilidade condicional
de mudança de estado assumindo a memória d. Em termos de transição de probabilidade, a
função troca de estado é dada por:

1− P(St = i|St−1 = i,D(St−1) = d) =

1

1 + exp(γ1(i) + γ2(i)d)

,

i = 0,1.

(3)

uma função decrescente refere-se a um efeito negativo na dependência de duração enquanto uma
função crescente refere-se a um efeito positivo. A análise acima pode ser resumida pelo valor
do parâmetro: γ2(i). Por exemplo, γ2(i) < 0 signiﬁca dependência positiva, γ2(i) = 0, denota
dependência nula e γ2(i) > 0 signiﬁca duração negativa. É interessante destacar que, caso a
dependência seja nula, γ2(i) = 0, a parametrização acima, colapsa no processo de Markov de
primeira ordem, tal como: P(St = i|St−1 = i,D(St−1) = d) = P(St = i|St−1 = i), ou seja, apenas
dependerá do valor passado mais recente da variável de estado.

3 T é o tamanho da amostra
4Para maior detalhamento ver a seção sobre estimação

4

2.2 Modelos DDMS

Devido ao fato de que a maioria das séries ﬁnanceiras apresentam heterocedasticidade
condicional, o principal modelo desta deste trabalho é aquele em que a volatilidade é incorpo-
rada na dependência de duração, Duration-Dependent Markov Switching Autoregressive Het-
eroskedasticity, (DDMS-ARCH). Neste modelo o retorno segue um processo auto-regressivo
com mudança de regime, tal como:

Rt = µ(St) + φ1{Rt−1 − µ(St−1)} + φ2{Rt−2 − µ(St−2)} +

+··· + φP{Rt−P − µ(St−P)} + εt.

(4)

sendo φ1, . . . ,φP os parâmetros, P o número de defasagens, e εt um termo de erro no período t.
µ(St) é visto como uma variável de estado St:

µ(St) = µ0(1− St) + µ1St,

em que µ0 e µ1 são parâmetros. Se St = 0, temos µ(St) = µ0, caso St = 1, segue µ(St) = µ1.

O termo de erro εt da equação (4) é expresso por:

(cid:112)htvt,

εt =

(5)

(6)

tal que vt é uma variável independente e identicamente distribuída de acordo com uma dis-
tribuição normal padrão e ht dado por:

ht = mst +

K

∑

k=1

αk˜ε2

t−k,

(7)

na qual K denota o número de defasagens, e α1, . . . ,αK são os parâmetros. A diferença entre
este modelo e um modelo ARCH padrão com K parâmetros é que o modelo acima depende de
uma variável de estado mst. Desta forma, se St = 0, temos mst = m0, no entanto, se St = 1, segue
que mst = m1, os parâmetros m0 e m1 vão ser estimados.
Na equação (7), ˜εt−k é o erro de previsão dado por:

˜εt−k = Rt−k − Et−k−1[Rt−k],

(8)

em que Et−k−1[Rt−k] é o valor esperado de Rt−k dado o conjunto de informação Ωt−k−1 =
{R1,R2, . . . ,Rt−k−1}, tal como:

Et−k−1[Rt−k] =

∑

E[Rt−k|St−k,St−k−1, . . . ,St−k−P,d,Ωt−k−1]

St−k,St−k−1,...,St−k−P,d
×P[St−k,St−k−1, . . . ,St−k−P,d|Ωt−k−1].

(9)

A ﬁm de comparar as estimativas deste modelo, serão estimados mais dois modelos da classe

5

DDMS também encontrados em Maheu & McCurdy (2000): O primeiro deles é o DDMS-1:

Rt = µ(St) + φ1{Rt−1 − µ(St−1)} + φ2{Rt−2 − µ(St−2)} +

+··· + φP{Rt−P − µ(St−P)} + σvt.

(10)

onde σ é um parâmetro a ser estimado. A mudança de regime ocorre apenas na média incondi-
cional do processo. Já o segundo é o DDMS-2:

Rt = µ(St) + φ1{Rt−1 − µ(St−1)} + φ2{Rt−2 − µ(St−2)} +

+··· + φP{Rt−P − µ(St−P)} + σ(St)vt.

(11)

neste, tanto a média como a variância incondicional mudam de regime, ou seja, Bull e Bear
Market, µ(St) = µ0(1− St) + µ1St, e σ(St) = σ0(1− St) + σ1St. Em ambos os modelos vt ∼
NID(0,1) e St = 0,1.

2.3 Estimação

Os modelos da classe DDMS foram estimados usando o método da máxima verossimil-

hança. Para mais detalhes ver os apêndices de Maheu & McCurdy (2000) e Hamilton (1994).

Estes modelos podem ser entendidos como uma extensão do modelo de Mudança de Regime
Markoviano de Hamilton (1989). A expressão 2P+1 denota as possíveis combinações de de-
pendência de Rt em St, e seus valores defasados St−1, . . . ,St−P, através de µ(St), . . . ,µ(St−P),
sendo que cada estado St, . . . ,St−P assume valor 0 ou 1.
Já a expressão 2(τ− P− 1) é a soma das combinações de dependência Rt, em que τ > P,
ou seja, a estrutura de duração é maior que a defasagem P. Sendo assim, devemos consid-
erar a combinação de estados St−P−1, . . . ,St−P−τ que não são observados pela especiﬁcação do
modelo.

Por exemplo: uma possibilidade seria todas as variáveis de estados do modelo St,St−1, . . . ,St−P

sejam iguais a um e D(St) = P+2. Outra combinação tornariam os mesmos estados St,St−1, . . . ,St−P
iguais a um, porém, D(St) = P + 3, assim sucessivamente, ou seja, a soma destas combinações
seria τ− P− 1. A mesma ideia é vista no caso em que St,St−1, . . . ,St−P são iguais a zero.
Seja N o número total de estados, temos: N = 2P+1 + 2(τ − P − 1). Cada estado será
Tomando ξt como um vetor aleatório de dimensão (N × 1) segue:

representado tal como: ψt = j, j = 1, . . . ,N.



(cid:0)1 0 0 . . . 0(cid:1)(cid:48)
(cid:0)0 1 0 . . . 0(cid:1)(cid:48)
(cid:0)0 0 1 . . . 0(cid:1)(cid:48)
(cid:0)0 0 0 . . . 1(cid:1)(cid:48)

ξt =

,
,
,

,

...

quando ψt = 1,
quando ψt = 2,
quando ψt = 3,

quando ψt = N.

(12)

ˆξt|t−1 é um vetor em que o j-ésimo elemento é P(ψt = j|Rt−1, . . . ,R1,θ) , tal que θ representa
os parâmetros e P(ψt = j|(·) é a probabilidade de predição do estado j condicionado em (·). Já

6

ˆξt|t é um vetor em que o j elemento é dado por P(ψt = j|Rt, . . . ,R1,θ), ou seja, a probabilidade
ﬁltrada.

Seja ηt um vetor em que o j-ésimo elemento é a densidade condicional de Rt, temos:

ηt =

 .

...

f (Rt|ψt = N,Rt−1, . . . ,R1,θ)

f (Rt|ψt = 2,Rt−1, . . . ,R1,θ)

 f (Rt|ψt = 1,Rt−1, . . . ,R1,θ)
 ,
 p11

. . . pN1
. . . pN2
p12
...
...
p1N p2N . . . pNN

p21
p22
...

P =

(13)

(14)

Assume-se que P é a matriz de transição de probabilidade de ψt, tal que:

onde p ja jb = P(ψt = jb|ψt−1 = ja), ja, jb = 1, . . . ,N.

A probabilidade ﬁltrada ˆξt|t para t = 1, . . . ,T pode ser obtido através do seguinte par de

equações:

ˆξt|t−1 (cid:12) ηt
1(cid:48)(ˆξt|t−1 (cid:12) ηt)

= ˆξt|t

ˆξt+1|t = Pˆξt|t.

(15)
A iteração da equação (15) começa em t = P + K + 1 dado R1, . . . ,RP+K, em que (cid:12) sig-
niﬁca multiplicação elemento por elemento entre os vetores 5. Nota-se que para inicializar as
equações acima, o valor inicial ˆξP+K+1|P+K é a probabilidade incondicional. Neste caso esta-
mos considerando que a cadeia de markov seja estacionaria e ergótica6.

Por ﬁm, a função de log verossimilhança é dada pela expressão:

Ł(θ) =

T

∑

t=P+K+1

ln f (Rt|Rt−1, . . . ,R1,θ),

(16)

f (Rt|Rt−1, . . . ,R1,θ) = 1(cid:48)(ˆξt|t−1 (cid:12) ηt). As es-
onde o termo do lado esquerdo é visto por:
peciﬁcações DDMS-1 e DDMS-2 também foram estimados da mesma forma que o modelos
DDMS-ARCH.

5Rt−k−1, . . . ,Rt−k−P é necessário para construir ˜εt−k (termo que aparece do lado direito da equação ht = mst +
∑K
k=1 αk˜ε2
t−k). Já ht precisa de Rt−k−1, . . . ,Rt−k−P, pois dado R1, . . . ,RP+K, o modelo é estimado para t = P + K +
1, . . . ,T .

6Para mais detalhes ver Hamilton (1994).

7

3 Resultados
3.1 Dados

A série de dados utilizada no artigo é o log-retorno7 do índice Bovespa com periodicidade
semanal. O período de análise inicia-se em julho de 1994 até ﬁnal de 2012, totalizando 966
observações. A ﬁm de comparar os resultados dos modelos não-lineares desenvolvidos neste
trabalho, foi estimado por OLS um modelo linear AR (2), o número de defasagens foi estabele-
cido segundo o critério BIC.

A existência de alguma dependência não-linear que não foi avaliada pelo modelo autore-
gressivo é retratada ao aplicar o teste BDS8 sobre os resíduos da regressão. A hipótese nula é
que o modelo linear é suﬁciente para captar a estrutura de dependência existente na média ver-
sus a hipótese alternativa que retrata alguma estrutura não linear ainda presente no resíduo do
modelo. Os resultados mostram que o modelo linear não é suﬁciente para modelar a estrutura
da média, fato que implica a necessidade de testar modelos não lineares.

Outra evidência para o emprego de modelos não lineares é visto ao analisar as estimativas
da Tabela 1. Nota-se que a curtose do retorno do Ibovespa é maior que o valor da distribuição
normal, e a sua assimetria é negativa, ou seja, retornos negativos tendem a ocorrer com mais
frequência. A não normalidade da série é mostrada no teste Jarque Bera, que rejeita a hipótese
nula de retornos normais, revelando novamente a possibilidade do uso de modelos não lineares.

Table 1: Retorno do Ibovespa

Média

Desvio-Padrão

Assimetria

Curtose

0.2762

4.6874
−0.5622
6.0715

Jarque-Bera

427.9487

P-Valor

0.0000

7A série do índice Bovespa, Pt, foi convertida em termos de log-retorno Rt = 100× (lnPt − lnPt−1), onde a

primeira observação é dada por R2.

8Para mais informações ver Brock et al. (1987).

8

3.2 Diagnóstico dos Resíduos

(17)

(18)

Devido a variável latente St, os resíduos dos modelos com mudança de regime não são
observados. Usando a equação equação (17), o teste Ljung-Box Portmanteau pode ser aplicado
através dos resíduos ponderados para testar a adequação dos modelos. Seguindo Maheu &
McCurdy (2000), o resíduo normalizado do modelo DDMS-ARCH é dado por:

∑

Rt − E[Rt|St, . . . ,St−P,d,Rt−1, . . . ,R1]

St ,...,St−P,d

em que o desvio padrão condicional é dado por(cid:112)ht(St), tal que:

(cid:112)ht(St)

× P(St, . . . ,St−P,d|Rt−1, . . . ,R1),

ht(St) = ∑

St ,...,St−P,d

ht(St)P(St, . . . ,St−P,d|YT ),

DDMS-1 e DDMS-2,(cid:112)ht(St) na equação (17) é substituído por σ e σ(St), respectivamente.

o último termo a direita da equação acima é a probabilidade suavizada9. Para os modelos

A estatística Ljung-Box para a autocorrelação dos resíduos ponderados com defasagem h é

dado por:

Q = n(n + 2)

j

∑

j=1

ˆρ2
j
n− j ,

(19)

onde ˆρ j, j = 1,2, . . . ,h é a autocorrelação e n é o tamanho da amostra dos resíduos.

3.3 Parâmetros estimados

As estimativas, o desvio padrão e log-verossimilhança dos modelos da classe DDMS estão
apresentados na Tabela 2. Adicionalmente um modelo ARCH (5) é apresentado frente o modelo
DDMS-ARCH. A defasagem da estrutura da variância foi estabelecida segundo o critério BIC.
É importante destacar que o teste da razão da verossimilhança não é aplicado entre os mod-
elos DDMS-1 e AR(2), e DDMS-ARCH versus ARCH, isso porque os modelos não são an-
inhados10, porém, nota-se que o valor da verossimilhança entre os mesmos, indica o uso dos
modelos da classe DDMS.

Uma característica geral dos modelos apresentados é que as estimativas tanto da média
como da variância condicional (incondicional) foram estatisticamente signiﬁcantes e diferentes
de zero, ou seja, temos um período de retorno positivo e baixa volatilidade versus um regime
em que a volatilidade é alta e retorno negativo.

9Para mais detalhes ver próxima seção.
10Para mais detalhes ver Hamilton (1994).

9

Table 2: Resultado das Estimativas

AR(2)
0.2840∗∗
(0.1536)

DDMS-1

DDMS-2
ARCH
0.3821∗∗∗ −12.9729∗∗∗ −1.0011∗
(0.1292)
(0.7397)
0.5411∗∗∗
(0.1311)

(1.0979)
0.6863∗∗∗
(0.1355)
4.0272∗∗∗
(0.0981)

4.6529∗∗∗
(0.1060)

7.8386∗∗∗
(0.9455)

8.3769∗∗∗
(0.6376)
3.4143∗∗∗
(0.1150)
−1.0433∗
(0.8485)
−0.8776
(0.9233)
0.6111∗∗∗
(0.2192)
0.8275∗∗∗
(0.2135)
−0.0558∗∗ −0.0924∗∗∗ −0.0869∗∗ −0.0741∗∗∗
(0.0321)
(0.0316)
0.0711∗∗
0.0800∗∗∗
(0.0321)
(0.0322)

−1.3350∗
(0.9590)
0.7290
(0.6638)
0.2229
(0.5444)
0.5861∗∗∗
(0.1374)

(0.0380)
0.0781∗∗
(0.0385)

(0.0241)
0.1057∗∗∗
(0.0276)
0.1181∗∗∗
(0.0291)
0.0595∗
(0.0334)
0.1836∗∗∗
(0.0451)
0.2208∗∗∗
(0.0401)
0.0913∗∗
(0.0379)
−2760.5

Parâmetros

µ0,µ

µ1

m,σ

m0,σ0

m1,σ1

γ1(0)

γ1(1)

γ2(0)

γ2(1)

φ1

φ2

α1

α2

α3

α4

α5
τ
lnL

−2850.0

6

−2794.8

6

−2747.4

∗∗∗,∗∗ ,∗ signiﬁcância em 1%,5% e 10% respectivamente. Desvio padrão está em parênteses.
lnL é o valor da log verossimilhança.

10

DDMS-ARCH

−3.0295∗∗
(1.4171)
0.4938∗∗∗
(0.1232)

63.3478∗∗∗
(15.2916)
7.6925∗∗∗
(1.0970)
−0.9601
(0.8668)
0.4637
(1.8890)
0.4952∗∗
(0.2176)
0.4755∗
(0.3543)
−0.0807∗∗∗
(0.0317)
0.0657∗∗
(0.0306)
0.0000
(0.0000)
0.0000
(0.0000)
0.1101∗∗∗
(0.0435)
0.1091∗∗∗
(0.0427)
0.1200∗∗
(0.0460)
−2718.6

7

A estatística Ljung-Box dos modelos acima é visto na Tabela 3. Segundo o p-valor, nota-se
que o modelo mais parcimonioso DDMS-1, apresentou signiﬁcativa persistência para os seus
resíduos, como também evidências de efeito ARCH. Diferente do resultado acima, o modelo
DDMS-2 superou a autocorrelação na estrutura a média condicional, porém, para os resíduos
ao quadrado esse resultado não pode se assegurar.

Para o modelo DDMS-ARCH, a hipótese de ausência de autocorrelação não pode ser re-
jeitada tanto para o resíduo, quanto para o resíduo quadrado. A duas séries são ruídos brancos,
sugerindo que o modelo teve um ajustamento melhor frente os dados.

Table 3: Teste de Especiﬁcação

Teste ARCH DDMS-1 DDMS-2 DDMS-ARCH

Q(8)

Q2(8)

6.013
(0.646)
12.209
(0.142)

38.389∗∗∗
(0.000)
182.041∗∗∗
(0.000)

5.444
(0.709)
17.440∗∗
(0.025)

4.326
(0.827)
10.403
(0.238)

Parênteses são os p-valores.
∗∗∗,∗∗ ,∗ signiﬁcância de rejeitar a hipótese nula de não autocorrelação a 1%,5% e 10%.

Ao analisar novamente a Tabela 2, nota-se que o coeﬁciente de volatilidade no Bear Mar-
ket, m0, é muito maior que no período de Bull Market, m1, ou seja, 63.3478 e 7.6925 respec-
tivamente. Além disso, a soma dos coeﬁcientes na estrutura da variância é estacionária. Os
parâmetros da equação da média φ1 e φ2 são signiﬁcativos e mostra alternância de sinal, resul-
tado condizente com o modelo ARCH sem mudança de regime 11.

As estimativas dos parâmetros γ2(0) e γ2(1) para os modelos DDMS-2 e DDMS-ARCH,
mostram uma função de troca de estado decrescente, desta forma, a probabilidade do ativo
permanecer nos regimes de Bear e Bull Market aumenta.

(a) Prob. de duração em semanas - DDMS2

(b) Prob. de duração em semanas - DDMS-ARCH

11Para estimar os parâmetros do modelo DDMS-ARCH foi necessário restringir os parâmetros para maximizar
a função verossimilhança. Foi empregado o método Delta para aproximar a matriz de covariância dos parâmetros
Kim & Nelson (1999).

11

A ﬁgura (a) mostra o resultado para o modelo DDMS-2. A probabilidade do Bear Market
(linha pontilhada) é 0.39 quando d = 1 e 0.48 no Bull Market (linha continua). A probabilidade
de mudança de regime, ou seja, Bull para o Bear ou Bear para o Bull é maior. Uma vez d > τ
a probabilidade de ﬁcar no mercado de baixa e alta são 0.93 e 0.98 respectivamente. Neste
modelo τ foi 6 12. Da mesma forma, a ﬁgura (b) mostra a mesma dinâmica para o modelo
DDMS-ARCH. Neste modelo o parâmetro τ foi 7. A probabilidade do Bear Market (linha
pontilhada) é 0.41 quando d = 1 e 0.72 no Bull Market (linha continua). Diferente do que foi
visto no primeiro resultado, modelar a variância acarretou em uma probabilidade maior para o
Bull Market. No contexto de probabilidade ﬁxa, ou seja, d > τ, a probabilidade do Bear Market
é 0.92 e a do Bull Market é 0.97.

3.4 Probabilidades Suavizadas e Pontos de Reversão

A probabilidade suavizada associada a St no modelo DDMS-ARCH foi estimada usando o
algoritmo descrito em Kim & Nelson (1999)13. ˆξT|T , ˆξT−1|T−1, e ˆξT|T−1 são os estados ﬁltrados
obtidos através da estimação por verossimilhança. ˆξT−1|T é obtido por:

ˆξT−1|T = ˆξT−1|T−1 (cid:12)(cid:110)

P(cid:48)(cid:104)ˆξT|T (÷)ˆξT|T−1

(cid:105)(cid:111)

(20)

onde (÷) signiﬁca divisão de elemento por elemento e P foi deﬁnido na equação (14).
Tomando t = T − 2, . . . ,K + P + 1, e os vetores ˆξt|t e ˆξt+1|t decorrentes da estimação por
máxima verossimilhança, tal que ˆξt+1|T vem da iteração passada, a probabilidade suavizada
ˆξt|T é dado por:

ˆξt|T = ˆξt|t (cid:12)(cid:110)

P(cid:48)(cid:104)ˆξt+1|T (÷)ˆξt+1|t

(cid:105)(cid:111)

(21)
O i-ésimo elemento de ˆξt|T é a probabilidade de ψt = i sobre o conjunto de informação
P(ψt = i|RT , . . . ,R1,θ) ou P(St,St−1, . . . ,St−K−P,D(St)|RT , . . . ,R1,θ).
A análise de Bull e Bear Market é dada pela soma da probabilidade conjunta em cada peri-

RT , . . . ,R1 e θ. Isso é representado no modelo DDMS-ARCH por:

.

odo:

P(St|RT , . . . ,R1,θ) =

∑

St−1,...,St−k−P,D(St )

P(St,St−1, . . . ,St−K−P,D(St)|RT , . . . ,R1,θ)

(22)

para os modelos DDMS-1 e DDMS-2, o procedimento é análogo.

As Figuras(1) e (2) mostram as probabilidades suavizadas de Bear Market para os modelo

DDMS-2 e DDMS-ARCH.

O início da amostra, ou seja, segunda metade da década de 90 é um período caracterizado
por grandes turbulências nos mercados ﬁnanceiros internacionais, especialmente nas economias
emergentes. Os modelos mostraram o desempenho do Ibovespa em decorrência do inﬂuxo de

12A estimação de τ foi estabelecida segundo o valor da verossimilhança. O conjunto de escolha deste parâmetro

variou de 5 à 18.

13Para mais detalhes ver Hamilton (1994).

12

Figure 1: Bear Market DDMS-2× Ibovespa.

Figure 2: Bear Market DDMS-ARCH× Ibovespa.

capital estrangeiro nas crises; do México (ﬁm de 1994), da Tailândia, Indonésia, Malásia e
Coreia do Sul (1997) e da Rússia (1998).

Através da análise das regiões cinzas 14 nas Figuras (1) e (2), a probabilidade do Bear
Market em agosto de 1994 é superior à meio, indicando o início da crise mexicana deﬂagrada

14As áreas cinzas destacam os principais episódios de instabilidade no Ibovespa.

13

em dezembro de 1994. Segundo o noticiário econômico da época, entre 1995 a 1996 o volume
diário médio negociado na bolsa não ultrapassou a média anual dos 100 milhões de dólares, em
comparação com os 400 milhões milhões de dólares em 1994. A alta e persistente probabilidade
nos anos seguintes, 1997 e 1999, também mostram evidências que os modelos captaram as
baixas históricas durante a crise asiática e russa. O período foi marcado por diversas ocorrências
de circuitbreaker15 devido o alto pessimismo dos investidores.

Os efeitos do estouro da bolha Nasdaq e as consequências do ataque terrorista às torres
gêmeas são retratados por ambas especiﬁcações. Entre março a abril de 2000 o índice Bovespa
caiu 17% anulando a valorização que vinha sendo construída desde a crise russa. Poucos dias
após o ataque terrorista em 11 de setembro de 2001, o índice atingiu o menor nível desde agosto
de 1999 ao registrar 10.038 pontos.

Amplamente conhecido pelo mercado por “efeito Lula” e “efeito Tango”, o ano 2002 foi
marcado pela forte desvalorização dos ativos na bolsa. As incertezas do pleito eleitoral e os
rumores da moratória da Argentina contribuíram para a baixa de 65% entre Janeiro e Outubro
naquele ano. As Figuras (1) e (2) mostram que a probabilidade do Bear Market nesse período é
elevada e se estende até começo de 2003.

A análise dos turning points também mostrou o excesso de otimismo que precedeu a crise
imobiliária americana, ou seja, a forte valorização do índice em 2003 até o ﬁnal de 2007. Ape-
sar do aumento da volatilidade em alguns períodos especíﬁcos (abril de 2004 e julho de 2007), a
Bovespa triplicou o volume médio de negócios e houve uma grande quantidade de ofertas inici-
ais de ações (IPO) nesse período. Em abril de 2007 a bolsa brasileira chegou à marca histórica
de 50.000 pontos, representando valorização de mais de 1000% desde o plano Real, naquele
período o índice beirava 4.000 pontos. No ano seguinte, a expressiva valorização ganhou ainda
mais força e atingiu a marca de 73.589 pontos em maio de 2008.

O aumento gradativo da chance de reversão do quadro até então apelidado como “céu de
brigadeiro” é mostrado no inicio do segundo semestre de 2008. É interessante destacar que o
modelo captou o movimento de deterioração do índice semanas antes de atingir quedas históri-
cas no mês de outubro de 2008.

O último turning point de signiﬁcância na análise de Bull e Bear Market é mostrado pela alta
volatilidade e retorno negativo em agosto de 2011. Isso devido à reação negativa do mercado
após o anúncio do rebaixamento da nota da dívida soberana americana. As operações no pregão
estiveram perto de serem suspensas e o índice chegou a registrar a maior queda desde outubro
de 2008. Conforme visto na ﬁgura, nesse período as probabilidades suavizadas ﬁcaram bem
próximas de meio.

4 Estratégia de Investimento

Utilizando as probabilidades de predição (P(St|Rt−1, . . . ,R1,θ)) de Bull e Bear Market ab-
straídas a cada instante do tempo, a estratégia de investimento explorada aqui, segue de maneira
geral o trabalho de Almeida & Valls (2000). Os autores mostram que os modelos de mudança
de regime apresentaram bom desempenho nos retornos, quando aplicados a regras de mercado.

15A regra geral para o uso do circuitbreaker é quando o Ibovespa atinge limite de baixa de 10% em relação ao

fechamento do dia anterior.

14

Desta forma, espera-se que os modelos da classe DDMS também possam ser utilizados na con-
strução de trading systems.

A estratégia de investimento consiste em investir no ativo de risco, neste caso, o índice
Bovespa, exatamente na proporção dada pela probabilidade do regime de retorno positivo e
baixa volatilidade, Bull Market. O restante, um menos essa probabilidade será investido no
ativo livre de risco, ou seja, o certiﬁcado de deposito interbancário (CDI).

Para a estratégia de investimento ganhar maior realismo, devemos usar a probabilidade de
predição estimada a cada período de tempo, ao invés de estima-la levando em consideração a
série como um todo. Conforme visto na seção anterior, a probabilidade de predição nos dá
a previsão do período t baseada na informação do período t − 1. A cada nova informação o
modelo é reestimado, ou seja, essas probabilidades são computadas através de uma janela em
expansão.

A janela em expansão, e consequentemente a estratégia de investimento abordada, abrange
junho de 2003 a dezembro de 2012. A previsão será feita para aproximadamente 10 anos de
amostra. As primeiras 466 observações do total das 966 são usadas como pré-amostra para ini-
ciar a estimação dos modelos. Os resultados a seguir apresentam o desempenho das estratégias
de investimento para os modelos DDMS-2 e DDMS- ARCH. Os retornos aqui não levam em
conta os custos de transação e corretagem.

Table 4: Retorno Acumulado ao Ano

Ano
2003∗
2004
2005
2006
2007
2008
2009
2010
2011
2012
Média

DDMS-2
93,53%
21,40%
28,53%
34,14%
41,47%
−25,76%
72,09%
2,04%
−14,83%
8,50%
21,31%
36,88
0,34

DDMS-ARCH

94,52%
22,33%
28,89%
35,29%
46,46%
−18,79%
70,64%
2,39%
−14,66%
9,72%
23,23%
36,00
0,39

Ibovespa
93,49%
16,71%
27,71%
32,93%
43,65%
−37,01%
70,43%
1,05%
−18,11%
7,40%
18,05%
39,18
0,26

CDI

23,21%
16,01%
19,00%
15,16%
11,84%
12,41%
9,88%
9,68%
11,59%
8,49%
13,64%

4,64
0,00

Desvio Padrão
Índice de Sharpe
∗ 2003 é computado a parir de junho.

A tabela acima mostra que os retornos anuais das estratégias de investimento são superiores
à estratégia buy and hold para o índice Bovespa, ou seja, investir no índice e desfazer-se do
mesmo no ﬁnal do período. Entretanto, é interessante destacar que o retorno médio entre os
anos de 2005 a 2007 - tanto da bolsa quanto das estratégias – são muito próximos. Nesse

15

período a probabilidade de Bull Market foi alta e persistente, desta forma, a estratégia seguiu o
mercado.

A análise para o período como um todo (2003 – 2012), revela que o retorno médio das
estratégias são 23,23% e 21,31% - muito superiores ao retorno médio da bolsa 18,05%. O
mesmo resultado é assegurado quando comparado com o retorno médio do CDI, 13,34%. Ape-
nas nos anos de 2008 e 2011, o CDI apresentou uma rentabilidade maior que as estratégias
investimento. Isso é explicado pela previsibilidade dos modelos, uma vez que as probabilidades
de Bear Market foram mais elevadas no período da crise do subprime e do rebaixamento da
nota dos títulos americano. Destaque é dado ao modelo DDMS-ARCH, pois a estratégia ap-
resentou maior índice de Sharpe (0,39). Uma explicação para isso, é que no modelo em que a
volatilidade é heterocedástica o risco é menor.

A ﬁm de comparar o retorno das estratégias de investimento oferecidas pelos modelos da
classe DDMS, foram estimados modelos de mudança de regime sem duration dependece. Con-
forme visto na seção 2.1, os modelos acima, podem ser restritos, de tal forma, que a matriz de
probabilidade de transição seja ﬁxa. Neste caso, os modelos serão mais parcimoniosos uma vez
que reduziremos o numero de parâmetros que deﬁnem a transição de estado. Para ﬁm de com-
paração, a ordem tanto da média quanto da variância condicional, foram mantidas na estimação.
Os valores dessas estimativas ﬁcaram dentro do circulo unitário.

Table 5: Resultado das Estimativas

Parâmetros

µ0,µ

µ1

m,σ

m0,σ0

m1,σ1

γ1(0)

γ1(1)
lnL

MS-2

MS-ARCH
AR(2)
0.2840∗∗ −0.9684∗ −2.4857∗∗
(0.1536)
(1.0726)
0.4787∗∗∗
(0.1223)

(0.7178)
0.5343∗∗∗
(0.1310)

4.6529∗∗∗
(0.1060)

58.9153∗∗∗
(12.4826)
8.2014∗∗∗
(1.0146)
2.2073
(0.5416)
4.2816
(0.4538)
−2850.0 −27498.2 −27215.8

8.1586∗∗∗
(0.5512)
3.4924∗∗∗
(0.0996)
2.8144∗∗∗
(0.4347)
4.4549∗∗∗
(0.4042)

∗∗∗,∗∗ ,∗ signiﬁcância em 1%,5% e 10% respectivamente. Desvio padrão está em parênteses.
lnL é o valor da log verossimilhança.

Os resultados mostram que a estratégias de investimento dos modelos sem duration de-
pendece, apresentaram um desempenho muito similar aos modelos da classe DDMS quando

16

comparados com a estratégia buy and hold, assim atingindo os resultados esperado desta seção.
Entretanto, retorno médio oferecido pelos modelos sem duration dependece foi maior para
ambas as especiﬁcações. No caso em que a variância incondicional muda de regime, o modelo
MS-2 apresentou um retorno médio de 24,22% contra 21,31% do modelo DDMS-2. No caso
em que a variância condicional é modelada, o mesmo resultado é evidenciado, o modelo MS-
ARCH proporcionou um retorno médio de 26,33% contra 23,33% do modelo DDMS-ARCH.
Uma explicação para o maior retorno das estratégias de investimento em modelos em que não
tem duration dependece, baseia-se na evidência empirica de que modelos mais parcimoniosos
tem melhor capacidade de previsão.

A análise do índice de Sharpe mostrou novamente que no modelo onde a variância é condi-
cional, o retorno é maior que na especiﬁcação homocedástica. Quando comparados com os
modelos da classe DDMS, ambos apresentaram melhor valor para o índice.

Table 6: Retorno Acumulado ao Ano

Ano
2003∗
2004
2005
2006
2007
2008
2009
2010
2011
2012
Média

MS-2
95,02%
24,61%
29,36%
35,56%
43,65%
−16,57%
76,23%
2,42%
−12,99%
9,06%
24,22%
36,22
0,41

MS-ARCH

95,33%
26,57%
29,74%
37,67%
50,58%
−10,16%
72,21%
3,31%
−12,30%
11,17%
26,33%
34,98
0,48

Ibovespa
93,49%
16,71%
27,71%
32,93%
43,65%
−37,01%
70,43%
1,05%
−18,11%
7,40%
18,05%
39,18
0,26

CDI

23,21%
16,01%
19,00%
15,16%
11,84%
12,41%
9,88%
9,68%
11,59%
8,49%
13,64%

4,64
0,00

Desvio Padrão
Índice de Sharpe
∗ 2003 é computado a parir de junho.

Por ﬁm é interessante destacar que o valor da verossimilhança obtido ao estimar os modelos
dentro da amostra, mostra que os modelos com duration dependece obtiveram melhor ajuste e
apresentram melhor capacidade de identiﬁcar Bull e Bear Market. Esse resultado já era esper-
ado, uma vez que a parametrização proposta neste artigo buscou captar a dinâmica intra-regime.

17

5 Conclusão

O principal objetivo deste trabalho foi identiﬁcar períodos de Bull e Bear Market no índice
Bovespa. Os resultados mostraram que no regime ascendente, o parâmetro da média foi positivo
acompanhado por uma baixa variância. Já no regime descendente, a média foi negativa e a
variância alta. Esses resultados são similares aos encontrados por Maheu & McCurdy (2000) e
Shibata (2011).

Diferentemente do modelo de mudança de regime tradicional, o emprego do duration de-
pendence caracterizou a dependência de longo prazo na estrutura cíclica do retorno acionário.
A parametrização empregada, captou o efeito de que a persistência do estado ascendente torna
os investidores mais otimistas em relação ao futuro. Essa resposta positiva faz com que a prob-
abilidade de troca de regime diminua ao longo do tempo, ou seja, aumento na probabilidade de
permanência no estado. De modo reciproco, a persistência do estado descendente aumenta o
pessimismo dos investidores sobre os retornos futuros.

Devemos ter cautela em especiﬁcar a estrutura dos dados ﬁnanceiros apenas por um pro-
cesso de markov de primeira ordem, fato evidenciado pela memória curta dos parâmetros. Os
modelos da classe DDMS, tanto na média como na variância condicional, buscaram corrigir
a inﬂuencia intra-regime ao melhorar a estimação das probabilidades suavizada - destaque foi
dado ao modelo DDMS-ARCH, pois este apresentou melhor ajuste.

Por ﬁm, o retorno obtido pelos modelos da classe DDMS ao construitr estratégias de in-
vestimento, fora da amostra, foi similar aos dos modelos que não incorporam duration depen-
dence. Ambas especiﬁcações superaram os retornos do Ibovespa e CDI. Já a análise do índice
de Sharpe, revelou que os modelos de mudança de regime sem dependência de duração, ob-
tiveram melhor desempenho. Em contrapartida, a estimação desses modelos dentro da amostra,
revelou que os modelos da classe DDMS têm melhor capacidade de indentiﬁcar Bull e Bear
Market.

References

Almeida, N. & Valls, P. (2000), ‘Switching regimes models for ﬁnancial time series: an empir-

ical study for trading rules’, Annals of the XXII Brazilian Econometric Meeting 1, 49–68.

Bollerslev, T. (1986), ‘Generalized autoregressive conditional heteroskedasticity’, Journal of

Econometrics (31), 307–27.

Brock, W., Dechert, W. & Sheinkman, J. A. (1987), A test for independence based on the

correlation dimension. Working Paper 8702, University of Wiscosin, Dept. of Economics.

Bry, G. & Boschan, C. (1971), ‘Cyclical analysis of time series: Selected procedures and com-

puter programs’, NBER, New York, NY, USA .

Cai, J. (1994), ‘A markov model of switching-regime arch’, Journal of Business & Economic

Statistics (12), 309–316.

18

Campbell, J., Lo, A. & Mackinley, A. (1997), The Econometrics of Financial Markets, Prince-

ton University Press, USA; Princeton, New Jersey.

Castro, V. (2011), The portuguese stock market cycle: Chronology and duration dependence.

Working Paper NIPE WP 13.

Chauvet, M. (1999), ‘Stock market ﬂuctuations and the business cycle’, Journal of Economic

and Social Measurement 25(3/4), 235–258.

Chena, S.-W. & Shen, C.-H. (2007), ‘Evidence of the duration-dependence from the stock mar-

kets in the paciﬁc rim economies’, Applied Economics 39, 1461–1474.

Durland, J. & McCurdy, T. (1994), ‘Duration-dependent transitions in a markov model of u.s

gnp growth’, Journal of Business & Economics Statistics .

Engle, R. (1982), ‘Autoregressive conditional heteroskedasticity with estimates of the variance

of uk inﬂation’, Econometrica (50), 987–1008.

Estrella, A. & Mishkin, F. (1998), ‘Predicting us recessions: Financial variables as leading

indicators’, Revies of Economics and Statistics 80(1), 45–61.

Hamilton, J. (1994), Time series analysis, Princeton University Press, Princeton, New Jersey.

Hamilton, J. D. & Susmel, R. (1994), ‘Autoregressive conditional heteroskedasticity and

changes in regime’, Journal of Econometrics (64), 307–333.

Harris, L. (2003), Trading and Exchanges: Market Microstructure for Practitioners, Oxford

University Press, USA; New York, New York.

Kim, C.-J. & Nelson, C. (1999), State-space models with regime switching, MIT Press, London,

England; Cambridge, Massachusetts.

Kole, E. & Dijk, J. (2012), How to identify and predict bull and bear markets? Econometric

Institute, Erasmus School of Economics, Erasmus University Rotterdam.

Lunde, A. & Timmermann, A. (2004), ‘Duration dependence in stock prices: an analysis of bull

and bear markets’, Journal of Business & Economic Statistics (22), 253–273.

Maheu, J. & McCurdy, T. (2000), ‘Identifying bull and bear markets in stock returns’, Journal

of Business & Economic Statistics (18(1)), 100–112.

Marcellino, M. (2006), Handbook of economic forecasting, Elsevier, Amsterdam, Netherlands,

chapter Leading indicators: What have we learned?, pp. 876–960.

Pagan, A. & Sossounov, K. (2003), ‘A simple framework for analyzing bull and bear markets’,

Journal of Applied Econometrics (18(1)), 23–46.

Rigobon, R. & Sack, B. (2003), ‘Measuring the reaction of monetary policy to the stock market’,

Quaterly Journal of Economics 118(2), 639–669.

19

Shibata, M. (2011), ‘Identifying bull and bear markets in japan’, Asia-Paciﬁc Financial Markets

(19(2)), 99–117.

Stock, J. & Watson, M. (2003), ‘How did leading indicator forecasts do during the 2001 reces-

sion?’, Federal Reserve Bank of Richmond Economic Quaterly 89, 71–90.

Stock, J. & Watson, M. (2006), ‘Why has u.s. inﬂation become harder to forecast’, Journal of

Money, Credit and Banking 39(1).

20

