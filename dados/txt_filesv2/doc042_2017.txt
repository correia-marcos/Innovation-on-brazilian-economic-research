Fixed-income portfolio optimization based on dynamic Nelson-Siegel models with

macroeconomic factors for the Brazilian yield curve

Richard Schnorrenberger∗

Guilherme Valle Moura†

Abstract

The study investigates the statistical and economic value of forecasted yields generated by dynamic
yield curve models which incorporate a large macroeconomic dataset. The analysis starts off by
modeling and forecasting the term structure of the Brazilian nominal interest rates using several
speciﬁcations for the dynamic Nelson-Siegel (DNS) framework, suggested by Diebold and Li (2006).
The comparison of forecast performance for forecast horizons above three months supports the
evidence for the incorporation of one macroeconomic factor that summarizes broad information
regarding mainly inﬂation expectations.
In order to assess the economic value of those forecasted
yields, a ﬁxed-income portfolio optimization using the mean-variance approach of Markowitz (1952) is
performed. The analysis indicate that good yield curve predictions are important to achieve economic
gains from forecasted yields in terms of portfolio performance. Preferred forecasted yields for short
forecast horizons perform quite well for optimal mean-variance portfolios with one-step-ahead
estimates for ﬁxed-income returns, while forecasted yields generated by a macroeconomic DNS
speciﬁcation outperforms in terms of portfolio performance with six-step-ahead estimates. Therefore,
there is an economic and statistical gain from considering a large macroeconomic dataset to forecast the
Brazilian yield curve dynamics, specially for longer forecast horizons.

Keywords: Fixed-income portfolio optimization. Brazilian yield curve. Dynamic Nelson-Siegel model.
Macroeconomic factors. Yield curve forecasting. Mean-variance approach.

Resumo

O estudo investiga o valor estatístico e econômico dos rendimentos previstos por modelos dinâmicos da
curva de juros que incorporam um grande conjunto de dados macroeconômicos. A análise parte da
modelagem e previsão da estrutura a termo das taxas de juros nominais brasileiras, usando diversas
especiﬁcações para o modelo dinâmico de Nelson-Siegel (DNS), sugerido por Diebold and Li (2006).
A análise comparativa de performance preditiva dos modelos para horizontes de previsão acima de três
meses apoia a evidência para a incorporação de um fator macro que resume principalmente
informações gerais sobre expectativas de inﬂação. Para avaliar o valor econômico dos rendimentos
previstos, é realizada uma otimização de carteira de renda ﬁxa usando a abordagem de média-variância
de Markowitz (1952). A análise indica que boas previsões para as curvas de juros são importantes para
obter ganhos econômicos com os rendimentos previstos em termos de desempenho do portfólio.
Rendimentos previstos com maior precisão para horizontes de previsão curtos atingem bons resultados
para portfólios ótimos que utilizam estimativas de um passo a frente para os retornos de renda ﬁxa,
enquanto que rendimentos previstos gerados por uma especiﬁcação macroeconômica do modelo DNS
atingem bom desempenho para a otimização que utiliza estimativas de doze passos a frente. Portanto,
há um ganho econômico e estatístico ao considerar um grande conjunto de dados macroeconômicos
para prever a dinâmica da curva de juros brasileira, especialmente para horizontes maiores de previsão.

Palavras-chave: Otimização de portfólio de renda ﬁxa. Curva de juros brasileira. Modelo dinâmico de
Nelson-Siegel. Fatores macroeconômicos. Previsão da curva de juros. Abordagem de média-variância.

Códigos JEL: C13; C5; E43; E44; E47.
Área ANPEC: 4 - Macroeconomia, Economia Monetária e Finanças.

∗Master Degree in Economics, Universidade Federal de Santa Catarina. Email: richard.schnr@gmail.com
†Department of Economics, Universidade Federal de Santa Catarina. Email: guilherme.moura@ufsc.br

1

1

Introduction

There is a wide heterogeneity between term structure models that try to ﬁt and forecast the dynamic
behavior of yield curves. Traditional term structure models decompose interest rates into a set of yield
latent factors, such as level, slope and curvature (Litterman and Scheinkman, 1991). Even providing good
in-sample ﬁt (Nelson and Siegel, 1987; Dai and Singleton, 2000) and satisfactory results for out-of-sample
forecasts (Duffee, 2002; Diebold and Li, 2006), the economic meaning of such models is limited since
they neglect a macroeconomic environment that could affect interest rates of different maturities. Many
yield curve models simply ignore macroeconomic linkages. Nonetheless, there are macroeconomic forces
that shape the term structure, so that changes in macroeconomic variables can have some impact on future
movements of the yield curve (Gürkaynak and Wright, 2012). According to Ang and Piazzesi (2003), the
incorporation of macroeconomic information can generate term structure models that forecast better than
those without macroeconomy effects, which is of great interest for ﬁxed-income portfolio analytics.
Thereby, researchers have begun to use a joint macro-ﬁnance modeling strategy, which provides the most
comprehensive understanding of the term structure of interest rates.

The development of term structure models that integrate macroeconomic and ﬁnancial factors is recent
in economic research. Ang and Piazzesi (2003), Diebold et al. (2006) and Hördahl et al. (2006) provide the
pioneering studies that incorporate macroeconomic information to explain the dynamics of the yield curve
through time, and thus representing an active progress to solve the missing linkage between macroeconomy
and term structure models. Diebold et al. (2006) provide a macroeconomic interpretation of the DNS model,
suggested by Diebold and Li (2006). They combine observable macroeconomic variables, basically related
to real activity, inﬂation, and monetary policy, and yield factors into the Vector Autoregression (VAR) that
governs the dynamics of factors. While these studies consistently ﬁnd signiﬁcant relationships between
macroeconomic variables and government bond yields, they ignore potential macroeconomic information
that could be useful for yield curve modeling and forecasting.

More recently, a literature that uses large macroeconomic datasets has emerged, based on the idea that
monetary authorities use rich information sets to take monetary policy decisions (Bernanke and Boivin,
2003). Moench (2008) proposed to use the “Factor-Augmented VAR” (FAVAR) (Bernanke et al., 2005)
procedure to jointly model
the yield curve dynamics and macro factors extracted from a large
macroeconomic dataset,
taking advantage of systematic information contained within large datasets.
De Pooter et al. (2010) and Favero et al. (2012) also use “data-rich environments” for the term structure by
extracting common macro factors through dimensionality reduction techniques, such as principal
component analysis.
In addition, Vieira et al. (2017) combine the FAVAR methodology with the DNS
model for the Brazilian yield curve, adding forward-looking variables about the macro-ﬁnancial scenario
into the macroeconomic dataset.
In general, these studies consistently reveal that the inclusion of few
macro principal components leads to better out-of-sample yield forecasts compared to benchmark models
that use individual macro variables or do not incorporate macroeconomic information.

Term structure models play an important role in ﬁxed-income asset pricing, strategic asset allocation
and portfolio analytics. The evolution of the yield curve is essential to compute the risk and return
characteristics of one’s ﬁxed-income portfolio (Bolder, 2015).
In order to take an active position in a
ﬁxed-income portfolio, based on the mean-variance approach of Markowitz (1952), dynamic yield curve
models are used to generate yield forecasts for selected maturities, which are then used to compute
expected ﬁxed-income returns. The ﬁxed-income portfolio problem essentially consists in predicting the
distribution of returns for a set of maturities and select the optimal vector of portfolio weights conditional
on one’s expected returns and risk preferences.

Although the mean-variance approach of Markowitz has been widely explored in the context of equity
portfolios, little is known about portfolio optimization in ﬁxed-income markets. A recent literature,
kick-started by Korn and Koziol (2006), that exploits the risk-return trade-off in bond returns has emerged.
Caldeira et al. (2016) perform a mean-variance bond portfolio selection by employing dynamic factor
models for the term structure and derive simple closed-form expressions for expected bond returns and

2

their covariance matrix based on forecasted yields. Along with those studies, the present study contributes
to validate the use of term structure models to perform mean-variance optimization in the ﬁxed-income
context using datasets of Brazilian nominal interest rates.

This study contributes to the present literature by assessing the economic value of forecasted yields
generated by yield curve models which incorporate a large macroeconomic dataset. That is, it combines
the beneﬁts from incorporating macroeconomic information into term structure models and the use of those
forecasted yields to assess their economic value through a portfolio optimization analysis. The incorporation
of macro factors into term structure models has the theoretical premise of increasing the model’s predictive
power. In this sense, the main question is the following: Is there some economic gain, in terms of portfolio
performance, from incorporating macroeconomic information into term structure models? Hence, the major
purpose is to investigate the magnitude of the statistical and economic gain with the incorporation of a large
macroeconomic dataset into the dynamic Nelson-Siegel model.

The empirical evidence indicates that the incorporation of one macro factor, which summarizes broad
macroeconomic information regarding mainly inﬂation expectations, contributes to improve yield curve
predictions for 6- and 9-month-ahead forecast horizons, specially for medium and long-term maturities. The
conclusion that macroeconomic information tends to improvement in yield curve forecasting extend results
found in previous literature. In the context of portfolio selection, good yield curve predictions proved to
be important to achieve better results in terms of portfolio performance. Parsimonious yield curve models
without macroeconomic information and with better forecast accuracy for short forecast horizons perform
quite well for optimal mean-variance portfolios with one-step-ahead estimates for ﬁxed-income returns. On
the other hand, forecasted yields generated by a macroeconomic speciﬁcation provide better information
to perform a mean-variance portfolio optimization which uses six-step-ahead estimates for ﬁxed-income
returns.

The outline of the study is as follows. Section 2 discusses the theoretical dynamic yield curve models
used for the prediction analysis, while Section 3 describes the empirical data and the estimation procedure.
Section 4 discusses the empirical results and discussion regarding the out-of-sample forecast exercise for
the Brazilian yield curve and reports results for the application of those forecasted yields to ﬁxed-income
portfolio optimization. Finally, Section 5 is composed by concluding remarks.

2 The dynamic Nelson-Siegel model

In general, many forces are at work at moving interest rates. Identifying these forces and understanding
their impact on yields, is therefore of crucial importance for asset pricing, portfolio analytics and risk
management (De Pooter et al., 2010). Term structure models aim to specify the behavior of interest rates,
seeking to identify the driving factors that help to explain prices of ﬁxed-income securities.

Diebold and Li (2006) suggested the dynamic Nelson-Siegel model by introducing dynamic
components through time-varying parameters to the static Nelson and Siegel (1987) framework.
Furthermore, up to Diebold and Li (2006) few term structure models gave importance to out-of-sample
forecasting perspective1. The mechanics of DNS follow the functional form of Nelson and Siegel (1987),
which speciﬁes a linear combination of three smooth exponential factors to adjust the variety of yield
curve shapes for a given point in time. The DNS model has a good cross section ﬁt to the observed interest
rates at different maturities and incorporates a time-series environment through time-varying factors:

(cid:18)1 − e−λτ

(cid:19)

(cid:18)1 − e−λτ

λτ

(cid:19)

yt(τ ) = β1t + β2t

+ β3t

λτ

− e−λτ

.

(1)

1Diebold and Li (2006) argue that equilibrium and arbitrage-free models focus only on ﬁtting the term structure at a given
point of time to ensure the absence of arbitrage opportunities. As they seek to incorporate dynamic and the out-of-sample forecast
perspective to yield curve, the authors use a model capable to describe the future dynamics of the yields for different maturities
over time.

3

where y(τ ) represents the continuously compounded yield to maturity of a zero coupon bond with maturity
τ and maturity value equal to unity, and parameter λ controls the exponential decay rate of the curve, or
the rate at which factor loadings decay to zero. DNS carries cross-sectional and time-series perspectives,
representing a spatial and temporal linear projection of yt(τ ) on the time-varying variables β1t, β2t and β3t,
which can be interpreted respectively as level, slope and curvature factors of the term structure (Litterman
and Scheinkman, 1991). Theoretical analysis regarding the interpretation of yield latent factors (β1t, β2t,
β3t) can be found in Diebold and Li (2006).

The class of Nelson-Siegel models has long been a popular choice among central bankers and ﬁnancial
market practitioners, supported by its appealing statistical features concerning smoothness, ﬂexibility and
parsimony. According to Diebold and Rudebusch (2013), dynamic factor models provide appealing features
because yield data actually display factor structure. Some key reasons prove its statistical appealing: (i)
factor structure generally provides a highly accurate empirical description of yield curve data, because just
a few constructed factors can summarize bond price information; (ii) statistical tractability, by providing
a valuable compression of information, effectively collapsing an intractable high-dimensional modeling
situation into a tractable low-dimensional situation. Beyond good ﬁt and good forecast performance of
DNS, its simplicity conﬁrms the increasing popularity of the DNS framework.

State-space representation of the DNS model

(ft − µ) = A(ft−1 − µ) + ηt,

Diebold and Li (2006) show that it is possible to interpret the DNS model in state-space system format,
assuming that the dynamic latent factors are state variables and follow a stochastic ﬁrst-order VAR. The
state space system constituted by the measurement and transition equations can be summarized by the
matrix notation:

(2)
(3)
for t = 1, ..., T , where yt is the N × 1 vector of observed yields for N different maturities τi at time t, so
that yt = [yt(τ1), yt(τ2), ..., yt(τN )](cid:48), where τ1 is the shortest selected maturity and τN is the longest; ft is
the m × 1 state vector containing the level (Lt), slope (St) and curvature factors (Ct); µ is the factor mean;
A is the m × m state transition matrix; ηt is the m × m state equation factor disturbances; Λ is the N × m
sensitivity matrix of the measurement equation; and εt is the N × 1 vector containing the measurement
disturbances.

yt = Λft + εt,

The measurement equation (3) adds a stochastic error term which relates the set of N yields to the
unobserved yield latent factors. So, the factor loadings matrix Λ relates the yield curve dynamic to the
constructed factors. The transition equation (2) determines the common factor dynamics as a ﬁrst-order
process. The covariance structure of the white noise transition and measurement disturbances specify that
vectors ηt and εt are orthogonal to each other and to the initial state:

(cid:18)ηt

(cid:19)

εt

(cid:20)(cid:18)0
(cid:19)

(cid:18)Q 0

(cid:19)(cid:21)

,

0

0 H

∼ W N

,

(4)

The covariance matrix of measurement disturbances H is assumed to be diagonal, so that the disturbances
εt of different maturities are uncorrelated 2. Further, the covariance matrix of transition disturbances Q is
not diagonal, so that the disturbances ηt can be correlated in time, allowing for correlated shocks between
yield latent factors.

2According to Diebold et al. (2006), this assumption is common in the literature for simplifying model estimation by reducing

the number of parameters.

4

Speciﬁcation of the macroeconomic models

Following Diebold et al. (2006), the introduction of relationship between the components of the yield
curve and macroeconomic factors consists simply in incorporating macro factors as exogenous
explanatory variables into the state vector and corresponding expansion of the matrices that form the
state-space model (2)-(4). The approach here simply replaces the individual macroeconomic variables
used in Diebold et al. (2006) by a small number of macroeconomic factors obtained from a large set of
possible regressors. Therefore, the model structure only contemplates effects of macro factors to yield
factors in future time periods via dynamic interaction in the transition equation.

The assumption that in a DNS environment, the yield curve can be simply decomposed by Lt, St, and
Ct, remains valid. The three yield factors are all that one needs to explain most yield variation (Diebold
and Rudebusch, 2013), so that the inclusion of macro factors will be used to explain the dynamics of the
yield latent factors. Thus, macroeconomic factors extracted from a large set of macroeconomic variables
are linked to yield factors, so that a kind of two-step DNS procedure is employed. First, macro factors (e.g.,
broad real activity and broad inﬂation expectations) are extracted, and then all factors are analyzed in a joint
VAR.

The expansion of the DNS-VAR(3) model to macroeconomic representations of the DNS form is given
by the incorporation of one and two macro factors, denoted by X 1 and X 2, to the state vector. The state
vector is now f
t ) for
t ) for the model denominated DNS-
the model denominated DNS-VAR(4)2 and f
VAR(5). Sometimes, these macroeconomic speciﬁcations will be regarded as yields-macro models. Table 1
summarizes these general DNS speciﬁcations used in the estimation procedure.

t ) for the model denominated DNS-VAR(4)1, f

(cid:48)(cid:48)
t = (Lt, St, Ct, X 1

(cid:48)
t = (Lt, St, Ct, X 1

(cid:48)
t = (Lt, St, Ct, X 2

t , X 2

Table 1: General DNS speciﬁcations set.

Model Speciﬁcation

Factors

DNS-VAR(3)
DNS-VAR(4)1
DNS-VAR(4)2
DNS-VAR(4)
DNS-VAR(5)
yields-macro

Level (Lt), Slope (St), Curvature (Ct)
Level (Lt), Slope (St), Curvature (Ct) and 1st Macro Factor (X 1
t )
Level (Lt), Slope (St), Curvature (Ct) and 2nd Macro Factor (X 2
t )
Comprehends the DNS-VAR(4)1 and DNS-VAR(4)2 models
Level (Lt), Slope (St), Curvature (Ct), 1st Macro Factor (X 1
Comprehends the DNS-VAR(4) and DNS-VAR(5) models

t ) and 2nd Macro Factor (X 2
t )

The inclusion of the K = 1, 2 macroeconomic factors is motivated by the principal components analysis,
which extract a small number of common factors from a panel series composed by 182 macroeconomic
variables. The approach is supported by the set of conditioning information that monetary authorities take
(cid:48)(cid:48)
t is performed
into account when deciding interest rates levels. The ordering of the state factors in f
this way because the information of the yield curve is observed at the beginning of each month. The
expansion of the DNS model also requires an appropriate increase in the dimensions of the matrices that
form the system (2)-(4), leading to a considerable increase in the number of parameters to be estimated.

(cid:48)
t and f

3 Estimation methodology and data

3.1 Estimation procedure

The DNS state-space structure represented by (2)-(4) implies that Kalman ﬁlter is immediately applicable
for optimal ﬁltering of the yield latent factors (Diebold and Rudebusch, 2013). The unobserved state
vector ft and parameters of the system can be estimated by the one-step DNS approach introduced by
Diebold et al. (2006). The method estimates the conditional distribution of vector ft given the set of
information contained in the vector of observed variables Yt = {y1, ..., yt}, building the likelihood function
to be maximized. For the macroeconomic DNS structure, the one-step DNS is not absolutely one-step

5

once macroeconomic factors are obtained separately from the state-space estimation. Thus, macro factors
primarily extracted from principal component analysis (PCA)3 are simply combined with yield latent
factors in the state transition equation.
For a certain time series YT = {y1, ..., yT}, Kalman ﬁlter algorithm works recursively for t = 1, ..., T
with initial values for the set of unknown parameters collected in θ. The vector θ is composed by parameters
of matrices A, Q and H, together with the vector of average factor states µ and parameter λ, which are
treated as time-invariant. The estimation of θ uses a numerical optimization method that maximizes the
log-likelihood function4, which is constructed via decomposition of the one-step-ahead prediction error
(vt = yt − Λft|t−1, where ft|t−1 is the expectation for the state vector ft given the set of information Yt−1):

l(θ) = −N T
2

log(2π) − 1
2

log|Ft| − 1
2

(cid:48)

t log(F −1
v

t

)vt,

(5)

T(cid:88)

t=1

T(cid:88)

t=1

where Ft is the covariance matrix of the one-step-ahead observation forecasts. For the DNS-VAR(3) model,
the Kalman ﬁlter procedure starts with initial values for the set of parameters θ0 that comes from the two-
step DNS approach described in Diebold and Li (2006), and the initial state values are simply their average
ﬁltered in two-step DNS approach. For yields-macro models, A0 and B0 are set to zero, D0 with respect
to yield components comes from the two-step DNS approach while the part related to macro factors is set
to zero, and f0 and λ0 follow the assumptions made for DNS-VAR(3) model. The initial value for λ0 is
calibrated at 0.0726, as suggested by Diebold and Li (2006).

Immediately, if information is available by time t, for the h-step-ahead forecast horizon the construction
of out-of-sample forecasts consists simply in forecasting the factors for a given forecast horizon and apply
them to the yield curve equation:

ft+h|t = Et(ft+h|yt, ..., y1) = µ +

Aj (ft|t − µ) = µ + Ah(ft|t − µ),

(6)

yt+h|t = Et(yt+h|yt, ..., y1) = ΛEt(ft+h|yt, ..., y1) = Λµ + Λ(Ah(ft|t − µ)).

(7)
Again, the application of Kalman ﬁlter is convenient to extract the optimal general h-step-ahead prediction
of both the yield factors and the observed yields (ft+h|1:t, yt+h|1:t).

j=t+1

3.2 Data description

The macroeconomic factors are extracted from a macro panel containing 182 monthly time series for the
Brazilian economy. The table containing the macroeconomic panel data, and each preadjustment applied to
obtain stationary time series, is not reported to save space and can be provided upon request. The individual
variables are classiﬁed in various economic categories as follows: money growth (about 6% of the total set
of variables), consumption and sales (10.5%), credit (5.5%), employmet, wage and income (9.4%), price
(22.5%), production and real activity (18.7%), ﬁnancial and risk (5%), ﬁscal (5.5%), and external sector
(17%). Regarding the timing of the macro series, it is worth to note that the observation of macroeconomic
data by agents only happens after a certain time of the reference month, because several variables take
some time to be released. Thereby, the analysis assumes that agents have an expectation or trustworthy
proxy about the current macroeconomic scenario.

Most part of the macroeconomic dataset originates from Rossi and Carvalho (2009) and Almeida and
Faria (2014), while the forward-looking variables are based on some variables used by Vieira et al. (2017).

3PCA takes advantage of the redundancy of information contained within big data, identifying the patterns in data and
replacing a group of variables that measure the same phenomenon by a few new variables. The method generates a set of new
variables, called principal components, which form a linear combination of the original variables. The usefulness of PCA regards
to data dimensionality reduction without much loss of information.

4The MATLAB estimation code uses “fminunc” function to optimize the procedure of ﬁnding the unknown parameters.

6

t+h(cid:89)

The forward-looking variables refers to market expectations about several key economic variables,
available in the weekly market reports published by the Central Bank of Brazil, so-called Focus report.
The forward-looking variables considered focus on the mean of market expectations for 1-1.5 year ahead,
2-2.5 year ahead and 3-5 year ahead. This gives a solid information about the future state of the Brazilian
macroeconomy.

Time series regarding Brazilian interest rates are removed from the macro dataset to avoid complications
that could emerge for the estimation process from not using an arbitrage-free model. Moench (2008) and
Koopman and Van der Wel (2013) also remove all variables relating to interest rates, arguing that central
banks do not take into account the information contained in yields when making monetary policy decisions.
The yields data consists in monthly observed yields of Brazilian Inter Bank Deposit Future Contract (DI-
futuro) negotiated at the Brazilian Mercantile and Futures Exchange (BM&F)5. Information about DI-futuro
contracts are taken from the ﬁrst business day of the month in which the contract is due. The interpolated
yield curves are obtained by cubic splines interpolation6, which allows one to convert observed yields into
relevant maturities. The present study converts data into the following N = 14 different maturities; τ =
3, 6, 9, 12, 15, 18, 21, 24, 27, 30, 36, 42, 48 and 60 months. The estimation procedure is carried out for
the in-sample period from 2003:04 to 2012:11, while the predictive analysis is performed for the out-of-
sample period from 2012:12 to 2016:03; a total of T = 116 in-sample and S = 40 monthly out-of-sample
observations.

4 Empirical results and discussion

4.1 Preliminary evidence

The analysis uses two macro factors extracted from the large macroeconomic dataset, where both explain
about 24.8% of the overall variation in observed variables. The ﬁrst macro factor (X 1) exceeds 16.6%
of the total variance of the original data and correlates mostly with the following economic categories:
production and real activity, price, employment, wage and income. The second factor (X 2) accounts for
8.24% of the variation in original data and correlates mostly with real activity variables, external sector and
most prominently with inﬂation expectations. Besides that, individual forward-looking variables are highly
correlated with the common macro factors, specially X 1.

The correlations aforementioned give an indication that X 1 is possibly related to business cycle, while
X 2 is likely to represent the price level and central bank’s efforts to control inﬂation. In order to provide
some insights about these primary assumptions, Fig. 1 plots the X 1 and X 2 time series against some
highly correlated individual macroeconomic variables. The ﬁrst macro factor exhibited in panels (a) and
(b) is a relatively smooth time process that clearly shows characteristics related to business cycle once
it strongly correlates with market expectations for GDP and the General Registration of Employed and
Unemployed (CAGED). The graph from panel (a) undoubtedly evidence that X 1 follows the path that
market expectations are delineating for the one-year-ahead Brazilian economic scenario. For example, the
negative values for X 1 in the beginning of 2003, 2008 (recent ﬁnancial crisis) and after 2013, are clearly
associated with recession periods. For these reasons, X 1 can be labelled as business cycle factor.

On the other hand, panels (c) and (d) reveal a noisier process for X 2. Factor X 2 presents a relative strong
and positive correlation with market expectations for next 12 months IGP-DI and market expectations for 2-
2.5 years ahead IPA-M, both inﬂation indexes. Thus, it is plausible to assume that the second macro factor
reﬂect mainly inﬂation future scenarios, and can be labelled as inﬂation factor. These common factors
extracted here are in line with ﬁndings in Koopman and Van der Wel (2013) and De Pooter et al. (2010),
where the ﬁrst macro factor resembles the real activity and the second factor is mostly related to price

5More information on the operation of DI-futuro contracts can be found in Caldeira et al. (2013).
6The cubic splines interpolation, proposed by McCulloch (1971), employes piecewise combinations of cubic functions to ﬁt
the yield curve. In other words, a piecewise polynomial smoothly connects the yield curve between each pair of vertices (or knot
points) of the observed yield data.

7

indexes.

(a)

(c)

(b)

(d)

Figure 1: Plots of common macro factors and individual most correlated macroeconomic variables.

Next, table 2 presents summary statistics for the yield dataset at some selected maturities, including the
yield latent factors and the ﬁrst two standardized macroeconomic factors, dividing between in-sample and
out-of-sample periods. As analyzed in Diebold and Rudebusch (2013), several important yield curve facts
emerge: (i) time-averaged yields increase with maturity revealing an increasing and slightly concave shape;
which reports some kind of term premium, perhaps due to risk aversion, liquidity preferences, or preferred
habitats; (ii) yield volatilities decrease with maturity; (iii) yields are highly persistent, as evidenced by
the very large 1-month spread autocorrelations, specially for shorter maturities, and by the signiﬁcant 12-
month autocorrelations for the in-sample period. Despite being a period with increasingly shifts in yield
curve levels, the out-of-sample period reports lower yield levels in comparison with the in-sample period,
and thus, reduced volatility levels.

The in-sample observed yields data show an asymmetric distribution, where most of the observations
concentrate in lower rates, while the out-of-sample yields data only show the same behavior for shorter
maturities. In addition, the in-sample level factor is skewed to the right due to high observed yields of
the ﬁrst years of the sample period. The slope factor is negative in most part of both sample periods and
concentrate in the second quantile of its sample distribution. The observations regarding X 1 pursue areas
with positive values, albeit having an absolute minimum value higher than its maximum. So, as X 1 is
highly correlated with business cycle, its sample statistics reﬂect that there are more procyclical periods in
the Brazilian economy overall the sample period. The observations of X 2 point to a sample distribution
slightly skewed to the left, where data variation is larger for negative values. When it comes to sample
autocorrelations, the latent yield factors and X 1 exhibit high persistences at displacement of 1 month, while
X 2 shows a moderate persistence for the in-sample period.

8

Table 2: Summary statistics of yields and macro factors.

Mean

Sd

Quantiles

Min

Q(25%) Median Q(75%) Max

In-Sample Period Dataset: 2003:04 - 2012:11

ˆρ(1)

ˆρ(12)

DI-futuro yields (by maturity)

3
9
15
27
36
60

0.1356
0.1354
0.1369
0.1395
0.1406
0.1421

0.0410
0.0381
0.0360
0.0337
0.0335
0.0345

0.0741
0.0722
0.0745
0.0803
0.0827
0.0866

0.1085
0.1097
0.1117
0.1164
0.1177
0.1199

0.1233
0.1253
0.1268
0.1297
0.1293
0.1297

0.1620
0.1603
0.1623
0.1659
0.1650
0.1639

0.2617
0.2441
0.2429
0.2454
0.2516
0.2579

0.9415
0.9388
0.9297
0.9136
0.9042
0.9041

0.4257
0.4444
0.4333
0.4442
0.4656
0.4893

Yield curve latent factors (level, slope and curvature)

0.0390

0.1205
-0.0332
-0.0321

0.1459
0.0948
-0.0139 0.0297 -0.0806
-0.0029 0.0435 -0.1159

Lt
St
Ct
First two standardized principal components (PC) from the macro series
1st PC
2st PC

1
1
Out-of-Sample Period Dataset: 2012:12 - 2016:03

0.1328
-0.0173
-0.0022

0.1561
0.0005
0.0287

-4.3332
-2.8687

-0.5690
-0.7395

0.1103
-0.0199

0.6944
0.5401

0
0

0.2913
0.0567
0.1136

1.6153
4.1118

0.8878
0.8831
0.8951

0.4746
-0.0377
0.0058

0.8249
0.4741

0.1824
0.3055

DI-futuro yields (by maturity)

3
9
15
27
36
60

0.1140
0.1176
0.1197
0.1224
0.1231
0.1243

0.0244
0.0240
0.0233
0.0214
0.0211
0.0196

0.0703
0.0719
0.0734
0.0800
0.0819
0.0864

0.1004
0.1031
0.1077
0.1131
0.1141
0.1173

0.1113
0.1149
0.1192
0.1221
0.1230
0.1236

0.1401
0.1386
0.1364
0.1329
0.1307
0.1292

0.1474
0.1565
0.1613
0.1664
0.1671
0.1662

0.9389
0.9260
0.9147
0.8985
0.8943
0.8858

0.1129
0.1093
0.0881
0.0364
0.0024
-0.0687

Yield curve latent factors (level, slope and curvature)

0.0198

0.1266
0.0925
-0.0144 0.0172 -0.0395
-0.0041 0.0282 -0.0606

Lt
St
Ct
First two standardized principal components (PC) from the macro series
1st PC
2st PC

0.1173
-0.0281
-0.0243

0.1229
-0.0177
-0.0073

0.1346
-0.0008
0.0243

-1.8151
-2.0911

-0.9609
-0.5877

0.2068
0.0283

0.8576
0.7151

0
0

1
1

0.1689
0.0269
0.0539

1.6432
2.0193

0.8658
0.8036
0.6962

-0.1762
-0.0916
-0.0750

0.8406
0.1160

0.1282
-0.0394

Notes: The table presents the descriptive statistics for DI-futuro contracts over the in-sample and out-of-
sample periods. The monthly yield curves were constructed using cubic splines interpolation. For each
maturity, the table displays the mean, standard deviation (Sd), minimum (Min), 25% quantile, median, 75%
quantile, maximum (Max), and sample autocorrelations at displacements of 1 (ˆρ(1)) and 12 (ˆρ(12)) months.
In addition, it shows the statistics for the yield latent factors and for the ﬁrst two standardized principal
components extracted from the macro dataset.

4.2 Estimating term structure models
In-sample estimates
The results obtained from estimating the DNS speciﬁcation models represented by DNS-VAR(3) and the
set of yields-macro models, deﬁned in Section 2, indicate that on average the estimated models provide
a good ﬁt to the yield curve across the entire maturity spectrum, except for very short maturities. For
maturities above 9 months the models ﬁt the observed data efﬁciently well. The bad ﬁt behavior for short
maturities also is reported by Diebold et al. (2006), where estimated errors for yields of 3-months maturity
are relatively higher. In addition, yield curve estimates of the macroeconomic speciﬁcations for medium
and long-term maturities are more accurate than DNS-VAR(3) estimates. Furthermore, the estimated errors
of DNS-VAR(5) model are higher compared to DNS-VAR(4)2 model. These results sign for a path where
macroeconomic information can improve yield curve predictions, at least for longer maturities.

9

Out-of-sample estimates

In this section, we perform the out-of-sample forecast exercise using a rolling window analysis. This
implies that the multiple step ahead forecasts explored here are closely related to an investor’s pseudo
real-time decision. However, the analysis is not based on fully real-time data once some macroeconomic
variables are constructed from the revised dataset and some macro information have not been released yet
at the time when a forecast is made.

The forecast exercise for the multiple forecast horizons of 1-, 3-, 6-, 9- and 12-month-ahead are
performed with rolling window samples of size T = 116. Hence, the out-of-sample forecasts are carried
out over the time interval from December 2012, to March 2016. Predictions are made for T + h at the end
of each rolling window, where h is the forecast horizon. The number of rolling window samples is S = 40,
whereas the last 11 rolling window samples have some restrictions related to forecast horizons. That is,
there are 40 out-of-sample forecasts for 1-month horizon, 39 for 2-month horizon, and so on until 29
out-of-sample forecasts for 12-month horizon.

The evaluation of out-of-sample forecasts requires some measures to compute the errors for each
maturity τi. Given a time series of S out-of-sample forecasts for h-period-ahead forecast horizon, the root
mean squared forecast error (RMSFE) calculates a forecast error measure for maturity τi at forecast
horizon h and for model m:

RMSFEm(τi) =

(ˆyt+h|t(τi) − yt+h(τi))2,

(8)

where yt+h(τi) is the yield for the maturity τi observed at time t + h, and ˆyt+h|t(τi) is the corresponding
forecast made at time t. The performance analysis also reports the trace root mean squared forecast error
(TRMSFE), which calculates the trace of the covariance matrix of the forecast errors across all N maturities:

TRMSFEm(τi) =

(ˆyt+h|t(τi) − yt+h(τi))2

(9)

(cid:118)(cid:117)(cid:117)(cid:116) 1

S

S(cid:88)

t=1

(cid:118)(cid:117)(cid:117)(cid:116) 1

N

N(cid:88)

S(cid:88)

i=1

t=1

1
S

The Giacomini and White (2006) test is applied to compare forecast accuracy between two competing
models. The Giacomini-White (GW) statistic is a test of conditional forecasting ability, handling forecasts
based on both nested and non-nested models, and is constructed under the assumption that forecasts are
generated using a moving data window. In this case, the GW test evaluates whether the out-of-sample
forecast error from the random walk (RW) model for maturity τi (eRW
t+h|t(τi)) is statistically different from
the forecasts of the competing DNS model. The test is based on the loss differential function dm,t =
t+h|t(τi))2 − (eDN S
t+h|t(τi))2. Thus, we assume a quadratic loss function, where the null hypothesis of equal
(eRW
forecasting accuracy can be written as

(10)
Parameter δm,t is a p× 1 vector of test functions. The GW test statistic GWm,t can be computed as the Wald
statistic:

H0 : E[dm,t+h|δm,t] = 0.

GWm,t = S

S−1

δm,tdm,t+h

ˆΩ−1

S

S−1

δm,tdm,t+h

d→ χ2

dim(δ),

(11)

t=T +1

t=T +1

where ˆΩ−1
S is a consistent HAC estimator for the asymptotic variance of δm,tdm,t+h, and S the number of
out-of-sample observations. Under the null hypothesis given in 10, the test statistic GWi,t is asymptotically
distributed as χ2
p.

Table 3 reports the summary statistics of forecast performance for the general speciﬁcations: DNS-
VAR(3), DNS-VAR(4) and DNS-VAR(5). The following basic considerations can be made: (i) the DNS-

10

(cid:33)(cid:48)

(cid:32)

S−h(cid:88)

(cid:32)

S−h(cid:88)

(cid:33)

Table 3: (Trace)-Root Mean Squared Forecast Errors of DNS-VAR(3) and yields-macro models.

Panel A: DNS-VAR(3) model

Panel B: DNS-VAR(5) model

Forecast horizon

Forecast horizon

1-M
0.486∗
0.478∗
0.502∗
0.536
0.546∗
0.574∗
0.600∗
0.615∗
0.617∗
0.622∗
0.624∗
0.630∗
0.633∗
0.640∗
0.581

3-M
0.969∗
0.987
1.021
1.043
1.049
1.084∗
1.114
1.125
1.132
1.139
1.134
1.138
1.132
1.125
1.087

6-M
1.817
1.761
1.691
1.641
1.610
1.620
1.628
1.643
1.654
1.652
1.658
1.675
1.670
1.670
1.672

9-M 12-M 1-M
2.472
1.424
1.491
2.313
1.565
2.185
2.112
1.622
2.058∗
1.654
2.033∗
1.687
2.020∗
1.708
2.020∗
1.717
2.005∗
1.718
1.994∗
1.722
2.001∗
1.728
2.012∗
1.726
2.012∗
1.717
2.023∗
1.727
2.094
1.660

2.978
2.739
2.581∗
2.468∗
2.381∗
2.329∗
2.287∗
2.264∗
2.250∗
2.241∗
2.242∗
2.257∗
2.262∗
2.267∗
2.406

3-M
2.422
2.435
2.487
2.508
2.530
2.542
2.537
2.527
2.519
2.511
2.511
2.507
2.510
2.550
2.507

6-M
3.357
3.275
3.211
3.166
3.112
3.048
2.985
2.942
2.912
2.891
2.838
2.818
2.816
2.869
3.022

9-M
6.536
6.217
5.936
5.705
5.482
5.239
5.009
4.805
4.608
4.422
4.112
3.880
3.699
3.519
5.026

12-M
14.204
13.395∗
12.710∗
12.141∗
11.585∗
11.063∗
10.565∗
10.090∗
9.640∗
9.212∗
8.452∗
7.811∗
7.292∗
6.624∗
10.581

Panel C: DNS-VAR(4)1 model

Panel D: DNS-VAR(4)2 model

Forecast horizon

Forecast horizon

Maturities

3
6
9
12
15
18
21
24
27
30
36
42
48
60

TRMSFE

Maturities

3
6
9
12
15
18
21
24
27
30
36
42
48
60

8.216∗
7.924∗
7.688∗
7.430∗
7.215∗
7.001∗
6.793∗
6.614∗
6.459∗
6.322∗
6.077∗
5.889∗
5.724∗
5.468∗
6.822

1-M
1.864
1.834∗
1.793∗
1.773∗
1.738∗
1.714∗
1.687∗
1.661∗
1.638∗
1.612∗
1.594
1.571
1.548
1.518
1.685

6-M
4.304
4.251∗
4.185∗
4.103∗
4.020∗
3.929∗
3.853∗
3.784∗
3.697∗
3.607∗
3.511∗
3.429∗
3.347∗
3.228
3.818

3-M
2.925
2.936
2.920∗
2.908∗
2.873∗
2.848∗
2.803∗
2.763∗
2.725∗
2.694∗
2.617∗
2.564∗
2.510∗
2.431∗
2.756

3-M
1.069
1.044
1.043
1.051
1.049∗
1.067∗
1.090∗
1.095∗
1.102
1.106∗
1.121
1.125
1.122
1.121
1.086

6-M
1.724∗
1.638
1.560
1.520
1.484
1.484
1.489
1.495∗
1.497∗
1.502∗
1.510∗
1.520∗
1.515∗
1.516∗
1.534

9-M 12-M 1-M
0.523∗
5.949∗
0.520∗
5.823∗
5.706∗
0.556
5.595∗
0.592
0.616∗
5.454∗
0.645∗
5.323∗
0.665∗
5.206∗
5.087∗
0.677∗
4.979∗
0.680∗
4.884∗
0.687∗
0.703∗
4.712∗
0.709∗
4.572∗
4.455∗
0.711∗
0.715∗
4.275∗
5.169
0.646

12-M
2.483∗
2.285
2.121
2.010∗
1.912∗
1.841∗
1.787∗
1.760∗
1.757∗
1.756∗
1.765∗
1.786∗
1.797∗
1.813∗
1.932
Notes: The table presents the forecasting performances of DNS-VAR(3) model and yields-macro models.
In
particular, it reports the RMSFE and TRMSFE statistics obtained by using individual DNS-VAR(3), DNS-VAR(4)1,
DNS-VAR(4)2 and DNS-VAR(5) models. The values reported are divided by 1 × 10−2. The RMSFE is reported for
each model for the τ maturities and for 1-, 3-, 6-, 9- and 12-month-ahead forecast horizons. The latest line of each
panel reports the TRMSFE for the different forecast horizons. Numbers in bold indicate that the alternative yields-
macro models from panels B, C and D outperform the DNS-VAR(3) model, otherwise indicate underperformance.
Number in italic indicate that the DNS model outperform the random walk model. The star on the right of the cell
entries indicate where the GW test rejects the null of equal forecasting accuracy between the competitor yields-macro
models and random walk, with 10% probability of the null hypothesis.

9-M
2.202
2.015
1.894
1.798
1.731∗
1.695∗
1.669∗
1.647∗
1.641∗
1.636∗
1.639∗
1.657∗
1.661∗
1.677∗
1.762

TRMSFE

VAR(5) and DNS-VAR(4)1 clearly underperform the general DNS framework for the entire maturity and
forecast horizon spectrum; (ii) the DNS-VAR(4)2 consistently outperform the DNS-VAR(3) model for most
maturities and for forecast horizons longer than one month. The GW test rejects the null hypothesis at a 10%
level of the DNS-VAR(4)2 model for some particular cases: (i) 3-month-ahead predictions at medium-term
maturities; (ii) 6-month-ahead predictions for maturities above 24 months; and (ii) 9- and 12-month-ahead
predictions for the medium and long end of the yield curve. Therefore, the DNS-VAR(4)2 model generates
better forecasts for forecast horizons longer than one month at medium- and long-term maturities.

The GW test also rejects the null for most forecasted yields of DNS-VAR(4)1 model and few 12-month-
ahead forecasted yields of the DNS-VAR(5) model, conﬁrming their inferior performance in relation to the
RW and DNS-VAR(3) models. Both speciﬁcations which include the business cycle factor forecast poorly,
supporting the evidence of relatively small impact of X 1 on the Brazilian yield curve. In other words,

11

the incorporation of macro factors containing information strongly correlated with business cycle do not
contribute to predict the Brazilian yield curve.

The forecasts produced by the DNS-VAR(4)2 model provide the lowest RMSFEs and TRMSFEs for
most predictions above 1-month horizon, while DNS-VAR(3) and RW provide the lowest values for
1-month-ahead forecasts. Thus, the inclusion of the inﬂation factor into the general DNS framework
appears to lead to lower RMSFEs for most interest rates and most forecast horizons above 1 month, where
results for the GW tests indicate signiﬁcant improvements from forecasting with DNS-VAR(4)2 in relation
to RW. Overall, the results imply the support for the incorporation of a macro factor that summarizes broad
macroeconomic information regarding mainly inﬂation expectations. The forecast exercise conﬁrms the
estimates reported by Moench (2008), De Pooter et al. (2010), Koopman and Van der Wel (2013), Almeida
and Faria (2014), among other studies which report better out-of-sample yield forecasts for term structure
models with macroeconomic appeal.

4.3 Application to ﬁxed-income portfolio optimization
The mean-variance portfolio problem

The approach suggested by Markowitz (1952) is the most common formulation of portfolio choice
problems, which point out that investors allocate their wealth in risky assets based on the trade-off between
expected return and risk. At the moment of the portfolio choice, it is assumed that investors are only
concerned with the expected returns for the h-step-ahead forecast horizon and its covariance matrix,
deﬁned by µrt|t−h and Σrt|t−h, respectively. The mean-variance portfolio problem can then be formulated
by minimizing the portfolio variance for a particular h-step-ahead expected return, subject to additional
restrictions on the vector of optimal weights wt:

Min
wt

(cid:48)

t Σrt|t−h wt − 1
w
δ

w

(cid:48)
t µrt|t−h
tı = 1; wt ≥ 0.

(cid:48)

subject to : w

(12)
where ı is an appropriately sized vector of ones and δ is the investor’s risk aversion coefﬁcient. Vector
µrt|t−h collects the h-step-ahead expected returns for maturities τ1, ..., τN, so that its dimension is N × 1,
while the covariance matrix Σrt|t−h is N × N. The optimization problem is subject to both constraints,
the non-negative individual weights, which restricts short sales, and the budget constraint, which ensures
that all wealth is invested in risky assets. As the mean-variance problem solves a quadratic utility function,
the necessary and sufﬁcient condition for optimization is to solve the optimal weights wt for the ﬁrst order
condition.

The distribution of log-returns

Following the discussion in Caldeira et al. (2016), factor models for the term structure of interest rates are
designed only to model bond yields. Thus, the forecasting stage of yield curve models aim for modeling
merely moments of the expected yields. However, the ﬁxed-income portfolio problem requires estimates
of the expected return of each maturity, as well as estimates of their covariance matrix. The following
mathematical decompositions show that it is possible to obtain expressions for the expected return of ﬁxed-
income securities and their covariance matrix based on the distribution of the expected yields.

The mean-variance portfolio optimization is performed for two different forecast horizons: (i) ﬁrst, one-
step-ahead forecasts for log-returns of DI-futuro contracts are used to optimize ﬁxed-income portfolios with
monthly rebalancing; and subsequently (ii) six-step-ahead forecasts for log-returns are used to ﬁnd optimal
portfolios with biannual rebalancing. For this reason, the portfolio choice problem requires moments of the
expected yields for one- and six-months-ahead forecast horizons. The system of Eqs.
(2)-(4) implies
that the distribution of one-step-ahead forecasts for yt, of any maturity τi, is normally distributed, i.e.

12

and

and

is normally

(15)

(16)

yt|t−1 ∼ N (µyt|t−1, Σyt|t−1), with moments given by7:

µyt|t−1 = Et−1[yt] = Λft|t−1,

(13)

Σyt|t−1 = Λ(APt−1|t−1A(cid:48) + Q)Λ(cid:48) + H,

(14)
where Pt|t denotes the ﬁltered covariance matrix of ft|t at time t. Eq. (13) follows straightforward from Eq.
(7), which deﬁne the expectation of yields for the h-step-ahead forecast horizon. Note that the covariance
matrix of the true, but non-observable states (ft), would be given simply by Q. However, as stated in Eq.
(13), predicted states based on ﬁltered estimates of ft−1 are used when computing expected yields. Thus,
Eq. (14) takes into account the uncertainty in the Kalman ﬁlter estimates of the unobserved factors through
APt−1|t−1A(cid:48), containing the covariance matrix of the ﬁltered states (Pt−1|t−1) and not only the covariance
matrix of the unobserved factors, Q8. Therefore, the ﬁrst term in Eq. (14), APt−1|t−1A(cid:48) + Q, adjusts for the
fact that ﬁltered estimates are used in (13), and not the true value of states.

the distribution of six-step-ahead forecasts, yt|t−6 ∼ N (µyt|t−6, Σyt|t−6),

Similarly,

distributed with moments given by:

µyt|t−6 = Et−6[yt] = Λft|t−6,

6(cid:88)

i=1

Ai−1QA(cid:48) i−1)Λ(cid:48) + H.

Note that, in this case, the term (A6Pt−6|t−6A(cid:48) 6 +(cid:80)6

Σyt|t−6 = Λ(A6Pt−6|t−6A(cid:48) 6 +

i=1 Ai−1QA(cid:48) i−1) adjusts for the fact that the model uses
ﬁltered estimates for the six-step-ahead forecasts of yields and accumulates the uncertainty in the Kalman
ﬁlter estimates for each step forecast.
Using the mathematical expression for the discount curve Pt(τi) = exp(−τi · yt(τi)) and the log-return
expression, the realized return, rt(τi), of holding a security from t− h to t while its maturity decreases from
τi to τi−h, can be computed as follows,

rt(τi) = log

= log Pt(τi−h) − log Pt−h(τi) = −τi−h · yt(τi−h) + τi · yt−h(τi).

(17)

(cid:18) Pt(τi−h)

(cid:19)

Pt−h(τi)

It is clear to note from (13)-(17) that the vector of h-step-ahead forecasts of log-returns, rt|t−h, also follows
a Normal distribution N (µrt|t−h, Σrt|t−h) with mean given by:

µrt|t−h = −τi−h ⊗ µyt|t−h(τi−h) + τi ⊗ yt−h|t−h(τi),

(18)

where µyt|t−h(τi−h) is the mean vector of the expected yields with maturity τi−h at time t conditional on
period t − h information, yt−h|t−h(τi) is the vector of observed yields with maturity τi at time t − h, and ⊗
represents the Hadamard (elementwise) multiplication. The conditional covariance matrix of the expected
log-returns, which is positive-deﬁnite, is given by:
Σrt|t−h = τ(cid:48)

i−hτi−h ⊗ Σyt|t−h.

(19)

The discussion above solves the problem for obtaining estimates of the expected log-returns for
ﬁxed-income securities and their covariance matrix based on yield curve models such as the DNS model,
which are essential inputs to the portfolio choice problem based on the mean-variance approach suggested

7(Durbin and Koopman, 2012, p. 112) deﬁne the general formulations for the conditional mean square error matrix and

conditional mean of the covariance matrix of predicted states.

8For comparison, Caldeira et al. (2013) use the true value of the state vector and show that the second moment of yt|t−1 just

takes into account the covariance matrix of the unobserved factors, Q.

13

by Markowitz. All ingredients necessary to calculating the closed-form expressions (18)-(19) are easily
retrieved from the Kalman ﬁlter estimation discussed in Section 3.

Methodology for evaluating portfolio performance and implementation details

This section aims to assess the economic value of the forecasting ability of the major yield curve models
estimated previously. The empirical implementation of the mean-variance optimization problem deﬁned
by (12) is performed by using one- and six-step-ahead estimates of the vector of expected returns and
its covariance matrix considering ﬁve alternative values for the risk aversion coefﬁcient δ: 0.0001, 0.01,
0.1, 0.5 and 1. Following the recursive estimation strategy of the yield curve models, the optimal mean-
variance portfolios are also computed recursively as new h-step-ahead estimates for DI-futuro returns are
known. Moreover, optimal mean-variance portfolios using one-step-ahead forecasts for DI-futuro returns
are rebalanced on a monthly basis, while portfolios using six-step-ahead forecasts are rebalanced on a
biannual basis. Thus, the empirical analysis with monthly rebalancing computes the optimal portfolio for
each period over the S out-of-sample observations giving a sample of 40 optimal portfolio weights wt.

Otherwise,

the optimization with biannual rebalancing computes the optimal portfolio each six
consecutive months. Nevertheless, the portfolio performance statistics are computed for every month of
the out-of-sample period. The last rebalancing procedure is performed at May 2015, because as from
September 2015, there are no forecasts for 6-month-ahead yields being considered by the yield curve
models. Moreover, rebalancing frequency is important when dealing with ﬁxed-income assets, because the
securities in the portfolio can age and be closer to maturity. For this reason, the shortest maturity
considered here is τi = 9 months, because DI-futuro contracts with maturity lower or equal to 6 months
will already be matured before the subsequent rebalancing process. This only allows the computation of
performance statistics until January 2016, because at February 2016 the 9-month security will already be
matured, so that the number of out-of-sample observations is equal to 38.

It is clear that the scenario with biannual rebalancing requires more diligence regarding implementation
procedure and computation of performance statistics. Note that, after one period, an optimal portfolio
containing securities that yield an average duration of τi at the time of the mean-variance optimization,
becomes a portfolio with average duration τi−1 and so on until the next rebalancing process, changing the
characteristics of the original portfolio over time. Thus, the computation of the time series of portfolio
returns need to take care about the constant decrease of the time-to-maturity of its securities.

The performance analysis use some alternative criteria to evaluate the performance of the optimal mean-
variance ﬁxed-income portfolios. First of all, we describe the evaluation criteria related to portfolio excess
return relative to the risk-free rate (Rft), which is consider to be the short Brazilian Interbank Deposit
(CDI) rate. The average gross (i.e., before transaction costs) excess return relative to the risk-free rate ( ¯rx)
is calculated as follows:

S(cid:88)

t=1

¯rx =

1
S

rxt,

where rxt = w
is a vector collecting DI-futuro returns of all maturities considered.

t−1Rt − Rft denotes the gross excess portfolio return at time t and Rt = [rt(τi), ..., rt(τN )](cid:48)

(cid:48)

According to Han (2006), it would be appropriate to consider transaction costs when rebalancing the
portfolio weights frequently. The empirical scenario with biannual rebalancing can alleviate the impact of
transaction costs on portfolio performance. However, the less frequent rebalancing means that the portfolio
weights will be outdated, which could negatively affect the portfolio performance because investors would
be investing away from the optimal one (Caldeira et al., 2016). The performance analysis also considers the
excess return net of transaction costs (rxnet
), which takes into account the negative impact of transaction
costs on portfolio average performance, and is calculated as:

t

t = (1 − c · turnovert)(1 + rxt) − 1,

rxnet

(20)

14

where c is the fee that must be paid for each transaction and turnovert is the portfolio turnover at time t,
deﬁned as the fraction of wealth traded between periods t − 1 and t, i.e,

turnovert =

(|wi,t − wi,t−1|).

N(cid:88)

i=1

The parameter wi,t is the optimal weight of maturity τi at time t. The level of transaction costs being
considered is 5 bps, reﬂecting a ﬁxed percentage for each rebalance trade. Similarly to ¯rx, the average
. Moreover, statistics
excess portfolio return net of transaction costs is deﬁned as ¯rxnet = 1
S
regarding the volatility (standard deviation) of the net excess return (ˆσ) and the risk-adjusted net excess
return (SR) measured by the Sharpe ratio are calculated as follows,

t=1 rxnet

t

(cid:80)S

(cid:118)(cid:117)(cid:117)(cid:116) 1

S

S(cid:88)

t=1

ˆσ =

t − ˆµp)2,

(rxnet

SR =

¯rxnet

ˆσ

,

(cid:80)S

where ˆµp denotes the sample mean of the portfolio net excess return. Ultimately, the performance analysis
takes into account the average duration in years of the portfolios, which allows one to better understand
the composition of the optimal portfolios. The average duration of a ﬁxed-income portfolio is calculated as
(cid:48)
tτ, where here τ regards to the vector of individual security durations. A higher (lower) average
1
S
portfolio duration suggests that the optimal portfolio is invested in long (short) maturities.

t=1 w

Results for mean-variance portfolios

Table 4 reports the out-of-sample performance of mean-variance portfolios of DI-futuro contracts that use
estimates of yields from the random walk (RW)9, DNS-VAR(3) and DNS-VAR(4)2 model speciﬁcations. For
the scenario which considers one-step-ahead estimates and more frequent portfolio rebalancing (Panel A
in Table 4), the overview indicates that positive excess return statistics are essentially obtained when the
risk aversion coefﬁcient is higher than 0.01, where the annualized net excess returns range from 0.40% to
1.57%. The best overall performance in terms of Sharpe ratio is achieved by the mean-variance portfolio
obtained with the RW model with δ = 0.5 (SR = 0.472). When lower risk aversion is considered, most of
the results indicate negative Sharpe ratios and higher volatility levels. As expected, an increase in the risk
aversion coefﬁcient leads to decreases in portfolio volatility as well as decreases in the average duration,
that is, optimal portfolios are invested in short-term maturities. This result is intuitive since lower maturity
securities are less risky, allowing investors with higher risk aversion to lower portfolio risk by investing
in shorter maturities. This evidence is even more pronounced for the RW model, which quickly decreases
volatility and duration with the increase of δ, investing basically in 3- and 6-month maturities for δ’s higher
than 0.1. For instance, the average portfolio duration across speciﬁcations for an investor with risk aversion
coefﬁcient δ = 1 is 0.89 year, whereas the same indicator for an investor with δ = 1 × 10−4 is 2.37 years.
On the other hand, the scenario which considers six-step-ahead estimates for DI-futuro returns and a
biannual portfolio rebalancing (Panel B in Table 4) reports negative net excess returns across all model
speciﬁcations and across all levels of the risk tolerance considered, except for the DNS-VAR(4)2 model with
δ < 1. The best overall performance are achieved by the DNS-VAR(4)2 model for the smallest δ: ¯rx equal to
1.075%, ¯rxnet =1.065%, volatility (measured by the standard deviation) equal to 10.75%, SR = 0.099 and
average duration equal to 1.55 years. The DNS-VAR(4)2 model also minimizes losses for the higher level
of δ. The general results show that annualized net excess returns range from -3.153% to 1.065%, and the

9It is noteworthy that the covariance matrix of the expected log-returns obtained from forecasted yields of the RW model is

simply the sample covariance from the in-sample observations.

15

Table 4: Performance of optimal DI-futuro contracts mean-variance portfolios.

Yield Curve Model Mean gross exc. R (%) Mean net exc. R (%) Std. Dev. (%) Sharpe Ratio Duration (years)

Panel A: one-step-ahead estimates with monthly rebalancing

δ=0.0001

Random Walk
DNS-VAR(3)
DNS-VAR(4)2

δ=0.01

Random Walk
DNS-VAR(3)
DNS-VAR(4)2

δ=0.1

Random Walk
DNS-VAR(3)
DNS-VAR(4)2

δ=0.5

Random Walk
DNS-VAR(3)
DNS-VAR(4)2

δ=1

Random Walk
DNS-VAR(3)
DNS-VAR(4)2

-1.143
0.880
-0.905

1.081
0.108
-0.897

1.135
-0.527
-0.126

0.521
0.574
0.531

-1.218
0.820
-0.983

1.008
0.042
-0.975

1.092
-0.584
-0.195

0.511
0.524
0.459

21.981
23.134
24.664

13.040
22.330
24.642

4.463
21.167
21.282

1.083
16.069
18.076

0.405
1.622
1.052
Six-step-ahead estimates with semi-annual rebalancing

0.889
13.544
15.382

0.401
1.572
0.987

-0.055
0.035
-0.040

0.077
0.002
-0.040

0.245
-0.028
-0.009

0.472
0.033
0.025

0.451
0.116
0.064

2.600
2.356
2.163

1.615
2.261
2.162

0.626
1.978
1.919

0.287
1.416
1.434

0.261
1.187
1.227

Yield Curve Model Mean gross exc. R (%) Mean net exc. R (%) Std. Dev. (%) Sharpe Ratio Duration (years)

δ=0.0001

Random Walk
DNS-VAR(3)
DNS-VAR(4)2

δ=0.1

Random Walk
DNS-VAR(3)
DNS-VAR(4)2

δ=0.5

Random Walk
DNS-VAR(3)
DNS-VAR(4)2

δ=1

Random Walk
DNS-VAR(3)
DNS-VAR(4)2

-3.145
-0.093
1.075

-1.379
-0.093
0.499

-0.127
-0.443
0.159

-0.141
-0.506
-0.106

-3.153
-0.106
1.065

-1.388
-0.106
0.489

-0.134
-0.457
0.150

-0.143
-0.518
-0.111

23.729
15.551
10.752

8.921
15.551
7.546

4.432
6.647
5.544

2.984
5.065
3.616

-0.133
-0.007
0.099

-0.156
-0.007
0.065

-0.030
-0.069
0.027

-0.048
-0.102
-0.031

3.237
2.263
1.553

1.551
2.263
1.277

1.008
1.359
1.026

0.806
1.194
0.896

Notes: Performance statistics for mean-variance portfolios using the random walk, DNS-AR(3), DNS-VAR(3) and DNS-VAR(4)2
model speciﬁcations to compute the forecasted yields for the out-of-sample period. Panel A reports the statistics for the portfolio
optimization using one-month-ahead estimates for DI-futuro returns, while Panel B reports the statistics using six-months-ahead
estimates. The statistics of gross and net excess returns, standard deviation, and Sharpe ratio are annualized and the average portfolio
duration is measured in years. Parameter δ denotes the value of the risk aversion coefﬁcient.

annualized standard deviation ranges from 2.98% to 23.72%, whereas the Sharpe ratio ranges from -0.156
to 0.099. As before, an increase in the risk aversion coefﬁcient leads to decreases in the average duration,
indicating optimal portfolios invested mostly in long-term maturities for lower levels of δ. Moreover, the
impact of transaction costs is relatively small for estimates with biannual portfolio rebalancing, whereas net
excess returns are very close to gross excess returns.

The key difference compared to Panel A concerns the average portfolio duration: it is higher across all
model speciﬁcations and δ’s for the estimates with annual rebalancing; e.g., the average portfolio duration
across speciﬁcations for δ = 1 is now 0.96 years and for δ = 1 × 10−4 is 2.35. The comparison also
suggests that in general portfolio strategies, optimal mean-variance portfolios with monthly rebalancing
deliver higher net excess returns than those with annual rebalancing, pointing out a gain in rebalancing the
portfolio weights frequently to keep optimal allocation updated.

Table 4 shows that negative net excess returns prevail in most optimal mean-variance portfolios. In

16

rising interest rate environments, as the out-of-sample period, ﬁxed-income prices suffer from the increase
in interest rates in the short term, i.e, rising rate environments can result in negative ﬁxed-income returns.
A bond’s total return comprises not just price changes, but also income, so that the income on a bond
can help offset falling prices, cushioning the overall total return. It turns out that optimal mean-variance
portfolios can not beneﬁt from increased yields over the long term because of rebalancing: investors do not
hold ﬁxed-income securities until their maturity, which turns portfolio’s total returns highly dependent on
price changes. For this reason, the income returns are not enough to offset the price decline in DI-futuro
contracts.

At least, Fig. 2 illustrates the performance of the optimal DI-futuro mean-variance portfolios by plotting
the cumulative net returns over the out-of-sample period obtained with the alternative speciﬁcations when
δ is equal to 1 × 10−4 and 1. The ﬁgure suggests that DNS-VAR(3) delivers better performance for mean-
variance portfolios using one-step-ahead estimates for returns and for δ = 1 × 10−4 during most part of
the out-of-sample period. For δ = 1, the RW model reports more stable and higher cumulative returns.
However, DNS-VAR(4)2 displays better portfolio performance using six-step-ahead estimates. The best
overall performance in terms of cumulative net returns are achieved by mean-variance portfolios obtained
with the RW model for δ = 1 and for one-step-ahead estimates (33.17%) and with the DNS-VAR(4)2
for δ = 1 × 10−4 and six-step-ahead estimates (33.85%). Hence, the incorporation of macroeconomic
information has positive effects to achieve better portfolio performance at the biannual rebalancing scenario.

(a)

(c)

(b)

(d)

Figure 2: Cumulative net returns (in %): mean-variance portfolios with δ = 1 × 10−4 and δ = 1 for 1- and 6-step-
ahead forecasts over the out-of-sample period.

It is also noteworthy the big drop in cumulative net returns for the one-step-ahead estimates in
September 2015. At the end of August 2015, there is a deterioration of the Brazilian macroeconomic
fundamentals due to the perception of a downturn in medium- and long-term ﬁscal scenario. Financial
markets reacted with capital ﬂight to safer investments and investors required higher premiums for holding
Brazilian securities. Fig. 3 helps to visualize the scenario where short DI-futuro yields slightly rise while
long-term yields suffer a large increase from July 2015, to September 2015, reﬂecting a large deterioration
in long-term expectations about Brazilian macroeconomic foundations. Once investors with more

17

risk-averse preferences tend to hold short-term maturities, they are not affected so much as the less
risk-averse investors with δ = 1 × 10−4 evidenced by panel (a) of Fig. 2.

Figure 3: Observed yield curves from July 2015, to September 2015.

The link between Tables 3 and 4 is clear in the sense that better accuracy in yield curve forecasting
leads to an improvement in terms of portfolio performance based on the mean-variance approach. In the
general context, preferred one-month-ahead forecasted yields, which are generated by RW and
DNS-VAR(3), deliver better portfolio performance for optimizations with one-step-ahead estimates for
DI-futuro returns. On the other hand, the DNS-VAR(4)2 speciﬁcation, which consistently outperforms its
competitors for forecast horizons longer than one month, reports better portfolio performance using
six-step-ahead estimates. It is noteworthy that these ﬁndings highlight the relevance of good yield curve
predictions to achieve better results in terms of portfolio performance. From this perspective,
the
incorporation of macroeconomic information into term structure models can play an important role to
improve performance of ﬁxed-income portfolios with biannual rebalancing.

5 Concluding remarks

The recent literature on yield curve forecasting suggests that the incorporation of a large macroeconomic
dataset into term structure models improve forecast accuracy (De Pooter et al., 2010). Most of current
studies test for statistical beneﬁts from incorporating macroeconomic information, but little is known about
the economic value of those forecasted yields. Besides testing for statistical improvement, this study uses
a ﬁxed-income portfolio analysis in order to assess the economic value of forecasted yields generated by
yield curve models with macro factors extracted from a large macroeconomic dataset.

The out-of-sample forecast exercise support the evidence that a DNS yield curve model incorporating
one macro factor, which summarizes broad information regarding primarily inﬂation expectations,
outperforms the general DNS and RW models for forecast horizons longer than one month, specially at
medium- and long-term maturities. This evidence indicates that an inﬂation factor is particularly useful to
predict the Brazilian nominal yield curve dynamics.

The results for mean-variance portfolios show that better accuracy in yield curve forecasting leads to
an improvement in terms of portfolio performance. Portfolio optimizations with six-step-ahead estimates
for DI-futuro returns and biannual rebalancing report positive excess returns only for the DNS model
which incorporates the inﬂation factor. Moreover, optimal portfolios with monthly rebalancing deliver
higher return statistics for the general DNS model and RW, which forecasted yields outperform for the
short forecast horizon scenario.

The overview indicates that good yield curve predictions are important to achieve economic gains from
forecasted yields in terms of portfolio performance. It is clear that yield curve models with better forecast
accuracy for short forecast horizons perform quite well for optimal mean-variance portfolios with one-step-
ahead estimates for DI-futuro returns. In parallel, the DNS speciﬁcation which incorporates an inﬂation
factor outperforms in terms of portfolio performance with six-step-ahead estimates. Therefore, there is
an economic and statistical gain from considering a large macroeconomic dataset to forecast the Brazilian
yield curve dynamics, specially for longer forecast horizons.

18

References

Almeida, C. and A. Faria (2014). Forecasting the Brazilian term structure using macroeconomic factors.

Brazilian Review of Econometrics 34(1), 45–77.

Ang, A. and M. Piazzesi (2003). A no-arbitrage vector autoregression of term structure dynamics with

macroeconomic and latent variables. Journal of Monetary economics 50(4), 745–787.

Bernanke, B. S. and J. Boivin (2003). Monetary policy in a data-rich environment. Journal of Monetary

Economics 50(3), 525–546.

Bernanke, B. S., J. Boivin, and P. Eliasz (2005). Measuring the effects of monetary policy: A factor-
augmented vector autoregressive (FAVAR) approach. The Quarterly Journal of Economics 120(1), 387–
422.

Bolder, D. J. (2015). Fixed-Income Portfolio Analytics: A Practical Guide to Implementing, Monitoring

and Understanding Fixed-Income Portfolios. Springer.

Caldeira, J. F., G. V. Moura, and A. A. P. Santos (2013). Measuring risk in ﬁxed income portfolios using

yield curve models. Computational Economics 46(1), 65–82.

Caldeira, J. F., G. V. Moura, and A. A. P. Santos (2016). Bond portfolio optimization using dynamic factor

models. Journal of Empirical Finance 37, 128–158.

Caldeira, J. F., G. V. Moura, and M. Savino Portugal (2010). Efﬁcient yield curve estimation and forecasting

in brazil. Revista Economia, January/April.

Dai, Q. and K. J. Singleton (2000). Speciﬁcation analysis of afﬁne term structure models. The Journal of

Finance 55(5), 1943–1978.

De Pooter, M., F. Ravazzolo, and D. J. Van Dijk (2010). Term structure forecasting using macro factors and

forecast combination. FRB International Finance Discussion Paper (993).

Diebold, F. X. and C. Li (2006). Forecasting the term structure of government bond yields. Journal of

Econometrics 130(2), 337–364.

Diebold, F. X. and G. D. Rudebusch (2013). Yield Curve Modeling and Forecasting: The Dynamic Nelson-

Siegel Approach. Princeton University Press.

Diebold, F. X., G. D. Rudebusch, and S. B. Aruoba (2006). The macroeconomy and the yield curve: a

dynamic latent factor approach. Journal of Econometrics 131(1), 309–338.

Duffee, G. R. (2002). Term premia and interest rate forecasts in afﬁne models. The Journal of Finance 57(1),

405–443.

Durbin, J. and S. J. Koopman (2012). Time series analysis by state space methods. Number 38. Oxford

University Press.

Favero, C. A., L. Niu, and L. Sala (2012). Term structure forecasting: No-arbitrage restrictions versus large

information set. Journal of Forecasting 31(2), 124–156.

Giacomini, R. and H. White (2006). Tests of conditional predictive ability. Econometrica 74(6), 1545–1578.

Gürkaynak, R. S. and J. H. Wright (2012). Macroeconomics and the term structure. Journal of Economic

Literature 50(2), 331–367.

19

Han, Y. (2006). Asset allocation with a high dimensional latent factor stochastic volatility model. Review

of Financial Studies 19(1), 237–271.

Hördahl, P., O. Tristani, and D. Vestin (2006). A joint econometric model of macroeconomic and term-

structure dynamics. Journal of Econometrics 131(1), 405–444.

Koopman, S. J. and M. Van der Wel (2013). Forecasting the US term structure of interest rates using a

macroeconomic smooth dynamic factor model. International Journal of Forecasting 29(4), 676–694.

Korn, O. and C. Koziol (2006). Bond portfolio optimization: A risk-return approach. Journal of ﬁxed

income 15(4), 48–60.

Litterman, R. B. and J. Scheinkman (1991). Common factors affecting bond returns. The Journal of Fixed

Income 1(1), 54–61.

Markowitz, H. (1952). Portfolio selection. The Journal of Finance 7(1), 77–91.

McCulloch, J. H. (1971). Measuring the term structure of interest rates. The Journal of Business 44(1),

19–31.

Moench, E. (2008). Forecasting the yield curve in a data-rich environment: A no-arbitrage factor-

augmented var approach. Journal of Econometrics 146(1), 26–43.

Nelson, C. R. and A. F. Siegel (1987). Parsimonious mosdeling of yield curves. Journal of Business,

473–489.

Rossi, J. L. and M. D. Carvalho (2009). Identiﬁcation of monetary policy shocks and its effects: Favar

methodology for the Brazilian economy. Brazilian Review of Econometrics 29(2), 285–313.

Vieira, F., M. Fernandes, and F. Chague (2017). Forecasting the Brazilian yield curve using forward-looking

variables. International Journal of Forecasting 33(1), 121–131.

20

