The dynamics of leverage in a demand-driven model with

heterogeneous ﬁrms∗
Laura Carvalho, Corrado Di Guilmi(cid:5)

Department of Economics - University of Sao Paulo, Brazil.
Business School - University of Technology, Sydney. Australia.

Abstract

This paper introduces heterogeneous microeconomic behavior into a demand-driven macroeconomic
model, in order to study the joint dynamics of leverage, income distribution and economic growth. The
distinctive feature is in that the aggregation of heterogeneous agents is not only performed numerically, as
in traditional agent-based models, but also by means of an innovative analytical methodology, originally
developed in statistical mechanics and recently imported into macroeconomics. By analytically identifying
the links between ﬁrms-level variables and aggregate quantities, the paper contributes toward a reformula-
tion of the Minskyan formal analysis that explicitly considers the microeconomic factors. The steady-state
and stability properties of the system also provide additional insights on the role of behavioral and size
heterogeneity of ﬁrms for the stocks of aggregate leverage and capital.

Resumo

Este artigo introduz comportamento microeconômico heterogêneo num modelo macroeconômico lid-
erado pela demanda, com o intuito de estudar a dinâmica conjunta de alavancagem, distribuição de renda
e crescimento econômico. A característica que distingue o modelo é o fato da agregação de agentes het-
erogêneos não ser feita somente de forma numérica, como tradicionalmente em modelos "agent-based",
mas também por meio de uma metodologia analítica inovadora, originalmente desenvolvida em mecânica
estatística e recentemente importada para a macroeconomia. Através da identiﬁcação analítica das conexões
entre variáveis ao nível da ﬁrma e quantidades agregadas, o artigo contribui no sentido de uma reformulação
da análise formal Minskyana que considera explicitamente fatores microeconômicos. O estado estacionário
e as propriedades de estabilidade do sistema proveem novas perspectivas sobre o papel da heterogeneidade
comportamental e de tamanho das ﬁrmas para os estoques de capital e alavancagem agregados.

Keywords: Financial Instability Hypothesis, aggregate demand, leverage, heterogeneous agents
Palavras-chave: Hipótese da Instabilidade Financeira, demanda agregada, alavancagem, agentes heterogê-
neos.

JEL classiﬁcation: E16, E32, G01
Área 8 ANPEC: Microeconomia, Métodos Quantitativos e Finanças.

∗We thank André Diniz for the superb research assistance. Financial support by the Institute for New Economic Thinking is
(cid:5)Corresponding author: Corrado Di Guilmi. University of Technology, Sydney - PO Box 123, Broadway, NSW 2007, Australia.

gratefully acknowledged. The usual disclaimers apply.

Ph.: +61295147743, Fax: +61295147711. E-mail: corrado.diguilmi@uts.edu.au.

1 Introduction

The 2008 ﬁnancial turmoil itself, and the process of de-leveraging by the private sector observed in the follow-
ing years, have drawn the attention to the crucial role of credit as a factor leading both to the instability of the
system and to a strengthening of real-ﬁnancial linkages in the economy. This view, which was central to the
work of Hyman Minsky, is also supported by the vast historical evidence presented in Schularick and Taylor
(2012), which highlights that credit booms tend to be followed by deeper recessions when compared to other
ﬁnancial crises episodes.

A formal investigation of these phenomena from a Minskyan standpoint requires the integration of the
ﬁnancial and economic systems in a demand-driven macroeconomic model. A seminal formalization of a
Minsky crisis generated by self-fulﬁlling expectations was made by Taylor and O’Connell (1985) using a
Kaleckian model, but without dealing explicitly with the role of debt. An alternative, which has received
renewed attention after the crisis Khalil and Kinsella (2011); Bezemer (2010), builds on the traditions of Tobin
(1969) and Godley and Lavoie (2007) to take into account all ﬂows of income between sectors in the economy,
as well as their accumulation into ﬁnancial and tangible assets in a Keynesian setup. Besides allowing for
formal Minskyan analyses of corporate debt and ﬁnancial fragility (Dos Santos, 2005), the so-called Stock-
Flow Consistent (SFC) models have recently been used to study the macroeconomic effects of shareholder
value orientation and ﬁnancialization (Van Treeck, 2009), household debt accumulation (Kim and Isaac, 2010),
and other related issues.

The traditional limitation of this type of models, however, is that of dealing with economic behavior only in
aggregative terms, thus excluding the heterogeneity of agents as a source of ﬁnancial instability. The relevance
of a microeconomic analysis in modeling ﬁnancial fragility was stressed by Minsky himself1. It is thus for un-
derstanding the economy as an “out-of-equilibrium” system while allowing for heterogeneous microeconomic
behavior (Delli Gatti et al., 2005, 2010), that the literature based on the so-called agent-based models (ABMs)
has proven to be so useful for the analysis of ﬁnancial instability. Nevertheless, for using a fully bottom-up
approach, this type of models often lack a clear macroeconomic closure and are hard to connect to other macro
analyses.

The starting point of this paper is to see agent-based, SFC and, more generally, Keynesian-Kaleckian
macroeconomic approaches as complementary in their understanding of the crucial role of real-ﬁnancial link-
ages for the instability of the economic system, as well as its macroeconomic dynamics2. Moreover, we aim
to contribute in ﬁlling what we consider to be a weakness in both the SFC and ABM approaches, namely its
full reliance on numerical and computational solutions.3 In order to provide a few analytical insights that will
add to the numerical simulations of the model, we perform an aggregation of heterogeneous agents by means
of an innovative analytical methodology originally developed in statistical mechanics and recently imported
into macroeconomics (see Aoki and Yoshikawa, 2006; Di Guilmi, 2008; Foley, 1994; Weidlich, 2000, among
others). This modeling approach builds from the idea that, as the economy is populated by a very large number
of dissimilar agents, an analytical model cannot keep track of the conditions of every single agent at each point
in time. As Aoki and Yoshikawa (2006) remark: “the point is that precise behavior of each agent is irrele-
vant. Rather we need to recognize that microeconomic behavior is fundamentally stochastic.” Therefore, a

1“An ultimate reality in a capitalist economy is the set of interrelated balance sheets among the various units” (Minsky, 2008,
116). Taylor and O’Connell (1985) remark that “shifts of ﬁrms among classes as the economy evolves in historical time underlie
much of its cyclical behavior. This detail is rich and illuminating but beyond the reach of mere algebra”.

2Such complementarities are clear in Godin and Kinsella (2012), which combines the two approaches in a study of the interaction
of banks and ﬁrms in the leverage cycle. A dynamic micro-macro analysis is also developed in the work by Dosi et al. (2013), which
builds an agent-based Keynesian model for the study of interactions between income distribution and monetary and ﬁscal policies.

3The main problem with solving these models only numerically is that model results are usually very sensitive to parameter
conﬁgurations, making it very difﬁcult to establish general relationships between macro and micro-variables, as well as causality
links within the system.

2

microfounded analytical model should look at how many agents are in a certain condition, rather than at which
agents, and represent their evolution in probabilistic terms. This approach is particularly suitable to microfound
macroeconomic models, since it is able to endogenously derive the macro-equations and the dynamics of ﬂows
from the microeconomic behavioral rules, without imposing ad-hoc constraints.

Hence, the contributions of this paper are basically three. The ﬁrst is mainly methodological, and consists
in the integration of the numerical and analytical solutions of an agent-based model, as done, for instance, in
Chiarella and Di Guilmi (2011). Besides helping us open the “black box” of the simulations, the analytical
approach allows for a few generalizations and a better assessment of the role of heterogeneity in levels and
dimensions in relation to a more homogeneous microeconomic setup.

The second contribution, also methodological, concerns the innovative approach to the microfoundation of
stock-ﬂow consistent modeling. The macro-equations of the aggregate model are here generated endogenously
in a bottom-up approach, starting from the behavioral equation for agents. Consequently, the steady-state
analysis is able to assess the impact of the balance sheet structures of ﬁrms on the macroeconomy.

The third contribution is to explore micro and macroeconomic aspects leading to the emergence of short-
run ﬂuctuations and long-run instability of the economic system. In particular, the paper shows how the diverse
ﬁnancial structures of ﬁrms can determine the evolution of the economy, as stressed in Minsky’s narrative. As
the objective is not to fully represent the behavior of any particular economy over time, but rather to provide a
few methodological and theoretical insights for the analysis of leverage and ﬁnancial instability, the model we
present is particularly simple and stylized, but it is still able to point toward the usefulness of the method for
more realistic settings.

The paper will be structured as follows. Section 2 presents the structure of the agent-based model. Results
of the numerical simulations are then illustrated in section 3. Section 4 speciﬁes the dynamics of ﬁrms’ transi-
tion between states, as well as the mean-ﬁeld approximation procedure we use for the analytical solution of the
model. In Section 5, we perform steady-state and stability analyses of the system of differential equations for
the joint evolution of ﬁrms’ aggregate leverage and the proportion of ﬁrms in different ﬁnancial states. Section
6 concludes the paper and points toward future developments.

2 The model

The economy described in this paper is composed by ﬁrms, households and a ﬁnancial sector. Following
Kalecki (1971), ﬁrms are assumed to set the price as a mark-up on the unit cost of labor, while holding excess
capacity4. The mark-up, and hence the functional distribution of income between wages and proﬁts, will be
assumed to (exogenously) depend on the degree of industrial concentration and the relative bargaining power
of workers and capitalists in the labor market. The model is demand-driven in nature: output is always below
potential, which allows for investment behavior to be determined independently from savings. The degree of
capacity utilization of ﬁrms, which depends on the quantity they sell in each period, will take the adjusting role
for the macroeconomic equilibrium in the goods market.

Firms are divided into two classes and may switch between them. While hedge ﬁrms pay all their interest
out of gross proﬁts, speculative ﬁrms’ proﬁts are lower than their ﬁnancial commitments in the current period
5. The method proposed in Section 5 will allow the share of ﬁrms in each class to affect aggregate leverage
dynamics. There is no microfoundation for the household sector, which is treated as an aggregate for simplicity.
Their income is composed of wages and a component of proﬁts distributed by ﬁrms. Households accumulate
their entire stock of wealth in the form of money deposits.

4See Rowthorn (1982), Dutt (1984) and Taylor (1985) for early neo–Kaleckian models in this tradition.
5In the Mynskian terminology, Ponzi agents are distinguished from speculative agents for their income is never sufﬁcient to make

interest payments, requiring new borrowing at every period. This distinction will not be made here for simpliﬁcation purposes.

3

Finally, the ﬁnancial sector is also considered as an aggregate: its basic role is to provide loans, hence
holding debt (or ﬁrm bonds) as an asset and to create money deposits endogenously as liabilities, while setting
an exogenous interest rate.

2.1 Firms
A single ﬁrm is identiﬁed by the superscript j, while its state (speculative or hedge) by the subscript z = 1,2.
Firm level variables are indicated by small letters while aggregate while variables are represented by capital
letters. Thus when a variable is written as x j
1, it refers to the ﬁrm j belonging to state 1. A lower case variable
with only the subscript, x1, indicates the mean-ﬁeld value, which, as detailed in section 4 below, is a single
value that replaces the vector of observations in each group. Symbols without superscript or subscript refer to
aggregate variables. The numbers of ﬁrms in each group are indicated by N1 and N2. In a simpliﬁcation of the
Minskyan terminology, we deﬁne two classes of ﬁrms, depending on the sign of their retained proﬁts a j, here
deﬁned as the difference between gross proﬁts and interest payments:

• z = 1: speculative ﬁrms, whose gross proﬁts in the current period are less than sufﬁcient to pay interest

on accumulated debt, requiring a new increase in debt.

(1)
• z = 2: hedge ﬁrms, whose proﬁts in the current period are more than sufﬁcient to pay interest on accu-

a j
t < 0.

mulated debt.

t ≥ 0
a j

The investment function for the ﬁrm j is given by6

z,t = i0K j
i j

z,t−1 + (αz π + β )pq j

t−1 − λ b j
t−1

(2)

(3)

where q j is the quantity sold by the ﬁrm, π is the share of proﬁts in output, p is the ﬁnal good’s price, b is
the ﬁrm’s outstanding debt and i0,αz,β ,λ ≥ 0. This speciﬁcation is the equivalent in levels to the standard
neo-Kaleckian speciﬁcation in which the gross percentage change in capital before depreciation is a positive
function of the gross proﬁt rate and the degree of capacity utilization.7.

The positive effect of the proﬁt rate on investment decisions can be justiﬁed based on two different channels:
(i) it determines the level of internal ﬁnance available for investment, and (ii) it gives the return on productive
capital, thus providing an incentive for ﬁrms to invest. When it comes to the magnitude of the parameter α,
the formulation recalls the one in Delli Gatti et al. (1993), where the sensitivity to internal ﬁnance analytically
devices the Minskyan borrower’s and lender’s risk. Following Fazzari et al. (1988) and Delli Gatti et al. (1993),
we assume that α1 > α2, that is speculative ﬁrms are more sensitive to internal ﬁnance as they face the risk of
bankruptcy and change their behavior in order to minimize it.

6For computational needs, in the multi-agent simulations we consider a sequential economy that evolves in discrete time, and the

model will be presented accordingly.

7When technology exhibits ﬁxed coefﬁcients, it is possible to deﬁne the potential output only as a function of capital so that

where the inverse of capital productivity γ is a constant parameter, which can be normalized to one for simplicity. The degree
of capacity utilization u j of each ﬁrm, deﬁned as the ratio of actual output q j sold by the ﬁrm to potential output ¯q j can thus be
approximated to the actual output-to-capital ratio u = q
k .

¯q j
t = 1/γ k j
t

(4)

4

s j
t = ˜s j
t

(cid:34)
1− k j
t
Kt
(cid:104)

(cid:35)
(cid:105)

t = E[q j
q j
t ]

1 + s j
t

Investment decisions to expand the available capital stock also respond positively to ﬁrms’ sales, as higher
demand and a higher use of the existing capacity cause ﬁrms to expand their desired productive capacity and
potential output. Finally, the third term in 3 allows the level of outstanding debt to inhibit investment decisions,
as ﬁrms face higher balance sheet constraints. Equation (3) thus involves three factors: a micro-effect (b j), a
meso-effect (αz) and a variable combining micro and macro effects (q j).

The quantity actually sold by a ﬁrm is subject to a preferential attachment shock. Total demand pQ(t) is
determined as the macroeconomic level from aggregate investment and consumption, but its distribution among
ﬁrms needs to be identiﬁed. We assume that this distribution is partially stochastic. In particular, demand
is allocated based on the relative of size of ﬁrms (proxied by their stock of capital), to which a stochastic
idiosyncratic shock s is added. The expected market share of ﬁrm j is hence:

E[q j

t ] = Qt

k j
t
Kt

,

(5)

where Qt is the total demand, given by the consumption of managers and wage earners, and K represents
the aggregate capital for the whole economy. Deﬁning ˜s as a uniformly distributed stochastic variable with
E[ ˜s] = 0, we set

(6)

(7)

(8)

(9)

(10)

in order for ∑N q j = Q. Accordingly the quantity actually sold by the single ﬁrm is

Firms will set prices in oligopolistic markets by applying a mark-up over unit labor costs:

p = (1 + µ)

w
ξ .

where µ is the mark-up rate, w is the nominal wage and ξ = Q/L is labor productivity.
With µ taken as a parameter, the mark-up rate is constant and the labor share of output Ψ is also given

exogenously from:

Ψ =

w
p

1
η =

1

1 + µ

The gross proﬁt share of aggregate output Π will then be given by

Π = 1− Ψ =

µ

1 + µ

As previously described, each ﬁrms’ retained proﬁts are computed as the difference between its gross proﬁts
and the net interest it pays on debt, at an exogenous interest rate ¯i. Since the ﬂow of gross proﬁts is given by a
constant share Π of each ﬁrms’ output from the mark-up rule, retained proﬁts can be expressed as:

t = Πpq j
a j

t − ¯i b j
t−1

(11)
A ﬁrm will be assumed to fail if b j/k j ≥ c, where c is set as a positive constant. The probability for a
bankrupted ﬁrm of being replaced is modeled as directly proportional to the performance of the economy in
the previous period.

The increase in the stock of debt in the case of hedge ﬁrms will only occur when desired investment i j > a j,
which requires ﬁrms to seek external ﬁnance for capital accumulation. Whenever a j > i j, ﬁrms will (partially
or totally) repay their stock of debt and distribute any remaining proﬁts to managers.

5

Hence, the law of motion of ﬁrms’ bonds when a j

t−1 can be written as:

t < i j

t + b j
t − a j

t

∆b j = i j

(12)

Whenever a j

t ≥ i j

t + b j

t−1, the previous stock of debt is entirely repaid, so that

and the remainder Θ j
scribed in subsection 2.2.

t = a j

t − i j

t − b j

∆b j = −b j
t−1

(13)
t−1 ≥ 0 is distributed to ﬁrms’ managers (households), as will be de-

2.2 The household sector
As described in the previous subsection, workers earn wages w which add up to a constant share Ψ of total
output Q, and managers receive an amount Θ = ∑ j Θ from ﬁrms’ excess proﬁts.

Households’ total disposable income Y is composed by wage and proﬁt earnings:

Households’ wealth is accumulated as an effect of savings S in the form of money deposits M,

Yt = ΨpQt + Θt

∆Wt = ∆Mt = St

(14)

(15)

where savings S are deﬁned as the difference between households’ disposable income and consumption

levels St = Yt −Ct.

Finally, consumption spending will be assumed to be a ﬁxed proportion of disposable income and wealth, as
in standard in SFC models (Godley and Lavoie, 2007). We will further assume that the propensity to consume
out of wages is different (higher) than the propensity to consume out of distributed proﬁts Θ = ∑ j Θ j. The
hypothesis of differential savings among income groups or social classes have been a key feature in neo–
Kaleckian models since Kaldor (1955-1956) and Kalecki (1971).

(16)
where 0 ≤ sΨ,sΠ,σ < 1 and σ are the propensities to save out of wages, distributed proﬁts and wealth, respec-
tively.

Ct = (1− sΨ)ΨpQt + (1− sΠ)Θt + (1− σ )Wt−1

2.3 The ﬁnancial sector
The ﬁnancial sector is considered as an aggregate. It gives loans to ﬁrms, hence holding bonds as an asset, and
creates money deposits endogenously. It charges an exogenous interest rate ¯i on bank loans.

Since money deposits are assumed to earn no interest, net interest payments by ﬁrms allow the ﬁnancial

intermediary to accumulate net worth Ωb according to:

∆Ωb

t = ¯iBt−1

(17)

6

2.4 Goods market equilibrium
As the model is demand-driven, total output Q adjusts to the sum of aggregate consumption C, from equation
(16), and investment I.

pQt = (1− sΨ)ΨpQt + (1− sΠ)Θt + (1− σ )Wt−1 + It

As it is not possible to establish analytically how many hedge ﬁrms fall in the sub-category in which
retained proﬁts are more than sufﬁcient to repay the total stock of debt, and thus the amount of proﬁts that are
distributed to managers, we will assume hereafter that the propensity to consume out of proﬁts is zero (sΠ = 1)
for simplicity.8

Solving for pQt and substituting Ψ from expression (9) yields

pQt =

1 + µ
µ + sΨ

[It + (1− σ )Wt−1]

(18)

Section 5 will specify the dynamics of the number of ﬁrms in each state Nz, as well as the mean-ﬁeld
value for each macro-variable within the sub-population of speculative or hedge ﬁrms. Using equation (3) and
following this notation, the aggregate level of investment It in (18) can be written as:

It = N1[(α1 Π + β )pq1,t−1 − λ b1,t−1] + N2[(α2 Π + β )pq2,t−1 − λ b2,t−1]

(19)

3 Numerical simulations

We run numerical simulations of the above described agent-based model in Matlab. Figure 1 displays the
simulation results for a single run: a cyclical pattern arises from this simple setup in line with the Minskyan
characterization of the business cycle. In other words, the system goes through periods of debt-fueled booms,
followed by busts triggered by ﬁrms’ deleveraging and bankruptcies. During expansions, the share of specu-
lative units increases together with aggregate leverage. At the peak of the cycle, the amount of debt becomes
unsustainable and heavily leveraged ﬁrms start reducing investment, while ﬁnancially distressed speculative
ﬁrms default. The decline in aggregate demand only stops when ﬁrms’ debt is small enough for investment
to recover. The economy does not display any growth trend, given that technology and labor productivity are
constant.

Despite the fact that ﬂuctuations are perhaps too regular to be compared with a real economy, the model
mimics the empirically observed pro-cyclicality of business debt and proﬁts, as well as a few other regularities.
First, Monte Carlo replications of the model yield a realistic value of 4 for the ratio between the variance of
investment and the variance of consumption. The autocorrelation coefﬁcients of output and investment are both
equal to 0.89 over 50 Monte Carlo replications, being comparable to estimates in the literature for de-trended
series. Second, the distribution of variations of output from period to period can be well ﬁtted by a Weibull,
in line with the evidence presented in Di Guilmi et al. (2005). Third, the distribution of ﬁrms is right-skewed
according to different proxies of their size (capital, debt and proﬁts), as also empirically detected.

The sensitivity of the agent-based model to parameter conﬁgurations was tested by means of Monte Carlo
simulations. The parameters α1,β ,δ , µ,λ and ¯i are varied within a given interval and for each value we run
1,000 replications, so as to make sure that results are not affected by the particular random seed of a single run.
The intervals of variations we use are: α1 ∈ [0.2,0.45],β ∈ [0.05,0.35],δ ∈ [0.025,0.15], µ ∈ [0.3,0.7],λ ∈
[0.01,0.13] and ¯i ∈ [0.05,0.3]9.

8In a more complete model, the distribution of proﬁts to managers could be replaced by share buybacks by ﬁrms, for instance,

and would also not enter the determination of aggregate demand.

9The other parameters are set as in the benchmark scenario, with the exception of c = 3, which smoothes the cycle without

qualitatively affecting the results.

7

Results of Monte Carlo simulations for α1 (ﬁgure 2a) allow for a numerical assessment of the role of
behavioral heterogeneity, considering equation (3) and the fact that α2 is kept constant at 0.2. Not surprisingly,
an increase in α1, the sensitivity of speculative ﬁrms’ investment to internal funds, reduces the degree of
ﬁnancial fragility of the system, as it lowers the share of speculative ﬁrms and the debt-to-GDP ratio. However
the debt-to-capital ratio is slightly increasing in α1 for both speculative and hedge ﬁrms, and hence in aggregate
terms, implying that the rate of accumulation of debt is faster than the accumulation of capital in these scenarios.
Similar results are obtained from an increase in β , the sensitivity of investment to demand, but in this case the
increase in the aggregate debt-to-capital ratio is more dramatic, due to the rise in speculative ﬁrms’ leverage.
The results for a raise in the interest rate ¯i (Figure 2b) show that a higher rate raises the bankruptcy ratio
and, consequently, increases aggregate demand, while slowing down the accumulation of debt. This puzzling
result can be explained both through the lower negative component in the investment function (3), due to
lower debt in the system, and through the higher share of speculative ﬁrms, which have a higher sensitivity to
internal resources and therefore are expected to invest more, ceteris paribus. At a ﬁrst sight, the results seem to
support a lean-against-the-wind type of policy, but only if one neglects the increase in volatility and the higher
frequency and magnitude of ﬂuctuations that are generated in the system.

In order to test the role of the ﬁrms’ demography in determining this result, we run a different set of Monte
Carlo simulations in which the maximum debt-to-capital ratio is increased to c = 25, so that all bankrupted
ﬁrms are immediately replaced by new ones10. In this setting, aggregate debt and the debt-to-capital ratio
are increasing in ¯i and almost all ﬁrms are speculative. Hence, results for aggregate demand and the debt-to-
output ratio can thus be seen as consequence of the assumption of a constant number of ﬁrms N throughout the
simulations.

An increase in λ implies a greater sensitivity of ﬁrms’ investment to their outstanding debt, or a higher
degree of risk-aversion. Debt and debt-to-capital ratios are lower for higher λ (ﬁgure also available upon
request), while debt-to-output ratios increase, due the lower level of aggregate demand.

An increase in the proﬁt share of output, as generated by a larger mark-up µ, reduces aggregate demand,
aggregate leverage and the proportion of speculative ﬁrms in the economy. These ﬁrms display a higher aver-
age debt-to-output ratio, but a lower debt-to-capital ratio, as they invest more due to higher proﬁts, but sell less
due to lower aggregate demand. At the aggregate level, however, the increase in proﬁts more than compensates
for the decline in aggregate demand, leading to lower aggregate leverage. The lower level of aggregate de-
mand also inhibits investment decisions, partially offsetting the positive effect of higher proﬁtability on capital
accumulation. Overall, the debt-to-capital ratio decreases both for speculative ﬁrms and at the aggregate level.
Finally, a higher rate of depreciation of capital has a proportionally larger impact on debt, via bankruptcy,
than on capital and demand, causing a reduction in the overall leverage. In contrast, the debt-to-capital ratio of
speculative ﬁrms is increasing in δ .11

4 Firms’ dynamics

As illustrated in sections 1 and 2, the analytical solution method adopted by this paper operates through a
reduction in the heterogeneity by grouping the agents into clusters. In order to study the stochastic evolution
of the system analytically we use a mean-ﬁeld approximation, which essentially involves reducing the vector
of observations of a variable to a single value for a given population (Brock and Durlauf, 2001). In the present

10The simulations without changes in ﬁrms’ demography will also permit a consistent comparison with the analytical solution,
which does not explicitly consider bankruptcy, in section 5. Figures displaying results for this last scenario were not shown for space
constraints but are available upon request.

11Last two ﬁgures available upon request.

8

treatment, the mean-ﬁeld approximation is performed by simply taking the average of the relevant micro-
variables within each group.

The following step is presented in subsection 4.1 and concerns the deﬁnition of the probabilistic rules that
determine the switch of ﬁrms between groups. The dynamics of the number of agents in each cluster is assumed
to follow a Markovian stochastic process. This class of processes can be described by a master equation, namely
a stochastic differential equation that depends on the probabilities of transition between states. The main steps
of this procedure and the solution of the master equation are presented is subsection 4.2. In particular, this
solution can be expressed by an ordinary differential equation plus a stochastic component given by a Wiener
process. Both the ordinary differential equation and the noise term are formulated as functions of the micro-
variables that determine the transition of agents between groups. This result is then used in section 5 for the
derivation of the laws of motion of relevant macroeconomic variables.

As for the notation, since the population of ﬁrms is reduced to just two (one average hedge ﬁrm and one

average borrowing ﬁrm), the superscript j is no longer used for ﬁrm-level variables.

4.1 Transition probabilities
The probability of a single ﬁrm changing state can be derived using (1) or (2). In particular, a hedge ﬁrm turns
to speculative if its net proﬁt becomes negative according to condition (1), while a speculative ﬁrm becomes
hedge if it earns a positive net proﬁt, based on condition (2). The magnitude of each ﬁrms’ net proﬁt depends on
the idiosyncratic shock s, which determines the quantity they sell. As the distribution of the shock s is known
by assumption, it is convenient to quantify the probabilities of transition as function of s. Let us preliminarily
deﬁne the variable Γz as

(cid:18) ¯itbz,t

Πpqz,t

(cid:19) Kt

Kt − kz,t

− 1

Γz,t =

(20)

Using equations (1), (2), (7) and (11), it follows that a speculative ﬁrm j becomes hedge and hedge ﬁrms

becomes speculative if, respectively

t ≥ Γ1,t
s j

and

s j
t < Γ2,t

The ﬁrst probability will be denoted by η and the second by ζ . Accordingly, we can write

t = Pr[st ≥ Γ1,t]
η j

and ζ j

t = Pr[st < Γ2,t]

Assuming s to be uniformly distributed in the interval [−0.5,0.5], we are able to quantify the two probabilities
using the cumulative distribution function of s, so that:

ηt = 0.5− Γ1,t

ζt = 0.5 + Γ2,t

(21)

(22)

4.2 Solution to the master equation: stochastic dynamics of trend and ﬂuctuations
If we assume that the number of ﬁrms in each of the two states follows a jump Markov process, we can use the
master equation to describe the stochastic evolution of the system. Taking N1 as our state variable, the master
equation allows us to represent the dynamics of the probability of a certain number of ﬁrms N1 being in state
1 as the balance equation between the aggregate transition to and from state 1. Considering an interval of time

9

∆t small enough to be approximated by a continuous time representation, we can express the master equation
for the dynamics of ﬁrms in state 1 as

dP(n1,t)

dt

= η(t)P(n1 − 1/N)(t) + ζ (t)P(n1 + 1/N)(t) + [η(t) + ζ (t)]P(n1)(t)

(23)

where n1 = N1/N.
Equation (23) describes the dynamics of the probability of having a fraction n1 of speculative ﬁrm as
the sum of the probability of transitioning from a number N1 − 1 to N1 and the probability of transitioning
from a number N1 + 1 to N1, less the probability of already having a number N1 of speculative ﬁrm times
the probability of a transition into or from the speculative state. The master equation can be solved using
approximation techniques12,. For this algorithm to be applied, the state variable must be split into trend and
cyclical components. Following Aoki (2002) and indicating, respectively, with ¯n1 the deterministic trend and v
the deviation, the state variable can be reformulated as

n1 = φ + N−1/2v

(24)

so as to normalize the standard deviation v.The development of the solution algorithm yields the following
ODE for the trend

(25)
The stationary solution of the second equation presumes a Gaussian distribution for the stochastic noise around
the trend, so that:

˙φ = ζφ − (η + ζ )φ 2

(cid:19)

(cid:18)
− v2
2σ 2

P(v) = C exp

such that P(v) ∼ N (0,

ηζ
(η+ζ )2 ) The dynamics of n1 can thus be described by

˙n1(t) = ζφ − (η + ζ )φ 2 + σ dV (t)

(26)

(27)

where dV is a stationary Wiener increment and σ dV is the stochastic ﬂuctuation component in the proportion
of speculative ﬁrms, coming from the distribution (26).

The solution of the master equation provides a good approximation for the underlying agent-based model
despite the reduction in heterogeneity. Figure 3 shows the results for the share of speculative ﬁrms, obtained
for the master equation solution by using the results of the simulations of the agent based model in equation
(27), and the level of aggregate debt obtained from the product of the mean-ﬁeld values of ﬁrms’ debt b1 and
bn and the corresponding number of ﬁrms. The proportion n1 is weighted by the number of surviving ﬁrms,
so as to take into account the effect of bankruptcy13. Without bankruptcy, the two series move together during
expansions while, during recessions, the master equation solution n1 does not drop until the cycle is very close
to its trough. Having tested the reliability of the analytical solution, we can now use it to gain further insights
into the behavior of the model.

12The solution algorithm introduced by Aoki (2002) and further developed by Landini and Uberti (2008) and Di Guilmi (2008), has
the advantage of returning a solution that is composed by two equations: an ordinary differential equation, which describes the time
evolution of the trend of the stochastic process, and a partial differential equation (known as Fokker-Planck equation), whose general
solution identiﬁes the probability distribution of the ﬂuctuations around the drift component. The full derivation of the solution is
omitted here. We refer the interested reader to Di Guilmi (2008) and Chiarella and Di Guilmi (2011).

13Di Guilmi et al. (2012) proposes and uses a solution method for the master equation for a system with a variable number of agents.
Given the considerable analytical complexity of that treatment and the scope of the present paper we adopted the simpliﬁcation of
considering N ﬁxed and consider this difference in the comparison of the numerical and analytical treatment.

10

5 Analytical solution

This section presents an analytical assessment of the links between debt dynamics at the micro and macro levels.
In particular, it highlights the role of ﬁrms’ heterogeneity for the dynamics of aggregate debt and leverage.

We will thus start by studying separately the evolution of the stock of debt held by speculative and hedge
ﬁrms, before proceeding to a macro analysis. The results of the analysis are also compared with the outcomes
of the Monte Carlo simulations, yielding further insights on the causal relationships determining the dynamics
of the model.14

5.1 Debt dynamics
In this subsection we focus on the joint dynamics of b1,b2 and N1, looking ﬁrst at the steady state values and
then at the conditions for stability.

.

˜b1
pq1

> ˜b2
pq2

5.1.1 Steady-state analysis
Proposition 1. At the steady-state where ˙b1 = ˙b2 = 0, the mean-ﬁeld debt-to-output ratio of speculative ﬁrms
is higher than that of hedge ﬁrms. Formally:
Proposition 2. At the equilibrium where ˙b1 = ˙b2 = ˙N1 = 0, which constitutes a steady-state for the aggregate
level of debt B, the number of speculative ﬁrms ˜N1 is the higher, the lower is α1, the sensitivity of speculative
ﬁrms’ investment to proﬁts. The direction of the response of ˜N1 to parameters ¯i, α2, β , λ and Π depends on the
speciﬁc parametric conﬁguration.
Proposition 3. At the equilibrium where ˙b1 = ˙b2 = ˙N1 = 0, the steady-state value of aggregate debt ˜B is the
higher, the higher is, ceteris paribus, the degree of heterogeneity between the two subgroups of ﬁrms as for
the sensitivity of investment to proﬁts (α1 − α2), while, for α1 = α2, it is unaffected by the difference in the
magnitude of output, or ﬁrms’ size, (q1 − q2).

> b2
pq2

In fact, in all the simulations b1
pq1

The results of the steady state analysis generally match the outcomes of numerical simulations previously
described 15.
as for proposition 1. The analytical approximation
of the agent-based model reveals that this regularity is emerging due to behavioral heterogeneity (α1 > α2).
Proposition 2 proves that the inverse correlation between α1 and N1 showed in ﬁgure 2a is independent of
the parameter conﬁguration, while the patterns that emerge in the Monte Carlo simulations for ¯i,β and λ
have relied on a particular parameter setting. Even with a number of different Monte Carlo simulations using
different parameter settings, the full reliance on numerical solutions would not be sufﬁcient to provide this
kind of certainty. Finally, given that α2 is constant in the Monte Carlo simulations, Proposition 3 illustrates the
causal relationship through which the model generates the direct correlation between α1 and aggregate debt
displayed by ﬁgure 2a. The second statement of proposition 3 stresses the role of behavioral heterogeneity
relative to size heterogeneity for the outcome of the simulations. Again, this is a result that could not be
achieved with the sole numerical analysis, given the impossibility of forcing size homogeneity across ﬁrms.

Summing up, the level of heterogeneity in the elasticity of the investment function to internal ﬁnance
appears to be crucial for the long run dynamics of the economy. For a given level of α2, a larger α1 implies
not only a larger difference in the leverage ratio of the two types of ﬁrms but also a greater stock of aggregate
debt. Speculative ﬁrms invest more and, consequently, resort to credit. At the same time, a larger α1 reduces
the steady-state level of the number of speculative ﬁrms. Given that B = N1b1 + N2b2, the effect is larger on

14Proofs are sketched in the appendix. Complete proofs are available upon request.
15In the present analysis, we consider the outcome of the Monte Carlo simulations as an approximation of the steady state.

11

b1 than on N1. The decrease in N1 can be explained from the fact that speculative ﬁrms rely more on internal
ﬁnance for capital accumulation, which also raises their chances of becoming hedge.

5.1.2 Stability analysis

In this subsection we will focus on the joint stability of b1 and N1 around the steady-state, given the more
crucial role of speculative ﬁrms’ leverage for the ﬁnancial stability of the system as a whole, from a Minskyan
standpoint. A stability analysis for hedge ﬁrms, or b2 and N2, can be derived in similar fashion. This study
provides additional qualitative insights on the results of the Monte Carlo simulations.

The analysis will be based on the system of differential equations composed by expressions (37) and (34).

Proposition 4. The interest rate ¯i has an ambiguous effect on the stability of the dynamical system16.

The uncertainty about the effect of the interest rate is a consequence of the different role it has on the
dynamics of the number of speculative ﬁrms and on their individual level of debt. On the one hand, a higher
interest rate increases the number of speculative ﬁrms through its effect proﬁts in equation (11). Due to the
logistic functional form of the dynamics of speculative ﬁrms (27), as the level of N1 increases, its rate of growth
decelerates, such that ∂ ˙N1
< 0. On the other hand, the interest rate positively affects ˙b1, through its negative
∂ N1
effect on retained proﬁts. As a consequence ∂ ˙b1
responds positively to ¯i. The two effects are embodied in the
∂ b1
expression for the trace of the system’s Jacobian matrix, as analyzed below.
Proof. After deriving the Jacobian of the system ( ˙N1, ˙b1) from expressions (37) and (34) and evaluating it at
the steady-state, the trace of J is thus given by:

Tr(J) = 0.5− ¯i
Π

b2
pq2

− (λ − ¯i)

By further substituting for the steady-state of b2 from (36), we have that in the vicinity of the steady-state

for total debt B analyzed in the previous subsection, the trace is:
(α2 − 1)Π + β

Tr(J) = 0.5− ¯i
Π

λ − ¯i

− (λ − ¯i)

The system is hence unstable whenever the following expression holds:

(α2 − 1)Π + β

λ − ¯i

¯i
Π

+ (λ − ¯i) > 0.5

(28)

Debt instability for speculative ﬁrms is thus more likely when the proﬁt share Π is high, and the response
of hedge ﬁrms’ investment to proﬁts and demand, α2 and β , respectively, are low. The effect of the interest rate
(cid:4)
on debt stability depends on parameter conﬁgurations.
Proposition 5. Given the constraints on the parameters, the steady states for ˙b1 and ˙N1 are most likely on a
saddle path.

16We numerically assess the effect of the interest rate on the stability of the system for the following values and ranges of param-
eters: α2 = 0.2, β = 0.5, λ ∈ [0.15, 0.35], Π ∈ [0.3, 0.5], ¯i ∈ [0.05, 0.1]. The stabilizing effect coming from a lower ˙N1 appears to
dominate the destabilizing effect of an increase in the average debt of speculative ﬁrms, such that a larger interest rate makes a stable
trajectory more likely. In particular, as shown by ﬁgure 4a, for λ = 0.15, ¯i > 0.8,Π = 0.5 the determinant becomes positive. A lower
λ increases N1, thus reducing ˙N1, due to the logistic functional form of (27). Figure 4b illustrates that the determinant is also more
likely to be positive for low values of Π. In particular we veriﬁed it is always positive for λ = 0.35, ¯i > 0.5,Π = 0.3. Thus, a higher
proﬁt share negatively affects the stability of the system ˙N1, ˙b1.

12

Proof. After a few algebraic simpliﬁcations, the determinant of J can be written as:

Det(J) = ¯i(α2 − 1 +

β

Π)− (λ − ¯i)

2Π

The case of saddle-path (in)stability is thus obtained whenever the interest rate is sufﬁciently low17 and the
term in the right and side of expression (29), which increases with the sensitivity of investment to debt λ , and
decreases with the proﬁt share Π, the sensitivity of hedge ﬁrms’ investment to proﬁts α2, and the response of
investment to output, β .

λ

¯i <

2Π(α2 − 1) + 2β + 1

(29)
(cid:4)

Propositions 4 and 5 complete the study of the sensitivity of the system to parameters, identifying ranges of
stability. Again, a numerical approach could only lead to this type of interpretation through multiple attempts,
by reporting for example the values of the parameters for which the simulation crashes or returns inconsistent
results, without any possibility of generalization.

5.2 Dynamics of capital and the leverage ratio
With 0 < δ < 1 as the rate of capital depreciation and investment from (19), the law of motion for speculative
ﬁrm’s capital stock ˙k1, in value, can be expressed as:

p˙k1(t) = (α1Π + β )pq1(t)− λ b1(t)− pδ k1(t)

Consequently, k1 reaches the steady state at:

p˜k1 =

(α1Π + β )pq1 − λ b1

δ

(30)

(31)

Proposition 6. At the steady-state for both b1 and k1, the leverage ratio for the speculative ﬁrm, ˜b1/(p˜k1), is
the higher, (i) the higher is the interest rate ¯i, (ii) the higher is the depreciation rate δ , (iii) the lower is the
sensitivity of investment to leverage λ , (iv) the higher is the sensitivity of investment to proﬁts α1, (v) the higher
is the sensitivity of investment to output β , and (vi) the lower is the proﬁt share Π.

Proof. By expressing pq1 as a function of ˜b1 and substituting in (31), we obtain the steady-state leverage

ratio for the speculative ﬁrm18:

˜b1
p˜k1

=

δ (α1 + β /Π− 1)
λ − ¯i(α1 + β /Π)

(32)
(cid:4)

Proposition 7. At the steady-state for b1, b2, k1 and k2, the leverage ratio of speculative ﬁrms is higher than
that of hedge ﬁrms. Formally:

˜b1
p˜k1

>

˜b2
p˜k2

17In the benchmark scenario of the simulations the interest rate is in the stability range, not satisfying conditions (28) and (29).
18Proposition 6 also expresses some of the results of the Monte Carlo simulation, and demonstrates that these outcomes do not
rely on speciﬁc parameter conﬁgurations. Given that the analytical solution does not consider bankruptcy of ﬁrms, the relevant plot
for this comparison is not the one showed in the appendix.

13

Proof. Analogously, the steady-state leverage ratio for hedge ﬁrms is given by:

˜b2
p˜k2

δ (α2 + β /Π− 1)
λ − ¯i(α2 + β /Π)

=

(33)

Proposition 7 hence follows from comparing equation (32) to (33), on the assumption that α1 > α2.

(cid:4)
Proposition 8. At the steady-state where ˙k1 = ˙k2 = ˙b1 = ˙b2 = ˙N1 = 0, the steady-state level of aggregate capital
stock ˜K decreases with ﬁrms’ heterogeneity in the sensitivity of investment to proﬁts (α1−α2), but is unaffected
by the heterogeneity in ﬁrms’ size (q1 − q2).

Proposition 8 integrates the results of the Monte Carlo simulations by separately studying the role of het-
erogeneity in, respectively, behavior and size, and conﬁrm the stronger relevance of the former in shaping the
long-run dynamics of the system. Interestingly, results for α1 − α2 are not consistent with the numerical simu-
lations, which implies that the result of proposition 8 cannot be generalized to the case in which heterogeneity
in size is present. From this perspective the Monte Carlo simulations and the analytical solution can be seen as
complementary for the understanding of the role of heterogeneity.
Proposition 9. At the steady-state where ˙k1 = ˙k2 = ˙b1 = ˙b2 = ˙N1 = 0, the aggregate leverage ratio ˜B/(p ˜K) is
the higher, (i) the higher is the interest rate ¯i, (ii) the lower is the response of investment to debt λ , and (iii) the
higher is the degree of heterogeneity in the response of investment to proﬁts α1 − α2, while it is unaffected by
the heterogeneity in ﬁrms’ size q1 − q2.

Given α2, a higher α1 reduces the accumulation of capital and, consistently with the results of proposition
3, increases the aggregate leverage ratio. This is a consequence of the larger reliance of capital accumulation on
the less ﬁnancially sound ﬁrms. Proposition 9 conﬁrms the results of the Monte Carlo simulations for α1 and
¯i, which do not depend on the parameter conﬁguration. The analysis points to the role of behavioral variables,
and in particular to the sensitivity of investment to internal ﬁnance and debt, as the key drivers of the system
along a more sustainable long-run path. The statements of proposition 9 are consistent with ﬁgures 2a, 2b and
??, thus suggesting that point (iii) of the proposition holds also with size heterogeneity.

The results of this subsection, when taken together with the stability analysis of the system, help illuminate
It becomes clear that the
the implications of the Monte Carlo simulations for the role of the interest rate.
handling of the interest rate ¯i can have perverse effects on the system dynamics by accelerating the accumulation
of debt and, over a certain threshold, can lead the system to instability. Consequently, a lean-against-the-wind
policy can add to the fragility of the system and does not represent an ideal tool to halt a speculative boom.

6 Concluding remarks

This paper introduces microeconomic foundations into a demand-driven macroeconomic model in order to
study the role of real-ﬁnancial linkages in generating economic growth and business cycles endogenously.
The paper shows that the analysis of systemic ﬁnancial fragility is greatly enriched by the introduction of
heterogeneous microeconomic behavior, in line with Minky’s approach. To this aim, the model was initially
built in a bottom-up fashion and solved numerically with full heterogeneity of agents. An aggregation method
imported from statistical mechanics then helped us reduce the degree of heterogeneity between ﬁrms to only
two classes – inspired by Minsky’s terminology of hedge and speculative ﬁnancial behavior – thus allowing for
the study of the relationship between micro behavioral rules and macroeconomic dynamics of ﬁrms’ leverage
and capital.

The analytical study has added to the results of the numerical simulations in at least four different ways.
First, it demonstrates which results from the Monte Carlo simulations can be generalized, and which ones rely

14

on particular parametric conﬁgurations. Second, it illuminates the causal relationships that lead to the observed
effects of changing parameters on the macro variables in the simulations. Third, it allowed for a systematic
study of stability conditions that cannot be performed in non-trivial agent-based models. Fourth, it permits ex-
periments that are not possible in simple numerical simulations, such as examining the role of heterogeneity of
agents along a speciﬁc dimension, while keeping other dimensions homogenous. The analytical representation
of the stability conditions and causal chain within the model can also assist in the calibration the numerical
simulations, by identifying parameter ranges in which the model is unstable or yields inconsistent results.

With reference to the speciﬁc results of this model, the analysis shows that a higher difference in the re-
sponse of ﬁrms’ investment to internal ﬁnance between speculative and hedge ﬁrms pushes the system along
a long-run path characterized by higher leverage and lower capital accumulation. In fact, a larger difference
α1 − α2 implies that growth relies more on speculative ﬁrms and therefore on borrowing. In terms of policy
indications, the analysis shows that a higher interest rate on loans is likely to have a stabilizing role, but at the
price of a higher share of speculative ﬁrms with a high leverage ratio in the economy. It is worth noting that
a higher sensitivity of speculative ﬁrms to internal ﬁnance leads, ceteris paribus, to a larger accumulation of
debt at micro and macro-level. The increase in external ﬁnancing appears to offset the beneﬁt of a more con-
servative attitude of speculative ﬁrms. In terms of income distribution, a larger share of proﬁt has a potentially
destabilizing effect on the dynamics of the system.

The integration of Monte Carlo simulations with the analysis of the dynamical system derived from this
analytical approximation of the agent-based model represents an absolute primer in the literature, and we hope
that it will pave the way for a different modeling approach. While at this stage of developments, numerical
simulations are still essential for a complete analysis of model outcomes, especially due to nonlinearities in the
system, the proposed analytical solution provides a benchmark for interpreting and generalizing these results.
Besides the introduction of a multi-state master equation, which can provide a more accurate approximation
of the underlying agent-based model, a possible further development concerns a more reﬁned study of the
conditions under which bubbles and busts are generated in the present setting. When it comes to adding more
realistic features to the model setup, possible extensions include, for instance, incorporating a stock market,
endogenizing the mark-up rate and the functional distribution of income, as well as allowing for heterogeneity
in the household and/or ﬁnancial sector.

References

AOKI, M. (2002): Modeling aggregate behaviour and ﬂuctuations in economics., Cambridge University Press.

AOKI, M. and YOSHIKAWA, H. (2006): Reconstructing Macroeconomics, Cambridge University Press.

BEZEMER, D. J. (2010): Understanding Financial Crisis Through Accounting Models, Accounting, Organiza-

tions and Society, 35(7): pp. 676 – 688.

BROCK, W. A. and DURLAUF, S. N. (2001): Discrete Choice with Social Interactions, Review of Economic

Studies, 68(2): pp. 235–60.

CHIARELLA, C. and DI GUILMI, C. (2011): The Financial Instability Hypothesis: A Stochastic Microfoun-

dation Framework, Journal of Economic Dynamics and Control, 35(8): pp. 1151 – 1171.

DELLI GATTI, D., DI GUILMI, C., GAFFEO, E., GIULIONI, G., GALLEGATI, M. and PALESTRINI, A.
(2005): A New Approach to Business Fluctuations: Heterogeneous Interacting Agents, Scaling Laws and
Financial Fragility, Journal of Economic Behavior and Organization, 56(4): pp. 489–512.

15

DELLI GATTI, D., GAFFEO, E. and GALLEGATI, M. (2010): Complex Agent-Based Macroeconomics:
a Manifesto for a New Paradigm, Journal of Economic Interaction and Coordination, 5: pp. 111–135,
10.1007/s11403-010-0064-8.

DELLI GATTI, D., GALLEGATI, M. and GARDINI, L. (1993): Investment Conﬁdence, Corporate Debt and

Income Fluctuations, Journal of Economic Behavior & Organization, 22(2): pp. 161–187.

DI GUILMI, C. (2008): The generation of business ﬂuctuations: ﬁnancial fragility and mean-ﬁeld interaction,

Peter Lang Publishing Group: Frankfurt/M.

DI GUILMI, C., GAFFEO, E., GALLEGATI, M. and PALESTRINI, A. (2005): International Evidence on Busi-
ness Cycle Magnitude Dependence: An Analysis of 16 Industrialized Countries, 1881-2000, International
Journal of Applied Econometrics and Quantitative Studies, Euro-American Association of Economic Devel-
opment, 2(1): pp. 5–16.

DI GUILMI, C., GALLEGATI, M., LANDINI, S. and STIGLITZ, J. E. (2012): Dynamic Aggregation of Het-
erogeneous Interacting Agents and Network: An Analytical Solution for Agent Based Models, Tech. rep.,
mimeo, URL http://www2.gsb.columbia.edu/faculty/jstiglitz/topics.cfm.

DOS SANTOS, C. H. (2005): A Stock-Flow Consistent General Framework for Formal Minskyan Analyses of

Closed Economies, Journal of Post Keynesian Economics, 27(4): pp. 712–735.

DOSI, G., FAGIOLO, G., NAPOLETANO, M. and ROVENTINI, A. (2013): Income distribution, credit and
ﬁscal policies in an agent-based Keynesian model, Journal of Economic Dynamics and Control, 37(8): pp.
1598–1625.

DUTT, A. K. (1984): Stagnation, income distribution and monopoly power, Cambridge Journal of Economics,

8(1): pp. 25–40.

FAZZARI, S. M., HUBBARD, G. and PETERSEN, B. C. (1988): Financing Costraints and Corporate Invest-

ments, Brookings Papers on Economic Activity, (1): pp. 141–195.

FOLEY, D. K. (1994): A Statistical Equilibrium Theory of Markets, Journal of Economic Theory, 62(2): pp.

321–345.

GODIN, A. and KINSELLA, S. (2012): Leverage, liquidity and crisis: A simulation study, ASSRU Discussion

Papers 1205, ASSRU - Algorithmic Social Science Research Unit.

GODLEY, W. and LAVOIE, M. (2007): Monetary Economics: an integrated approach to credit, money, income,

production and wealth, Palgrave Macmillan: London.

KALECKI, M. (1971): Selected Essays on the Dynamics of the Capitalist Economy, Cambridge University

Press.

KHALIL, S. and KINSELLA, S. (2011): Bad Banks Choking Good Banks: a Simulating Balance Sheet Conta-

gion, Working Papers 201126, Geary Institute, University College Dublin.

KIM, Y. and ISAAC, A. (2010): The Macrodyamics of Household Debt, Working Papers 1010, Trinity College,

Department of Economics.

LANDINI, S. and UBERTI, M. (2008): A Statistical Mechanics View of Macro-dynamics in Economics, Com-

putational Economics, 32(1): pp. 121–146.

16

MINSKY, H. P. (2008): John Maynard Keynes, McGraw-Hill, ﬁrst edition 1975.
ROWTHORN, R. (1982): Demand, Real Wages and Economic Growth, Studi Economici, 18: pp. 3–53.

SCHULARICK, M. and TAYLOR, A. M. (2012): Credit Booms Gone Bust: Monetary Policy, Leverage Cycles,

and Financial Crises, 1870-2008, American Economic Review, 102(2): pp. 1029–61.

TAYLOR, L. (1985): A Stagnationist Model of Economic Growth, Cambridge Journal of Economics, 9(4): pp.

383–403.

TAYLOR, L. and O’CONNELL, S. A. (1985): A Minsky Crisis, The Quarterly Journal of Economics, 100(5):

pp. 871–85.

TOBIN, J. (1969): A General Equilibrium Approach to Monetary Theory, Journal of Money, Credit and Bank-

ing, 1(1): pp. 15–29.

VAN TREECK, T. (2009): A Synthetic, Stock-Flow Consistent Macroeconomic Model of ’Financialisation’,

Cambridge Journal of Economics, 33: pp. 467–493.

WEIDLICH, W. (2000): Sociodynamics: A Systematic Approach to Mathematical Modelling in the Social

Sciences, Gordon and Breach: London.

A Sketch of the proofs.
Proof of Proposition 1. Using the law of motion (12) and substituting for i and a from (3) and (11), the
evolution of the mean-ﬁeld level of debt for speculative ﬁrms is given by

˙b1(t) = [(α1 − 1)Π + β ]pq1(t)− (λ − ¯i)b1(t)
At the steady-state, the debt-to-output ratio for speculative ﬁrms is thus:

(cid:19)
(cid:19)

˜(cid:18) b1
˜(cid:18) b2

pq1

pq2

(α1 − 1)Π + β

λ − ¯i

=

(α2 − 1)Π + β

λ − ¯i

=

Analogously, for hedge ﬁrms, the steady-state value for the debt-to-output ratio is given by19:

Since we have considered that speculative ﬁrms are more sensitive than hedge ﬁrms to their proﬁt rate
when deciding to invest, namely that α1 > α2, the equilibrium debt-to-output ratio is also higher for the former
(cid:4)
category.

Proof of Proposition 2. Using the law of motion for the number of speculative ﬁrms20 (27) and substituting

for η and ζ using expressions (21), (22) and (20), we get:
N1(t)−

˙N1(t) = N

−0.5 +

¯i
Π

b2(t)
pq2(t)

1 +

¯i
Π

(cid:19)

(cid:20)

(cid:26)(cid:18)

(cid:18) b2(t)

pq2(t)

(cid:19)(cid:21)

(cid:27)

+

b1(t)
pq1(t)

N1(t)2

(37)

19The correspondence between the two cases only holds because the steady-state value for hedge ﬁrms for which debt evolved

according to the alternative law of motion (13) is zero.

20The stochastic noise is not considered in the present analysis since its expected value is null. The term Kt

Kt−kz,t that appears in

equation (20) can be considered equal to 1 for a large number of ﬁrms N and can be thus be omitted.

17

(34)

(35)

(36)

The number of speculative ﬁrms is constant when ˙N1 = 0, which yields the steady-state, already using (35)

and (36):

˜N1 = N

2 + ¯i(α2 + β

Π − 1
− λ
2)
Π − 3)
λ + ¯i(α2 + α1 + 2 β

(38)

The number for speculative ﬁrms hence depends ambiguously on the interest rate on loans and the debt-to-
output ratios of hedge ﬁrms, while it decreases with the level of the debt-to-output ratio of speculative ﬁrms. As
the total number of ﬁrms N is ﬁxed, the steady-state value for the number of hedge ﬁrms is ˜N2 = N− ˜N1. Hence,
(cid:4)
in the equilibrium where N1, b1 and b2 are constant, the total stock of ﬁrms’ debt B is also constant21.

Proof of Proposition 3.

˜B = ˜N1 ˜b1 + (N − ˜N1) ˜b2 = ˜N1(˜b1 − ˜b2) + N ˜b2

By substituting ˜b1 and ˜b2:

˜B =

Πp
λ − ¯i

(cid:2) ˜N1[(α1q1 − α2q2) + (β /Π− 1) (q1 − q2)] + N (α2 − 1 + β /Π)q2

(cid:3)

(39)

where ˜N1 is only as a function of parameters, as expressed in (38).
From (39), the steady-state value of aggregate debt in the special case of full homogeneity between sub-
groups of ﬁrms in both (i) the sensitivity of investment to proﬁts (α = α1 = α2), and (ii) ﬁrms’ size (k = k1 = k2),
which from (6) and (7) is equivalent to assuming the same output q = q1 = q2, would be given by:

˜B(α,q) =

[(α − 1)Π + β ]pQ

λ − ¯i

Assuming that ﬁrms have the same sensitivity of investment to proﬁts (α = α1 = α2), but are heterogeneous
in size (q1 (cid:54)= q2), and, respectively, assuming that ﬁrms have the same size (q = q1 = q2) but are heterogeneous
in the sensitivity of investment to proﬁts (α1 (cid:54)= α2), we get:

˜B(α,q1,q2) =

[(α − 1)Π + β ]pQ

λ − ¯i

= ˜B(α,q)

and

˜B(α1,α2,q) = ˜B(α,q) +

˜N1Πpq(α1 − α2)

λ − ¯i

It is thus clear that the higher is heterogeneity in investment behavior, namely the higher is α1 relative to
(cid:4)

α2, the higher is aggregate debt.

Proof of Proposition 8. The aggregate level of capital K reaches a steady-state level ˜K given by:

˜K = ˜N1(˜k1 − ˜k2) + N ˜k2

(40)

By substituting ˜k1, ˜b1 and ˜k2 and ˜b2 from the analogous expressions for hedge ﬁrms, we obtain:
• Full homogeneity: if q = q1 = q2 and α = α1 = α2.

(cid:20)

(cid:18)

(cid:19)(cid:21)

˜K(α,q) =

Π

δ (λ − ¯i)

λ − ¯i

α +

β
Π

Nq =

Π

δ (λ − ¯i)

λ − ¯i

α +

(cid:20)

(cid:18)

(cid:19)(cid:21)

Q

β
Π

Hence, in the scenario of full homogeneity, the aggregate output-to-capital ratio U = Q/ ˜K, which as
previously mentioned can be interpreted as a proxy for the ﬁrms’ degree of capacity utilization, would
respond positively to the sensitivity of investment to both proﬁts (α) and output (β ).

21This is only a sufﬁcient, not a necessary condition, as ˙B = N1 ˙b1 + ˙N1b1 + N2 ˙b2 + ˙N2b2.

18

• Homogeneity in investment behavior: if q1 (cid:54)= q2 and α = α1 = α2.

˜K(α,q1,q2) =

α +
• Homogeneity in investment size: if q = q1 = q2 and α1 (cid:54)= α2.
˜N1 [−¯iq(α1 − α2)] +

˜K(α1,α2,q) =

δ (λ − ¯i)

(cid:26)

Π

(cid:20)

Π

λ − ¯i

δ (λ − ¯i)

(cid:19)(cid:21)

β
Π

λ − ¯i

(cid:20)

(cid:18)

Q = ˜K(α,q)

(cid:18)

α2 +

(cid:19)(cid:21)

(cid:27)

Q

β
Π

(cid:4)

Proof of Proposition 9. Proposition 9 is a corollary of Propositions 3 and 8. The equilibrium aggregate

leverage ratio is given by:

δ(cid:2) ˜N1[(α1q1 − α2q2) + (β /Π− 1) (q1 − q2)] + N (α2 − 1 + β /Π)q2
(cid:104)(cid:16)
(cid:17)(cid:105)

(cid:17)

(cid:16)

(cid:105)

(cid:3)

(q1 − q2)− ¯i(α1q1 − α2q2)

λ − ¯i

α2 + β
Π

λ − ¯i β
Π

˜N1

q2

˜B
p ˜K

=

• Full homogeneity: if q = q1 = q2 and α = α1 = α2.
(α + β
δ
λ − ¯i

(α,q) =

˜B
p ˜K

(cid:16)

(cid:104)

+ N

(cid:104)
(cid:105)
(cid:17)
Π − 1)
α + β
Π

• Homogeneity in investment behavior: if q1 (cid:54)= q2 and α = α1 = α2.

˜B
p ˜K

(α,q1,q2) =

˜B
p ˜K

(α,q)

• Homogeneity in size: if q = q1 = q2 and α1 (cid:54)= α2.

(cid:104) ˜N1q(α1 − α2) +
(cid:104)

(cid:16)

δ

˜N1 [−¯iq(α1 − α2)] +

λ − ¯i

(cid:105)
(cid:17)
(cid:17)(cid:105)
Π − 1
Q
Π − 1
α2 + β

(cid:16)

α2 + β

Q

˜B
p ˜K

(α1,α2,q) =

Hence, the higher is (α1 − α2), the higher is the numerator and the lower is the denominator of the ex-
(cid:4)
pression above.

Figure 1: Single run results: aggregate demand, proportion of ﬁrms, debt and bankruptcy ratio.

19

200250300350400104.4104.5TimeTotal demand200250300350400−0.200.20.40.60.81Timeshares of firms  HSSH200250300350400105106107TimeDebt20025030035040000.20.40.60.81Timebankruptcy ratio(a) Simulations for α1.

(b) Simulations for ¯i.

Figure 2: Results of Monte Carlo simulations.

Figure 3: Comparison of the results of the agent-based model and the analytical solution for aggregate debt
(upper panel) and share of speculative ﬁrms (lower panel).

(a) Trace and determinant for differ-
ent values of λ and ¯i.

(b) Trace and determinant for differ-
ent values of Π and ¯i.

Figure 4: Trace and determinant. The interest rate varies from 0.01 to 0.1 as we move north along each contour.

20

200220240260280300320340360380400105106107TimeAggregate Debt  MEABM200220240260280300320340360380400−0.200.20.40.60.81Timen1  MEABM