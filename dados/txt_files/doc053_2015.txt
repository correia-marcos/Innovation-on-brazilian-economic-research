  The dynamics of leverage in a demand-driven model with
                    heterogeneous firms∗
                                      Laura Carvalho, Corrado Di Guilmi
                               Department of Economics - University of Sao Paulo, Brazil.
                              Business School - University of Technology, Sydney. Australia.




                                                          Abstract
          This paper introduces heterogeneous microeconomic behavior into a demand-driven macroeconomic
      model, in order to study the joint dynamics of leverage, income distribution and economic growth. The
      distinctive feature is in that the aggregation of heterogeneous agents is not only performed numerically, as
      in traditional agent-based models, but also by means of an innovative analytical methodology, originally
      developed in statistical mechanics and recently imported into macroeconomics. By analytically identifying
      the links between firms-level variables and aggregate quantities, the paper contributes toward a reformula-
      tion of the Minskyan formal analysis that explicitly considers the microeconomic factors. The steady-state
      and stability properties of the system also provide additional insights on the role of behavioral and size
      heterogeneity of firms for the stocks of aggregate leverage and capital.

                                                          Resumo
          Este artigo introduz comportamento microeconômico heterogêneo num modelo macroeconômico lid-
      erado pela demanda, com o intuito de estudar a dinâmica conjunta de alavancagem, distribuição de renda
      e crescimento econômico. A característica que distingue o modelo é o fato da agregação de agentes het-
      erogêneos não ser feita somente de forma numérica, como tradicionalmente em modelos "agent-based",
      mas também por meio de uma metodologia analítica inovadora, originalmente desenvolvida em mecânica
      estatística e recentemente importada para a macroeconomia. Através da identificação analítica das conexões
      entre variáveis ao nível da firma e quantidades agregadas, o artigo contribui no sentido de uma reformulação
      da análise formal Minskyana que considera explicitamente fatores microeconômicos. O estado estacionário
      e as propriedades de estabilidade do sistema proveem novas perspectivas sobre o papel da heterogeneidade
      comportamental e de tamanho das firmas para os estoques de capital e alavancagem agregados.


      Keywords: Financial Instability Hypothesis, aggregate demand, leverage, heterogeneous agents
      Palavras-chave: Hipótese da Instabilidade Financeira, demanda agregada, alavancagem, agentes heterogê-
      neos.

      JEL classification: E16, E32, G01
      Área 8 ANPEC: Microeconomia, Métodos Quantitativos e Finanças.
   ∗ We  thank André Diniz for the superb research assistance. Financial support by the Institute for New Economic Thinking is
gratefully acknowledged. The usual disclaimers apply.
    Corresponding author: Corrado Di Guilmi. University of Technology, Sydney - PO Box 123, Broadway, NSW 2007, Australia.

Ph.: +61295147743, Fax: +61295147711. E-mail: corrado.diguilmi@uts.edu.au.
1      Introduction
The 2008 financial turmoil itself, and the process of de-leveraging by the private sector observed in the follow-
ing years, have drawn the attention to the crucial role of credit as a factor leading both to the instability of the
system and to a strengthening of real-financial linkages in the economy. This view, which was central to the
work of Hyman Minsky, is also supported by the vast historical evidence presented in Schularick and Taylor
(2012), which highlights that credit booms tend to be followed by deeper recessions when compared to other
financial crises episodes.
    A formal investigation of these phenomena from a Minskyan standpoint requires the integration of the
financial and economic systems in a demand-driven macroeconomic model. A seminal formalization of a
Minsky crisis generated by self-fulfilling expectations was made by Taylor and O’Connell (1985) using a
Kaleckian model, but without dealing explicitly with the role of debt. An alternative, which has received
renewed attention after the crisis Khalil and Kinsella (2011); Bezemer (2010), builds on the traditions of Tobin
(1969) and Godley and Lavoie (2007) to take into account all flows of income between sectors in the economy,
as well as their accumulation into financial and tangible assets in a Keynesian setup. Besides allowing for
formal Minskyan analyses of corporate debt and financial fragility (Dos Santos, 2005), the so-called Stock-
Flow Consistent (SFC) models have recently been used to study the macroeconomic effects of shareholder
value orientation and financialization (Van Treeck, 2009), household debt accumulation (Kim and Isaac, 2010),
and other related issues.
    The traditional limitation of this type of models, however, is that of dealing with economic behavior only in
aggregative terms, thus excluding the heterogeneity of agents as a source of financial instability. The relevance
of a microeconomic analysis in modeling financial fragility was stressed by Minsky himself1 . It is thus for un-
derstanding the economy as an “out-of-equilibrium” system while allowing for heterogeneous microeconomic
behavior (Delli Gatti et al., 2005, 2010), that the literature based on the so-called agent-based models (ABMs)
has proven to be so useful for the analysis of financial instability. Nevertheless, for using a fully bottom-up
approach, this type of models often lack a clear macroeconomic closure and are hard to connect to other macro
analyses.
    The starting point of this paper is to see agent-based, SFC and, more generally, Keynesian-Kaleckian
macroeconomic approaches as complementary in their understanding of the crucial role of real-financial link-
ages for the instability of the economic system, as well as its macroeconomic dynamics2 . Moreover, we aim
to contribute in filling what we consider to be a weakness in both the SFC and ABM approaches, namely its
full reliance on numerical and computational solutions.3 In order to provide a few analytical insights that will
add to the numerical simulations of the model, we perform an aggregation of heterogeneous agents by means
of an innovative analytical methodology originally developed in statistical mechanics and recently imported
into macroeconomics (see Aoki and Yoshikawa, 2006; Di Guilmi, 2008; Foley, 1994; Weidlich, 2000, among
others). This modeling approach builds from the idea that, as the economy is populated by a very large number
of dissimilar agents, an analytical model cannot keep track of the conditions of every single agent at each point
in time. As Aoki and Yoshikawa (2006) remark: “the point is that precise behavior of each agent is irrele-
vant. Rather we need to recognize that microeconomic behavior is fundamentally stochastic.” Therefore, a
    1 “An ultimate reality in a capitalist economy is the set of interrelated balance sheets among the various units” (Minsky, 2008,
116). Taylor and O’Connell (1985) remark that “shifts of firms among classes as the economy evolves in historical time underlie
much of its cyclical behavior. This detail is rich and illuminating but beyond the reach of mere algebra”.
    2 Such complementarities are clear in Godin and Kinsella (2012), which combines the two approaches in a study of the interaction

of banks and firms in the leverage cycle. A dynamic micro-macro analysis is also developed in the work by Dosi et al. (2013), which
builds an agent-based Keynesian model for the study of interactions between income distribution and monetary and fiscal policies.
    3 The main problem with solving these models only numerically is that model results are usually very sensitive to parameter

configurations, making it very difficult to establish general relationships between macro and micro-variables, as well as causality
links within the system.


                                                                 2
microfounded analytical model should look at how many agents are in a certain condition, rather than at which
agents, and represent their evolution in probabilistic terms. This approach is particularly suitable to microfound
macroeconomic models, since it is able to endogenously derive the macro-equations and the dynamics of flows
from the microeconomic behavioral rules, without imposing ad-hoc constraints.
    Hence, the contributions of this paper are basically three. The first is mainly methodological, and consists
in the integration of the numerical and analytical solutions of an agent-based model, as done, for instance, in
Chiarella and Di Guilmi (2011). Besides helping us open the “black box” of the simulations, the analytical
approach allows for a few generalizations and a better assessment of the role of heterogeneity in levels and
dimensions in relation to a more homogeneous microeconomic setup.
    The second contribution, also methodological, concerns the innovative approach to the microfoundation of
stock-flow consistent modeling. The macro-equations of the aggregate model are here generated endogenously
in a bottom-up approach, starting from the behavioral equation for agents. Consequently, the steady-state
analysis is able to assess the impact of the balance sheet structures of firms on the macroeconomy.
    The third contribution is to explore micro and macroeconomic aspects leading to the emergence of short-
run fluctuations and long-run instability of the economic system. In particular, the paper shows how the diverse
financial structures of firms can determine the evolution of the economy, as stressed in Minsky’s narrative. As
the objective is not to fully represent the behavior of any particular economy over time, but rather to provide a
few methodological and theoretical insights for the analysis of leverage and financial instability, the model we
present is particularly simple and stylized, but it is still able to point toward the usefulness of the method for
more realistic settings.
    The paper will be structured as follows. Section 2 presents the structure of the agent-based model. Results
of the numerical simulations are then illustrated in section 3. Section 4 specifies the dynamics of firms’ transi-
tion between states, as well as the mean-field approximation procedure we use for the analytical solution of the
model. In Section 5, we perform steady-state and stability analyses of the system of differential equations for
the joint evolution of firms’ aggregate leverage and the proportion of firms in different financial states. Section
6 concludes the paper and points toward future developments.


2      The model
The economy described in this paper is composed by firms, households and a financial sector. Following
Kalecki (1971), firms are assumed to set the price as a mark-up on the unit cost of labor, while holding excess
capacity4 . The mark-up, and hence the functional distribution of income between wages and profits, will be
assumed to (exogenously) depend on the degree of industrial concentration and the relative bargaining power
of workers and capitalists in the labor market. The model is demand-driven in nature: output is always below
potential, which allows for investment behavior to be determined independently from savings. The degree of
capacity utilization of firms, which depends on the quantity they sell in each period, will take the adjusting role
for the macroeconomic equilibrium in the goods market.
    Firms are divided into two classes and may switch between them. While hedge firms pay all their interest
out of gross profits, speculative firms’ profits are lower than their financial commitments in the current period
5 . The method proposed in Section 5 will allow the share of firms in each class to affect aggregate leverage

dynamics. There is no microfoundation for the household sector, which is treated as an aggregate for simplicity.
Their income is composed of wages and a component of profits distributed by firms. Households accumulate
their entire stock of wealth in the form of money deposits.
    4 See Rowthorn (1982), Dutt (1984) and Taylor (1985) for early neo–Kaleckian models in this tradition.
    5 Inthe Mynskian terminology, Ponzi agents are distinguished from speculative agents for their income is never sufficient to make
interest payments, requiring new borrowing at every period. This distinction will not be made here for simplification purposes.


                                                                 3
    Finally, the financial sector is also considered as an aggregate: its basic role is to provide loans, hence
holding debt (or firm bonds) as an asset and to create money deposits endogenously as liabilities, while setting
an exogenous interest rate.

2.1        Firms
A single firm is identified by the superscript j, while its state (speculative or hedge) by the subscript z = 1, 2.
Firm level variables are indicated by small letters while aggregate while variables are represented by capital
                                             j
letters. Thus when a variable is written as x1 , it refers to the firm j belonging to state 1. A lower case variable
with only the subscript, x1 , indicates the mean-field value, which, as detailed in section 4 below, is a single
value that replaces the vector of observations in each group. Symbols without superscript or subscript refer to
aggregate variables. The numbers of firms in each group are indicated by N1 and N2 . In a simplification of the
Minskyan terminology, we define two classes of firms, depending on the sign of their retained profits a j , here
defined as the difference between gross profits and interest payments:

    • z = 1: speculative firms, whose gross profits in the current period are less than sufficient to pay interest
      on accumulated debt, requiring a new increase in debt.
                                                                        j
                                                                    at < 0.                                                          (1)

    • z = 2: hedge firms, whose profits in the current period are more than sufficient to pay interest on accu-
      mulated debt.
                                                         j
                                                       at ≥ 0                                               (2)

    The investment function for the firm j is given by6
                                        j          j                           j        j
                                       iz,t = i0 Kz,t−1 + (αz π + β )pqt−1 − λ bt−1                                                  (3)

where q j is the quantity sold by the firm, π is the share of profits in output, p is the final good’s price, b is
the firm’s outstanding debt and i0 , αz , β , λ ≥ 0. This specification is the equivalent in levels to the standard
neo-Kaleckian specification in which the gross percentage change in capital before depreciation is a positive
function of the gross profit rate and the degree of capacity utilization.7 .
     The positive effect of the profit rate on investment decisions can be justified based on two different channels:
(i) it determines the level of internal finance available for investment, and (ii) it gives the return on productive
capital, thus providing an incentive for firms to invest. When it comes to the magnitude of the parameter α,
the formulation recalls the one in Delli Gatti et al. (1993), where the sensitivity to internal finance analytically
devices the Minskyan borrower’s and lender’s risk. Following Fazzari et al. (1988) and Delli Gatti et al. (1993),
we assume that α1 > α2 , that is speculative firms are more sensitive to internal finance as they face the risk of
bankruptcy and change their behavior in order to minimize it.
   6 For
       computational needs, in the multi-agent simulations we consider a sequential economy that evolves in discrete time, and the
model will be presented accordingly.
  7 When technology exhibits fixed coefficients, it is possible to define the potential output only as a function of capital so that


                                                              q̄tj = 1/γ ktj                                                         (4)

where the inverse of capital productivity γ is a constant parameter, which can be normalized to one for simplicity. The degree
of capacity utilization u j of each firm, defined as the ratio of actual output q j sold by the firm to potential output q̄ j can thus be
approximated to the actual output-to-capital ratio u = qk .


                                                                    4
    Investment decisions to expand the available capital stock also respond positively to firms’ sales, as higher
demand and a higher use of the existing capacity cause firms to expand their desired productive capacity and
potential output. Finally, the third term in 3 allows the level of outstanding debt to inhibit investment decisions,
as firms face higher balance sheet constraints. Equation (3) thus involves three factors: a micro-effect (b j ), a
meso-effect (αz ) and a variable combining micro and macro effects (q j ).
    The quantity actually sold by a firm is subject to a preferential attachment shock. Total demand pQ(t) is
determined as the macroeconomic level from aggregate investment and consumption, but its distribution among
firms needs to be identified. We assume that this distribution is partially stochastic. In particular, demand
is allocated based on the relative of size of firms (proxied by their stock of capital), to which a stochastic
idiosyncratic shock s is added. The expected market share of firm j is hence:
                                                                   j
                                                          j      kt
                                                      E[qt ] = Qt ,                                              (5)
                                                                 Kt
where Qt is the total demand, given by the consumption of managers and wage earners, and K represents
the aggregate capital for the whole economy. Defining s̃ as a uniformly distributed stochastic variable with
E[s̃] = 0, we set                                     "       #
                                                            j
                                              j     j     k
                                            st = s̃t 1 − t                                               (6)
                                                         Kt
   in order for ∑N q j = Q. Accordingly the quantity actually sold by the single firm is
                                                        h        i
                                               j      j        j
                                             qt = E[qt ] 1 + st                                                  (7)

   Firms will set prices in oligopolistic markets by applying a mark-up over unit labor costs:
                                                                 w
                                                      p = (1 + µ) .                                              (8)
                                                                 ξ
   where µ is the mark-up rate, w is the nominal wage and ξ = Q/L is labor productivity.
   With µ taken as a parameter, the mark-up rate is constant and the labor share of output Ψ is also given
exogenously from:
                                                    w1       1
                                             Ψ=         =                                               (9)
                                                    pη     1+µ
The gross profit share of aggregate output Π will then be given by
                                                                  µ
                                               Π = 1−Ψ =                                                        (10)
                                                                 1+µ
   As previously described, each firms’ retained profits are computed as the difference between its gross profits
and the net interest it pays on debt, at an exogenous interest rate ī. Since the flow of gross profits is given by a
constant share Π of each firms’ output from the mark-up rule, retained profits can be expressed as:
                                                  j          j     j
                                                at = Πpqt − ī bt−1                                             (11)

    A firm will be assumed to fail if b j /k j ≥ c, where c is set as a positive constant. The probability for a
bankrupted firm of being replaced is modeled as directly proportional to the performance of the economy in
the previous period.
    The increase in the stock of debt in the case of hedge firms will only occur when desired investment i j > a j ,
which requires firms to seek external finance for capital accumulation. Whenever a j > i j , firms will (partially
or totally) repay their stock of debt and distribute any remaining profits to managers.

                                                            5
                                                       j           j           j
   Hence, the law of motion of firms’ bonds when at < it + bt−1 can be written as:
                                                               j           j
                                                  ∆b j = it − at                                             (12)
                j    j    j
   Whenever at ≥ it + bt−1 , the previous stock of debt is entirely repaid, so that
                                                                       j
                                                  ∆b j = −bt−1                                               (13)
                         j     j    j    j
    and the remainder Θt = at − it − bt−1 ≥ 0 is distributed to firms’ managers (households), as will be de-
scribed in subsection 2.2.

2.2   The household sector
As described in the previous subsection, workers earn wages w which add up to a constant share Ψ of total
output Q, and managers receive an amount Θ = ∑ j Θ from firms’ excess profits.
   Households’ total disposable income Y is composed by wage and profit earnings:

                                                Yt = ΨpQt + Θt                                               (14)

   Households’ wealth is accumulated as an effect of savings S in the form of money deposits M,

                                                ∆Wt = ∆Mt = St                                               (15)

    where savings S are defined as the difference between households’ disposable income and consumption
levels St = Yt −Ct .
    Finally, consumption spending will be assumed to be a fixed proportion of disposable income and wealth, as
in standard in SFC models (Godley and Lavoie, 2007). We will further assume that the propensity to consume
out of wages is different (higher) than the propensity to consume out of distributed profits Θ = ∑ j Θ j . The
hypothesis of differential savings among income groups or social classes have been a key feature in neo–
Kaleckian models since Kaldor (1955-1956) and Kalecki (1971).

                               Ct = (1 − sΨ )ΨpQt + (1 − sΠ )Θt + (1 − σ )Wt−1                               (16)

where 0 ≤ sΨ , sΠ , σ < 1 and σ are the propensities to save out of wages, distributed profits and wealth, respec-
tively.

2.3   The financial sector
The financial sector is considered as an aggregate. It gives loans to firms, hence holding bonds as an asset, and
creates money deposits endogenously. It charges an exogenous interest rate ī on bank loans.
    Since money deposits are assumed to earn no interest, net interest payments by firms allow the financial
intermediary to accumulate net worth Ωb according to:

                                                  ∆Ωtb = īBt−1                                              (17)




                                                           6
2.4        Goods market equilibrium
As the model is demand-driven, total output Q adjusts to the sum of aggregate consumption C, from equation
(16), and investment I.
                          pQt = (1 − sΨ )ΨpQt + (1 − sΠ )Θt + (1 − σ )Wt−1 + It
    As it is not possible to establish analytically how many hedge firms fall in the sub-category in which
retained profits are more than sufficient to repay the total stock of debt, and thus the amount of profits that are
distributed to managers, we will assume hereafter that the propensity to consume out of profits is zero (sΠ = 1)
for simplicity.8
    Solving for pQt and substituting Ψ from expression (9) yields
                                                    1+µ
                                           pQt =           [It + (1 − σ )Wt−1 ]                                              (18)
                                                    µ + sΨ
    Section 5 will specify the dynamics of the number of firms in each state Nz , as well as the mean-field
value for each macro-variable within the sub-population of speculative or hedge firms. Using equation (3) and
following this notation, the aggregate level of investment It in (18) can be written as:

                    It = N1 [(α1 Π + β )pq1,t−1 − λ b1,t−1 ] + N2 [(α2 Π + β )pq2,t−1 − λ b2,t−1 ]                           (19)


3      Numerical simulations
We run numerical simulations of the above described agent-based model in Matlab. Figure 1 displays the
simulation results for a single run: a cyclical pattern arises from this simple setup in line with the Minskyan
characterization of the business cycle. In other words, the system goes through periods of debt-fueled booms,
followed by busts triggered by firms’ deleveraging and bankruptcies. During expansions, the share of specu-
lative units increases together with aggregate leverage. At the peak of the cycle, the amount of debt becomes
unsustainable and heavily leveraged firms start reducing investment, while financially distressed speculative
firms default. The decline in aggregate demand only stops when firms’ debt is small enough for investment
to recover. The economy does not display any growth trend, given that technology and labor productivity are
constant.
    Despite the fact that fluctuations are perhaps too regular to be compared with a real economy, the model
mimics the empirically observed pro-cyclicality of business debt and profits, as well as a few other regularities.
First, Monte Carlo replications of the model yield a realistic value of 4 for the ratio between the variance of
investment and the variance of consumption. The autocorrelation coefficients of output and investment are both
equal to 0.89 over 50 Monte Carlo replications, being comparable to estimates in the literature for de-trended
series. Second, the distribution of variations of output from period to period can be well fitted by a Weibull,
in line with the evidence presented in Di Guilmi et al. (2005). Third, the distribution of firms is right-skewed
according to different proxies of their size (capital, debt and profits), as also empirically detected.
    The sensitivity of the agent-based model to parameter configurations was tested by means of Monte Carlo
simulations. The parameters α1 , β , δ , µ, λ and ī are varied within a given interval and for each value we run
1,000 replications, so as to make sure that results are not affected by the particular random seed of a single run.
The intervals of variations we use are: α1 ∈ [0.2, 0.45], β ∈ [0.05, 0.35], δ ∈ [0.025, 0.15], µ ∈ [0.3, 0.7], λ ∈
[0.01, 0.13] and ī ∈ [0.05, 0.3]9 .
    8 Ina more complete model, the distribution of profits to managers could be replaced by share buybacks by firms, for instance,
and would also not enter the determination of aggregate demand.
   9 The other parameters are set as in the benchmark scenario, with the exception of c = 3, which smoothes the cycle without

qualitatively affecting the results.


                                                                7
    Results of Monte Carlo simulations for α1 (figure 2a) allow for a numerical assessment of the role of
behavioral heterogeneity, considering equation (3) and the fact that α2 is kept constant at 0.2. Not surprisingly,
an increase in α1 , the sensitivity of speculative firms’ investment to internal funds, reduces the degree of
financial fragility of the system, as it lowers the share of speculative firms and the debt-to-GDP ratio. However
the debt-to-capital ratio is slightly increasing in α1 for both speculative and hedge firms, and hence in aggregate
terms, implying that the rate of accumulation of debt is faster than the accumulation of capital in these scenarios.
Similar results are obtained from an increase in β , the sensitivity of investment to demand, but in this case the
increase in the aggregate debt-to-capital ratio is more dramatic, due to the rise in speculative firms’ leverage.
    The results for a raise in the interest rate ī (Figure 2b) show that a higher rate raises the bankruptcy ratio
and, consequently, increases aggregate demand, while slowing down the accumulation of debt. This puzzling
result can be explained both through the lower negative component in the investment function (3), due to
lower debt in the system, and through the higher share of speculative firms, which have a higher sensitivity to
internal resources and therefore are expected to invest more, ceteris paribus. At a first sight, the results seem to
support a lean-against-the-wind type of policy, but only if one neglects the increase in volatility and the higher
frequency and magnitude of fluctuations that are generated in the system.
    In order to test the role of the firms’ demography in determining this result, we run a different set of Monte
Carlo simulations in which the maximum debt-to-capital ratio is increased to c = 25, so that all bankrupted
firms are immediately replaced by new ones10 . In this setting, aggregate debt and the debt-to-capital ratio
are increasing in ī and almost all firms are speculative. Hence, results for aggregate demand and the debt-to-
output ratio can thus be seen as consequence of the assumption of a constant number of firms N throughout the
simulations.
    An increase in λ implies a greater sensitivity of firms’ investment to their outstanding debt, or a higher
degree of risk-aversion. Debt and debt-to-capital ratios are lower for higher λ (figure also available upon
request), while debt-to-output ratios increase, due the lower level of aggregate demand.
    An increase in the profit share of output, as generated by a larger mark-up µ, reduces aggregate demand,
aggregate leverage and the proportion of speculative firms in the economy. These firms display a higher aver-
age debt-to-output ratio, but a lower debt-to-capital ratio, as they invest more due to higher profits, but sell less
due to lower aggregate demand. At the aggregate level, however, the increase in profits more than compensates
for the decline in aggregate demand, leading to lower aggregate leverage. The lower level of aggregate de-
mand also inhibits investment decisions, partially offsetting the positive effect of higher profitability on capital
accumulation. Overall, the debt-to-capital ratio decreases both for speculative firms and at the aggregate level.
    Finally, a higher rate of depreciation of capital has a proportionally larger impact on debt, via bankruptcy,
than on capital and demand, causing a reduction in the overall leverage. In contrast, the debt-to-capital ratio of
speculative firms is increasing in δ .11


4       Firms’ dynamics
As illustrated in sections 1 and 2, the analytical solution method adopted by this paper operates through a
reduction in the heterogeneity by grouping the agents into clusters. In order to study the stochastic evolution
of the system analytically we use a mean-field approximation, which essentially involves reducing the vector
of observations of a variable to a single value for a given population (Brock and Durlauf, 2001). In the present
    10 Thesimulations without changes in firms’ demography will also permit a consistent comparison with the analytical solution,
which does not explicitly consider bankruptcy, in section 5. Figures displaying results for this last scenario were not shown for space
constraints but are available upon request.
  11 Last two figures available upon request.




                                                                  8
treatment, the mean-field approximation is performed by simply taking the average of the relevant micro-
variables within each group.
    The following step is presented in subsection 4.1 and concerns the definition of the probabilistic rules that
determine the switch of firms between groups. The dynamics of the number of agents in each cluster is assumed
to follow a Markovian stochastic process. This class of processes can be described by a master equation, namely
a stochastic differential equation that depends on the probabilities of transition between states. The main steps
of this procedure and the solution of the master equation are presented is subsection 4.2. In particular, this
solution can be expressed by an ordinary differential equation plus a stochastic component given by a Wiener
process. Both the ordinary differential equation and the noise term are formulated as functions of the micro-
variables that determine the transition of agents between groups. This result is then used in section 5 for the
derivation of the laws of motion of relevant macroeconomic variables.
    As for the notation, since the population of firms is reduced to just two (one average hedge firm and one
average borrowing firm), the superscript j is no longer used for firm-level variables.

4.1    Transition probabilities
The probability of a single firm changing state can be derived using (1) or (2). In particular, a hedge firm turns
to speculative if its net profit becomes negative according to condition (1), while a speculative firm becomes
hedge if it earns a positive net profit, based on condition (2). The magnitude of each firms’ net profit depends on
the idiosyncratic shock s, which determines the quantity they sell. As the distribution of the shock s is known
by assumption, it is convenient to quantify the probabilities of transition as function of s. Let us preliminarily
define the variable Γz as                                       
                                                     īt bz,t         Kt
                                            Γz,t =            −1                                               (20)
                                                     Πpqz,t        Kt − kz,t
   Using equations (1), (2), (7) and (11), it follows that a speculative firm j becomes hedge and hedge firms
becomes speculative if, respectively
                                            j                 j
                                          st ≥ Γ1,t and st < Γ2,t
The first probability will be denoted by η and the second by ζ . Accordingly, we can write
                                    j                          j
                                  ηt = Pr[st ≥ Γ1,t ] and ζt = Pr[st < Γ2,t ]

Assuming s to be uniformly distributed in the interval [−0.5, 0.5], we are able to quantify the two probabilities
using the cumulative distribution function of s, so that:

                                                 ηt = 0.5 − Γ1,t                                              (21)


                                                 ζt = 0.5 + Γ2,t                                              (22)

4.2    Solution to the master equation: stochastic dynamics of trend and fluctuations
If we assume that the number of firms in each of the two states follows a jump Markov process, we can use the
master equation to describe the stochastic evolution of the system. Taking N1 as our state variable, the master
equation allows us to represent the dynamics of the probability of a certain number of firms N1 being in state
1 as the balance equation between the aggregate transition to and from state 1. Considering an interval of time



                                                        9
∆t small enough to be approximated by a continuous time representation, we can express the master equation
for the dynamics of firms in state 1 as

                   dP(n1 ,t)
                             = η(t)P(n1 − 1/N)(t) + ζ (t)P(n1 + 1/N)(t) + [η(t) + ζ (t)] P(n1 )(t)                                (23)
                     dt
where n1 = N1 /N.
    Equation (23) describes the dynamics of the probability of having a fraction n1 of speculative firm as
the sum of the probability of transitioning from a number N1 − 1 to N1 and the probability of transitioning
from a number N1 + 1 to N1 , less the probability of already having a number N1 of speculative firm times
the probability of a transition into or from the speculative state. The master equation can be solved using
approximation techniques12, . For this algorithm to be applied, the state variable must be split into trend and
cyclical components. Following Aoki (2002) and indicating, respectively, with n̄1 the deterministic trend and v
the deviation, the state variable can be reformulated as

                                                         n1 = φ + N −1/2 v                                                        (24)

so as to normalize the standard deviation v.The development of the solution algorithm yields the following
ODE for the trend
                                            φ̇ = ζ φ − (η + ζ )φ 2                                    (25)
The stationary solution of the second equation presumes a Gaussian distribution for the stochastic noise around
the trend, so that:
                                                             v2
                                                               
                                            P(v) = C exp − 2                                                (26)
                                                            2σ
such that P(v) ∼ N (0, (η+ζ
                         ηζ
                            )2
                               ) The dynamics of n1 can thus be described by

                                              ṅ1 (t) = ζ φ − (η + ζ )φ 2 + σ dV (t)                                              (27)

where dV is a stationary Wiener increment and σ dV is the stochastic fluctuation component in the proportion
of speculative firms, coming from the distribution (26).
     The solution of the master equation provides a good approximation for the underlying agent-based model
despite the reduction in heterogeneity. Figure 3 shows the results for the share of speculative firms, obtained
for the master equation solution by using the results of the simulations of the agent based model in equation
(27), and the level of aggregate debt obtained from the product of the mean-field values of firms’ debt b1 and
bn and the corresponding number of firms. The proportion n1 is weighted by the number of surviving firms,
so as to take into account the effect of bankruptcy13 . Without bankruptcy, the two series move together during
expansions while, during recessions, the master equation solution n1 does not drop until the cycle is very close
to its trough. Having tested the reliability of the analytical solution, we can now use it to gain further insights
into the behavior of the model.
  12 The solution algorithm introduced by Aoki (2002) and further developed by Landini and Uberti (2008) and Di Guilmi (2008), has

the advantage of returning a solution that is composed by two equations: an ordinary differential equation, which describes the time
evolution of the trend of the stochastic process, and a partial differential equation (known as Fokker-Planck equation), whose general
solution identifies the probability distribution of the fluctuations around the drift component. The full derivation of the solution is
omitted here. We refer the interested reader to Di Guilmi (2008) and Chiarella and Di Guilmi (2011).
   13 Di Guilmi et al. (2012) proposes and uses a solution method for the master equation for a system with a variable number of agents.

Given the considerable analytical complexity of that treatment and the scope of the present paper we adopted the simplification of
considering N fixed and consider this difference in the comparison of the numerical and analytical treatment.



                                                                  10
5       Analytical solution
This section presents an analytical assessment of the links between debt dynamics at the micro and macro levels.
In particular, it highlights the role of firms’ heterogeneity for the dynamics of aggregate debt and leverage.
    We will thus start by studying separately the evolution of the stock of debt held by speculative and hedge
firms, before proceeding to a macro analysis. The results of the analysis are also compared with the outcomes
of the Monte Carlo simulations, yielding further insights on the causal relationships determining the dynamics
of the model.14

5.1         Debt dynamics
In this subsection we focus on the joint dynamics of b1 , b2 and N1 , looking first at the steady state values and
then at the conditions for stability.

5.1.1        Steady-state analysis
Proposition 1. At the steady-state where ḃ1 = ḃ2 = 0, the mean-field debt-to-output ratio of speculative firms
                                              b˜1    b˜2
is higher than that of hedge firms. Formally: pq 1
                                                   > pq 2
                                                          .

Proposition 2. At the equilibrium where ḃ1 = ḃ2 = Ṅ1 = 0, which constitutes a steady-state for the aggregate
level of debt B, the number of speculative firms Ñ1 is the higher, the lower is α1 , the sensitivity of speculative
firms’ investment to profits. The direction of the response of Ñ1 to parameters ī, α2 , β , λ and Π depends on the
specific parametric configuration.
Proposition 3. At the equilibrium where ḃ1 = ḃ2 = Ṅ1 = 0, the steady-state value of aggregate debt B̃ is the
higher, the higher is, ceteris paribus, the degree of heterogeneity between the two subgroups of firms as for
the sensitivity of investment to profits (α1 − α2 ), while, for α1 = α2 , it is unaffected by the difference in the
magnitude of output, or firms’ size, (q1 − q2 ).
    The results of the steady state analysis generally match the outcomes of numerical simulations previously
                                                  b1      b2
described 15 . In fact, in all the simulations pq   1
                                                      > pq  2
                                                              as for proposition 1. The analytical approximation
of the agent-based model reveals that this regularity is emerging due to behavioral heterogeneity (α1 > α2 ).
Proposition 2 proves that the inverse correlation between α1 and N1 showed in figure 2a is independent of
the parameter configuration, while the patterns that emerge in the Monte Carlo simulations for ī, β and λ
have relied on a particular parameter setting. Even with a number of different Monte Carlo simulations using
different parameter settings, the full reliance on numerical solutions would not be sufficient to provide this
kind of certainty. Finally, given that α2 is constant in the Monte Carlo simulations, Proposition 3 illustrates the
causal relationship through which the model generates the direct correlation between α1 and aggregate debt
displayed by figure 2a. The second statement of proposition 3 stresses the role of behavioral heterogeneity
relative to size heterogeneity for the outcome of the simulations. Again, this is a result that could not be
achieved with the sole numerical analysis, given the impossibility of forcing size homogeneity across firms.
    Summing up, the level of heterogeneity in the elasticity of the investment function to internal finance
appears to be crucial for the long run dynamics of the economy. For a given level of α2 , a larger α1 implies
not only a larger difference in the leverage ratio of the two types of firms but also a greater stock of aggregate
debt. Speculative firms invest more and, consequently, resort to credit. At the same time, a larger α1 reduces
the steady-state level of the number of speculative firms. Given that B = N1 b1 + N2 b2 , the effect is larger on
    14 Proofs    are sketched in the appendix. Complete proofs are available upon request.
    15 In   the present analysis, we consider the outcome of the Monte Carlo simulations as an approximation of the steady state.


                                                                     11
b1 than on N1 . The decrease in N1 can be explained from the fact that speculative firms rely more on internal
finance for capital accumulation, which also raises their chances of becoming hedge.

5.1.2     Stability analysis
In this subsection we will focus on the joint stability of b1 and N1 around the steady-state, given the more
crucial role of speculative firms’ leverage for the financial stability of the system as a whole, from a Minskyan
standpoint. A stability analysis for hedge firms, or b2 and N2 , can be derived in similar fashion. This study
provides additional qualitative insights on the results of the Monte Carlo simulations.
    The analysis will be based on the system of differential equations composed by expressions (37) and (34).

Proposition 4. The interest rate ī has an ambiguous effect on the stability of the dynamical system16 .

    The uncertainty about the effect of the interest rate is a consequence of the different role it has on the
dynamics of the number of speculative firms and on their individual level of debt. On the one hand, a higher
interest rate increases the number of speculative firms through its effect profits in equation (11). Due to the
logistic functional form of the dynamics of speculative firms (27), as the level of N1 increases, its rate of growth
decelerates, such that ∂∂ Ṅ1
                          N < 0. On the other hand, the interest rate positively affects ḃ1 , through its negative
                               1

effect on retained profits. As a consequence ∂∂ ḃb1 responds positively to ī. The two effects are embodied in the
                                                   1
expression for the trace of the system’s Jacobian matrix, as analyzed below.
Proof. After deriving the Jacobian of the system (Ṅ1 , ḃ1 ) from expressions (37) and (34) and evaluating it at
the steady-state, the trace of J is thus given by:

                                                                    ī b2
                                                 Tr(J) = 0.5 −            − (λ − ī)
                                                                    Π pq2
    By further substituting for the steady-state of b2 from (36), we have that in the vicinity of the steady-state
for total debt B analyzed in the previous subsection, the trace is:

                                                             ī (α2 − 1)Π + β
                                          Tr(J) = 0.5 −                       − (λ − ī)
                                                             Π      λ − ī
    The system is hence unstable whenever the following expression holds:

                                                ī (α2 − 1)Π + β
                                                                 + (λ − ī) > 0.5                                                   (28)
                                                Π      λ − ī
    Debt instability for speculative firms is thus more likely when the profit share Π is high, and the response
of hedge firms’ investment to profits and demand, α2 and β , respectively, are low. The effect of the interest rate
on debt stability depends on parameter configurations.                                                           

Proposition 5. Given the constraints on the parameters, the steady states for ḃ1 and Ṅ1 are most likely on a
saddle path.
  16 We  numerically assess the effect of the interest rate on the stability of the system for the following values and ranges of param-
eters: α2 = 0.2, β = 0.5, λ ∈ [0.15, 0.35], Π ∈ [0.3, 0.5], ī ∈ [0.05, 0.1]. The stabilizing effect coming from a lower Ṅ1 appears to
dominate the destabilizing effect of an increase in the average debt of speculative firms, such that a larger interest rate makes a stable
trajectory more likely. In particular, as shown by figure 4a, for λ = 0.15, ī > 0.8, Π = 0.5 the determinant becomes positive. A lower
λ increases N1 , thus reducing Ṅ1 , due to the logistic functional form of (27). Figure 4b illustrates that the determinant is also more
likely to be positive for low values of Π. In particular we verified it is always positive for λ = 0.35, ī > 0.5, Π = 0.3. Thus, a higher
profit share negatively affects the stability of the system Ṅ1 , ḃ1 .


                                                                   12
    Proof. After a few algebraic simplifications, the determinant of J can be written as:

                                                                        β    (λ − ī)
                                              Det(J) = ī(α2 − 1 +        )−
                                                                        Π      2Π
    The case of saddle-path (in)stability is thus obtained whenever the interest rate is sufficiently low17 and the
term in the right and side of expression (29), which increases with the sensitivity of investment to debt λ , and
decreases with the profit share Π, the sensitivity of hedge firms’ investment to profits α2 , and the response of
investment to output, β .
                                                           λ
                                             ī <                                                              (29)
                                                  2Π(α2 − 1) + 2β + 1
                                                                                                                                    

    Propositions 4 and 5 complete the study of the sensitivity of the system to parameters, identifying ranges of
stability. Again, a numerical approach could only lead to this type of interpretation through multiple attempts,
by reporting for example the values of the parameters for which the simulation crashes or returns inconsistent
results, without any possibility of generalization.

5.2       Dynamics of capital and the leverage ratio
With 0 < δ < 1 as the rate of capital depreciation and investment from (19), the law of motion for speculative
firm’s capital stock k̇1 , in value, can be expressed as:

                                       pk̇1 (t) = (α1 Π + β )pq1 (t) − λ b1 (t) − pδ k1 (t)                                      (30)

    Consequently, k1 reaches the steady state at:
                                                           (α1 Π + β )pq1 − λ b1
                                                  pk̃1 =                                                                         (31)
                                                                     δ
Proposition 6. At the steady-state for both b1 and k1 , the leverage ratio for the speculative firm, b̃1 /(pk̃1 ), is
the higher, (i) the higher is the interest rate ī, (ii) the higher is the depreciation rate δ , (iii) the lower is the
sensitivity of investment to leverage λ , (iv) the higher is the sensitivity of investment to profits α1 , (v) the higher
is the sensitivity of investment to output β , and (vi) the lower is the profit share Π.
    Proof. By expressing pq1 as a function of b̃1 and substituting in (31), we obtain the steady-state leverage
ratio for the speculative firm18 :
                                          b̃1     δ (α1 + β /Π − 1)
                                               =                                                           (32)
                                          pk̃1    λ − ī(α1 + β /Π)
                                                                                                                                    
Proposition 7. At the steady-state for b1 , b2 , k1 and k2 , the leverage ratio of speculative firms is higher than
that of hedge firms. Formally:
                                                     b̃1     b̃2
                                                          >
                                                     pk̃1    pk̃2
  17 In the benchmark scenario of the simulations the interest rate is in the stability range, not satisfying conditions (28) and (29).
  18 Proposition  6 also expresses some of the results of the Monte Carlo simulation, and demonstrates that these outcomes do not
rely on specific parameter configurations. Given that the analytical solution does not consider bankruptcy of firms, the relevant plot
for this comparison is not the one showed in the appendix.


                                                                 13
    Proof. Analogously, the steady-state leverage ratio for hedge firms is given by:
                                               b̃2    δ (α2 + β /Π − 1)
                                                    =                                                                (33)
                                               pk̃2   λ − ī(α2 + β /Π)
    Proposition 7 hence follows from comparing equation (32) to (33), on the assumption that α1 > α2 .                 
Proposition 8. At the steady-state where k̇1 = k̇2 = ḃ1 = ḃ2 = Ṅ1 = 0, the steady-state level of aggregate capital
stock K̃ decreases with firms’ heterogeneity in the sensitivity of investment to profits (α1 − α2 ), but is unaffected
by the heterogeneity in firms’ size (q1 − q2 ).
    Proposition 8 integrates the results of the Monte Carlo simulations by separately studying the role of het-
erogeneity in, respectively, behavior and size, and confirm the stronger relevance of the former in shaping the
long-run dynamics of the system. Interestingly, results for α1 − α2 are not consistent with the numerical simu-
lations, which implies that the result of proposition 8 cannot be generalized to the case in which heterogeneity
in size is present. From this perspective the Monte Carlo simulations and the analytical solution can be seen as
complementary for the understanding of the role of heterogeneity.
Proposition 9. At the steady-state where k̇1 = k̇2 = ḃ1 = ḃ2 = Ṅ1 = 0, the aggregate leverage ratio B̃/(pK̃) is
the higher, (i) the higher is the interest rate ī, (ii) the lower is the response of investment to debt λ , and (iii) the
higher is the degree of heterogeneity in the response of investment to profits α1 − α2 , while it is unaffected by
the heterogeneity in firms’ size q1 − q2 .
     Given α2 , a higher α1 reduces the accumulation of capital and, consistently with the results of proposition
3, increases the aggregate leverage ratio. This is a consequence of the larger reliance of capital accumulation on
the less financially sound firms. Proposition 9 confirms the results of the Monte Carlo simulations for α1 and
ī, which do not depend on the parameter configuration. The analysis points to the role of behavioral variables,
and in particular to the sensitivity of investment to internal finance and debt, as the key drivers of the system
along a more sustainable long-run path. The statements of proposition 9 are consistent with figures 2a, 2b and
??, thus suggesting that point (iii) of the proposition holds also with size heterogeneity.
     The results of this subsection, when taken together with the stability analysis of the system, help illuminate
the implications of the Monte Carlo simulations for the role of the interest rate. It becomes clear that the
handling of the interest rate ī can have perverse effects on the system dynamics by accelerating the accumulation
of debt and, over a certain threshold, can lead the system to instability. Consequently, a lean-against-the-wind
policy can add to the fragility of the system and does not represent an ideal tool to halt a speculative boom.


6    Concluding remarks
This paper introduces microeconomic foundations into a demand-driven macroeconomic model in order to
study the role of real-financial linkages in generating economic growth and business cycles endogenously.
The paper shows that the analysis of systemic financial fragility is greatly enriched by the introduction of
heterogeneous microeconomic behavior, in line with Minky’s approach. To this aim, the model was initially
built in a bottom-up fashion and solved numerically with full heterogeneity of agents. An aggregation method
imported from statistical mechanics then helped us reduce the degree of heterogeneity between firms to only
two classes – inspired by Minsky’s terminology of hedge and speculative financial behavior – thus allowing for
the study of the relationship between micro behavioral rules and macroeconomic dynamics of firms’ leverage
and capital.
    The analytical study has added to the results of the numerical simulations in at least four different ways.
First, it demonstrates which results from the Monte Carlo simulations can be generalized, and which ones rely

                                                           14
on particular parametric configurations. Second, it illuminates the causal relationships that lead to the observed
effects of changing parameters on the macro variables in the simulations. Third, it allowed for a systematic
study of stability conditions that cannot be performed in non-trivial agent-based models. Fourth, it permits ex-
periments that are not possible in simple numerical simulations, such as examining the role of heterogeneity of
agents along a specific dimension, while keeping other dimensions homogenous. The analytical representation
of the stability conditions and causal chain within the model can also assist in the calibration the numerical
simulations, by identifying parameter ranges in which the model is unstable or yields inconsistent results.
    With reference to the specific results of this model, the analysis shows that a higher difference in the re-
sponse of firms’ investment to internal finance between speculative and hedge firms pushes the system along
a long-run path characterized by higher leverage and lower capital accumulation. In fact, a larger difference
α1 − α2 implies that growth relies more on speculative firms and therefore on borrowing. In terms of policy
indications, the analysis shows that a higher interest rate on loans is likely to have a stabilizing role, but at the
price of a higher share of speculative firms with a high leverage ratio in the economy. It is worth noting that
a higher sensitivity of speculative firms to internal finance leads, ceteris paribus, to a larger accumulation of
debt at micro and macro-level. The increase in external financing appears to offset the benefit of a more con-
servative attitude of speculative firms. In terms of income distribution, a larger share of profit has a potentially
destabilizing effect on the dynamics of the system.
    The integration of Monte Carlo simulations with the analysis of the dynamical system derived from this
analytical approximation of the agent-based model represents an absolute primer in the literature, and we hope
that it will pave the way for a different modeling approach. While at this stage of developments, numerical
simulations are still essential for a complete analysis of model outcomes, especially due to nonlinearities in the
system, the proposed analytical solution provides a benchmark for interpreting and generalizing these results.
Besides the introduction of a multi-state master equation, which can provide a more accurate approximation
of the underlying agent-based model, a possible further development concerns a more refined study of the
conditions under which bubbles and busts are generated in the present setting. When it comes to adding more
realistic features to the model setup, possible extensions include, for instance, incorporating a stock market,
endogenizing the mark-up rate and the functional distribution of income, as well as allowing for heterogeneity
in the household and/or financial sector.


References
AOKI , M. (2002): Modeling aggregate behaviour and fluctuations in economics., Cambridge University Press.

AOKI , M. and YOSHIKAWA , H. (2006): Reconstructing Macroeconomics, Cambridge University Press.

B EZEMER , D. J. (2010): Understanding Financial Crisis Through Accounting Models, Accounting, Organiza-
  tions and Society, 35(7): pp. 676 – 688.

B ROCK , W. A. and D URLAUF, S. N. (2001): Discrete Choice with Social Interactions, Review of Economic
  Studies, 68(2): pp. 235–60.

C HIARELLA , C. and D I G UILMI , C. (2011): The Financial Instability Hypothesis: A Stochastic Microfoun-
  dation Framework, Journal of Economic Dynamics and Control, 35(8): pp. 1151 – 1171.

D ELLI G ATTI , D., D I G UILMI , C., G AFFEO , E., G IULIONI , G., G ALLEGATI , M. and PALESTRINI , A.
  (2005): A New Approach to Business Fluctuations: Heterogeneous Interacting Agents, Scaling Laws and
  Financial Fragility, Journal of Economic Behavior and Organization, 56(4): pp. 489–512.


                                                         15
D ELLI G ATTI , D., G AFFEO , E. and G ALLEGATI , M. (2010): Complex Agent-Based Macroeconomics:
  a Manifesto for a New Paradigm, Journal of Economic Interaction and Coordination, 5: pp. 111–135,
  10.1007/s11403-010-0064-8.

D ELLI G ATTI , D., G ALLEGATI , M. and G ARDINI , L. (1993): Investment Confidence, Corporate Debt and
  Income Fluctuations, Journal of Economic Behavior & Organization, 22(2): pp. 161–187.

D I G UILMI , C. (2008): The generation of business fluctuations: financial fragility and mean-field interaction,
   Peter Lang Publishing Group: Frankfurt/M.

D I G UILMI , C., G AFFEO , E., G ALLEGATI , M. and PALESTRINI , A. (2005): International Evidence on Busi-
   ness Cycle Magnitude Dependence: An Analysis of 16 Industrialized Countries, 1881-2000, International
   Journal of Applied Econometrics and Quantitative Studies, Euro-American Association of Economic Devel-
   opment, 2(1): pp. 5–16.

D I G UILMI , C., G ALLEGATI , M., L ANDINI , S. and S TIGLITZ , J. E. (2012): Dynamic Aggregation of Het-
   erogeneous Interacting Agents and Network: An Analytical Solution for Agent Based Models, Tech. rep.,
   mimeo, URL http://www2.gsb.columbia.edu/faculty/jstiglitz/topics.cfm.

D OS S ANTOS , C. H. (2005): A Stock-Flow Consistent General Framework for Formal Minskyan Analyses of
  Closed Economies, Journal of Post Keynesian Economics, 27(4): pp. 712–735.

D OSI , G., FAGIOLO , G., NAPOLETANO , M. and ROVENTINI , A. (2013): Income distribution, credit and
  fiscal policies in an agent-based Keynesian model, Journal of Economic Dynamics and Control, 37(8): pp.
  1598–1625.

D UTT, A. K. (1984): Stagnation, income distribution and monopoly power, Cambridge Journal of Economics,
  8(1): pp. 25–40.

FAZZARI , S. M., H UBBARD , G. and P ETERSEN , B. C. (1988): Financing Costraints and Corporate Invest-
  ments, Brookings Papers on Economic Activity, (1): pp. 141–195.

F OLEY, D. K. (1994): A Statistical Equilibrium Theory of Markets, Journal of Economic Theory, 62(2): pp.
   321–345.

G ODIN , A. and K INSELLA , S. (2012): Leverage, liquidity and crisis: A simulation study, ASSRU Discussion
  Papers 1205, ASSRU - Algorithmic Social Science Research Unit.

G ODLEY, W. and L AVOIE , M. (2007): Monetary Economics: an integrated approach to credit, money, income,
  production and wealth, Palgrave Macmillan: London.

K ALECKI , M. (1971): Selected Essays on the Dynamics of the Capitalist Economy, Cambridge University
  Press.

K HALIL , S. and K INSELLA , S. (2011): Bad Banks Choking Good Banks: a Simulating Balance Sheet Conta-
  gion, Working Papers 201126, Geary Institute, University College Dublin.

K IM , Y. and I SAAC , A. (2010): The Macrodyamics of Household Debt, Working Papers 1010, Trinity College,
   Department of Economics.

L ANDINI , S. and U BERTI , M. (2008): A Statistical Mechanics View of Macro-dynamics in Economics, Com-
  putational Economics, 32(1): pp. 121–146.

                                                       16
M INSKY, H. P. (2008): John Maynard Keynes, McGraw-Hill, first edition 1975.
ROWTHORN , R. (1982): Demand, Real Wages and Economic Growth, Studi Economici, 18: pp. 3–53.
S CHULARICK , M. and TAYLOR , A. M. (2012): Credit Booms Gone Bust: Monetary Policy, Leverage Cycles,
   and Financial Crises, 1870-2008, American Economic Review, 102(2): pp. 1029–61.
TAYLOR , L. (1985): A Stagnationist Model of Economic Growth, Cambridge Journal of Economics, 9(4): pp.
  383–403.
TAYLOR , L. and O’C ONNELL , S. A. (1985): A Minsky Crisis, The Quarterly Journal of Economics, 100(5):
  pp. 871–85.
T OBIN , J. (1969): A General Equilibrium Approach to Monetary Theory, Journal of Money, Credit and Bank-
  ing, 1(1): pp. 15–29.
VAN T REECK , T. (2009): A Synthetic, Stock-Flow Consistent Macroeconomic Model of ’Financialisation’,
 Cambridge Journal of Economics, 33: pp. 467–493.
W EIDLICH , W. (2000): Sociodynamics: A Systematic Approach to Mathematical Modelling in the Social
 Sciences, Gordon and Breach: London.


A      Sketch of the proofs.
Proof of Proposition 1. Using the law of motion (12) and substituting for i and a from (3) and (11), the
evolution of the mean-field level of debt for speculative firms is given by
                                       ḃ1 (t) = [(α1 − 1)Π + β ]pq1 (t) − (λ − ī)b1 (t)                                        (34)
    At the steady-state, the debt-to-output ratio for speculative firms is thus:
                                             ˜ 
                                               b1       (α1 − 1)Π + β
                                                     =                                                                           (35)
                                              pq1            λ − ī
    Analogously, for hedge firms, the steady-state value for the debt-to-output ratio is given by19 :
                                          ˜ 
                                            b2        (α2 − 1)Π + β
                                                   =                                                          (36)
                                           pq2             λ − ī
    Since we have considered that speculative firms are more sensitive than hedge firms to their profit rate
when deciding to invest, namely that α1 > α2 , the equilibrium debt-to-output ratio is also higher for the former
category.                                                                                                       

    Proof of Proposition 2. Using the law of motion for the number of speculative firms20 (27) and substituting
for η and ζ using expressions (21), (22) and (20), we get:
                                                                                        
                                      ī b2 (t)                ī   b2 (t)   b1 (t)          2
               Ṅ1 (t) = N   −0.5 +               N1 (t) − 1 +             +           N1 (t)              (37)
                                      Π pq2 (t)                Π pq2 (t) pq1 (t)
  19 The correspondence between the two cases only holds because the steady-state value for hedge firms for which debt evolved
according to the alternative law of motion (13) is zero.
  20 The stochastic noise is not considered in the present analysis since its expected value is null. The term    Kt
                                                                                                               Kt −kz,t that appears in
equation (20) can be considered equal to 1 for a large number of firms N and can be thus be omitted.


                                                                 17
   The number of speculative firms is constant when Ṅ1 = 0, which yields the steady-state, already using (35)
and (36):
                                                               β
                                                − λ2 + ī(α2 + Π − 12 )
                                      Ñ1 = N                    β
                                                                                                          (38)
                                              λ + ī(α2 + α1 + 2 Π − 3)
    The number for speculative firms hence depends ambiguously on the interest rate on loans and the debt-to-
output ratios of hedge firms, while it decreases with the level of the debt-to-output ratio of speculative firms. As
the total number of firms N is fixed, the steady-state value for the number of hedge firms is Ñ2 = N − Ñ1 . Hence,
in the equilibrium where N1 , b1 and b2 are constant, the total stock of firms’ debt B is also constant21 .       

    Proof of Proposition 3.

                                             B̃ = Ñ1 b̃1 + (N − Ñ1 )b˜2 = Ñ1 (b̃1 − b̃2 ) + N b˜2

    By substituting b̃1 and b̃2 :
                               Πp                                                                         
                       B̃ =          Ñ1 [(α1 q1 − α2 q2 ) + (β /Π − 1) (q1 − q2 )] + N (α2 − 1 + β /Π) q2          (39)
                              λ − ī
   where Ñ1 is only as a function of parameters, as expressed in (38).
   From (39), the steady-state value of aggregate debt in the special case of full homogeneity between sub-
groups of firms in both (i) the sensitivity of investment to profits (α = α1 = α2 ), and (ii) firms’ size (k = k1 = k2 ),
which from (6) and (7) is equivalent to assuming the same output q = q1 = q2 , would be given by:
                                                                      [(α − 1)Π + β ]pQ
                                                       B̃(α, q) =
                                                                             λ − ī
    Assuming that firms have the same sensitivity of investment to profits (α = α1 = α2 ), but are heterogeneous
in size (q1 6= q2 ), and, respectively, assuming that firms have the same size (q = q1 = q2 ) but are heterogeneous
in the sensitivity of investment to profits (α1 6= α2 ), we get:

                          [(α − 1)Π + β ]pQ                                               Ñ1 Πpq(α1 − α2 )
        B̃(α, q1 , q2 ) =                     = B̃(α, q) and B̃(α1 , α2 , q) = B̃(α, q) +
                                 λ − ī                                                         λ − ī
     It is thus clear that the higher is heterogeneity in investment behavior, namely the higher is α1 relative to
α2 , the higher is aggregate debt.                                                                              

    Proof of Proposition 8. The aggregate level of capital K reaches a steady-state level K̃ given by:

                                                            K̃ = Ñ1 (k̃1 − k̃2 ) + N k̃2                           (40)

    By substituting k̃1 , b̃1 and k̃2 and b̃2 from the analogous expressions for hedge firms, we obtain:
    • Full homogeneity: if q = q1 = q2 and α = α1 = α2 .
                                                                                   
                                   Π                  β             Π                  β
                   K̃(α, q) =              λ − ī α +      Nq =             λ − ī α +      Q
                               δ (λ − ī)             Π         δ (λ − ī)             Π

       Hence, in the scenario of full homogeneity, the aggregate output-to-capital ratio U = Q/K̃, which as
       previously mentioned can be interpreted as a proxy for the firms’ degree of capacity utilization, would
       respond positively to the sensitivity of investment to both profits (α) and output (β ).
  21 This   is only a sufficient, not a necessary condition, as Ḃ = N1 ḃ1 + Ṅ1 b1 + N2 ḃ2 + Ṅ2 b2 .


                                                                         18
   • Homogeneity in investment behavior: if q1 6= q2 and α = α1 = α2 .
                                                                    
                                                 Π                  β
                           K̃(α, q1 , q2 ) =             λ − ī α +      Q = K̃(α, q)
                                             δ (λ − ī)             Π
   • Homogeneity in investment size: if q = q1 = q2 and α1 6= α2 .
                                                                                  
                                       Π                                          β
                 K̃(α1 , α2 , q) =             Ñ1 [−īq(α1 − α2 )] + λ − ī α2 +     Q
                                   δ (λ − ī)                                     Π
                                                                                                                                                                                                                 

    Proof of Proposition 9. Proposition 9 is a corollary of Propositions 3 and 8. The equilibrium aggregate
leverage ratio is given by:
                                                                                                
                    B̃   δ Ñ1 [(α1 q1 − α2 q2 ) + (β /Π − 1) (q1 − q2 )] + N (α2 − 1 + β /Π) q2
                       =      h                                       i    h             i
                   pK̃               β
                          Ñ1 λ − ī Π   (q1 − q2 ) − ī(α1 q1 − α2 q2 ) + N λ − ī α2 + Πβ
                                                                                               q2

   • Full homogeneity: if q = q1 = q2 and α = α1 = α2 .
                                                                                                                   h            i
                                                                                                                          β
                                                                                                     B̃          δ  (α  + Π − 1)
                                                                                                        (α, q) =              
                                                                                                    pK̃                      β
                                                                                                                  λ − ī α + Π

   • Homogeneity in investment behavior: if q1 6= q2 and α = α1 = α2 .
                                                                                                      B̃                  B̃
                                                                                                         (α, q1 , q2 ) =     (α, q)
                                                                                                     pK̃                 pK̃
   • Homogeneity in size: if q = q1 = q2 and α1 6= α2 .
                                                                                 h                                i
                                                                                                             β
                                                       B̃                      δ   Ñ1 q(α1 − α 2 ) +  α 2 + Π − 1  Q
                                                          (α1 , α2 , q) =                           h                i
                                                      pK̃                 Ñ1 [−īq(α1 − α2 )] + λ − ī α2 + Π  β
                                                                                                                   −1 Q

     Hence, the higher is (α1 − α2 ), the higher is the numerator and the lower is the denominator of the ex-
     pression above.                                                                                       


                                                                                                                               7
                                                                                                                             10
                                                                                                           H
                                                                                                           S
                                                                                                           SH                                                                     1

                                                                                1



                                                                                                                                                                                 0.8
                                                                               0.8
                         4.5
                        10


                                                                                                                                                                                 0.6
                                                                                                                                                              bankruptcy ratio
                                                            shares of firms




                                                                               0.6
         Total demand




                                                                                                                      Debt




                                                                                                                               6
                                                                                                                             10

                                                                               0.4                                                                                               0.4

                         4.4
                        10
                                                                               0.2
                                                                                                                                                                                 0.2



                                                                                0

                                                                                                                                                                                  0

                                                                                                                               5
                                                                              −0.2                                           10
                             200   250   300    350   400                        200   250   300     350        400            200   250   300    350   400                       200   250   300    350   400
                                         Time                                                Time                                          Time                                               Time




       Figure 1: Single run results: aggregate demand, proportion of firms, debt and bankruptcy ratio.




                                                                                                                              19
                    (a) Simulations for α1 .                                                                                                                       (b) Simulations for ī.

                                                          Figure 2: Results of Monte Carlo simulations.


                                            7
                                          10
                                                                                                     ME                                                                                ME
                                                                                                     ABM                                                                               ABM


                                                                                                                             1




                                                                                                                            0.8
                         Aggregate Debt




                                                                                                                            0.6

                                            6
                                                                                                                      n1




                                          10

                                                                                                                            0.4




                                                                                                                            0.2




                                                                                                                             0




                                            5
                                          10                                                                               −0.2
                                            200   220   240   260   280   300    320   340   360   380     400                200   220   240   260   280   300    320   340   360   380     400
                                                                          Time                                                                              Time




Figure 3: Comparison of the results of the agent-based model and the analytical solution for aggregate debt
(upper panel) and share of speculative firms (lower panel).




            (a) Trace and determinant for differ-                                                                                         (b) Trace and determinant for differ-
            ent values of λ and ī.                                                                                                       ent values of Π and ī.

Figure 4: Trace and determinant. The interest rate varies from 0.01 to 0.1 as we move north along each contour.


                                                                                                                 20
