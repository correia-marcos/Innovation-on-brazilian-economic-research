    On some properties of a new asymmetric-based tobit model

                Mário F. Desousa1, Helton Saulo2 , Víctor Leiva3 , Paulo Scalco1
    1
        Faculty of Management, Accounting and Economics, Universidade Federal de Goiás, Brazil
              2
                Institute of Mathematics and Statistics, Universidade Federal de Goiás, Brazil
                  3
                    Faculty of Engineering and Sciences, Universidad Adolfo Ibáñez, Chile


                                              Abstract
            A strong assumption of the standard tobit model is that its errors follow a normal
        distribution. However, not all applications are well modeled by this distribution.
        Some efforts have relaxed the normality assumption by considering more flexible
        distributions such as t and log-alpha-power. Nevertheless, presence of asymmetry
        cannot be described by these flexible distributions. To overcome this problem, we
        propose a tobit model with errors following a Birnbaum-Saunders distribution. We
        discuss some of its properties including maximum likelihood estimators, residuals
        and global and local influence diagnostic tools. As part of a further extension
        of this paper, we leave the following issues. The implementation of Monte Carlo
        simulations to evaluate the performance of both the maximum likelihood estimators
        and residuals, and the application to real data.

        Keywords Birnbaum-Saunders distribution; Diagnostics; Maximum Likelihood
        Estimation; Tobit models.


                                              Resumo
            Um forte pressuposto dos modelos tobit é que os erros seguem uma distri-
        buição normal, mas nem todas as aplicações são modeladas da melhor forma
        com essa distribuição. Esforços no sentido de relaxar a hipótese de normalidade
        consideram distribuições mais flexíveis como a t e a log-alpha-power, contudo
        essas não modelam assimetria. De modo a resolver o problema, propomos um
        modelo tobit basedo na distribuição Birnbaum-Saunders e discutimos algumas de
        suas propriedades, incluindo estimadores de máxima verossimilhança, resíduos
        e ferramentas de diagnóstico de influência global e local. Como parte de uma ex-
        tensão natural desse artigo, deixamos os seguintes problemas. A implementação
        de simulações de Monte Carlo para avaliar o desempenho dos estimadores de
        máxima verossimilhança e dos resíduos, e a aplicação a dados reais.

        Keywords Distribuição Birnbaum-Saunders; Diagnósticos; Máxima verossimi-
        lhança; Modelos tobit.


JEL Codes: C13,C24,C52


Área ANPEC: Microeconomia, Métodos Quantitativos e Finanças

                                                  1
1 Introduction
    The tobit model was proposed by Tobin (1958) for limited dependent (responses)
variables and named tobit by Goldberger (1964), because of its similarity with the pro-
bit model. According to Amemiya (1984), Tobin (1958) was motivated to develop his
model by a case-study where he needed to study the relationship between house-
hold expenditure on a durable good and household incomes. The common regression
approach with ordinary least squares could not be used because there were many
observations where the expenditure was zero, which obviously destroyed the assump-
tion of linearity. To solve the problem, Tobin (1958) proposed a model that could fit
the data appropriately formulating a regression model whose response was limited (or
censored) to a prefixed limiting value.
    Tobit models have been used extensively to describe censored data in economet-
rics. The censoring occurs when the response of the regression model is not directly
observable but its independent variables. Although tobit models were born in eco-
nomics, they have been applied in biology and engineering as well. The biology re-
search relies most in analyzing the survival time of a patient (Leiva et al., 2007); the
engineers use it to model time to failure of various types of materials or machines
(Villegas et al., 2011); whereas the sociologists employ it to describe the duration of
marriage, residing in a particular region or unemployment, as well the time between
births, but the tobit models have also been used to describe inheritance, ratio of un-
employed hours to employed hours and expected age of retirement (Amemiya, 1984).
Tobit models could also be used in environmental sciences, where censored data also
are present (Thorarinsdottir and Gneiting, 2010; Helsel, 2011).
    As mentioned, tobit models have a strong normality assumption. Proposals of tobit
models that relax the assumption of normality are of great importance in empirical
economics, because most of the data available in the real-world cannot be modeled
optimally with a normal distribution. Barros et al. (2010) noticed that the asymmetry
of the data and its kurtosis can be, and usually are, different from the expected for a
normal distribution, so that more flexible models are needed.
    The Birnbaum-Saunders (BS) distribution has been widely studied. It is positively
skewed, has a failure rate with upside-down bathtub shape, and a close relation with
the normal model; see the seminal paper by Birnbaum and Saunders (1969) and the
books by Johnson et al. (1995, pp. 651-663) and Leiva (2016). The BS distribution was
derived in terms of shape and scale parameters, but the latter is also its median. Thus,
the BS distribution can be seen as an analogue to the normal model, but in an asym-
metrical setting, where the median can be a better measure of central tendency than
the mean. The BS distribution has been applied to biological, economic, engineering
and environmental data, which have been conducted by international, transdisciplinary
groups of researchers. Some of its recent applications are attributed to Qu and Xie
(2011), Ferreira et al. (2012), Li et al. (2012), Saulo et al. (2013), Leiva et al. (2014,
2015a,b), Garcia-Papani et al. (2016) and Marchant et al. (2016a,b).
    The main objective of this paper is propose a tobit-BS model by relaxing the as-
sumption of normality and supposing that its errors follow a BS distribution, which ac-
cording to the best of our knowledge, it is a topic that has not been studied before. The
secondary objectives of this paper are: (i) to develop inference for the tobit-BS model

                                            2
based on the maximum likelihood (ML) method; (ii) to derive residuals and global and
local influence tools for model checking and diagnostics. As part of a future extension,
we leave the implementation of Monte Carlo simulations and an application to real
data.
    The paper presents, along with this introduction, five sections. Section 2 provides
a background of classic tobit models and of the BS and log-BS distributions. Section
3 formulates the tobit-BS model along with inference and estimation based on the
ML method. Section 4 derives diagnostics for the proposed model including residuals
analysis and local influence tools. Finally, Section 5 discusses some conclusions and
future works.


2 Background
2.1    The tobit model
    Let Y = (Y1 , . . . , Ym , Ym+1 , . . . , Yn )⊤ be a sample of size n, that is, independent
(IND) random variables but not independent identically distributed (IID) necessarily.
Assume that this sample includes m censored data to the left and n − m observed
(complete or uncensored) data. Thus, such censoring scheme can be visualized un-
der a regression setting with a censored response Y ∗ , which is a (unobserved) latent
variable. Hence, the m censored data (unobserved)correspond to the values of Y ∗
less than or equal to a threshold point y0 (censoring to the left), so that all of these
data take the value y0 . The other n − m data (observed) are related to values of Y ∗
greater than y0 , which can be described by a linear regression structure of the type
x⊤i β. All this modeling environment may be formulated by the normal tobit model with
censored response to the left as
                           (
                             yo ,              if Yi∗ ≤ y0 , i = 1, . . . , m;
                   Yi =                                                                     (1)
                             x⊤ i β + εi ,     if Yi∗ > y0 , i = m + 1, . . . , n;
          IID
where εi ∼ N(0, σ 2 ) is the model error term, β is a vector of regression coefficients
corresponding to unknown parameters to be estimated, and xi is a vector containing
the values of explanatory variables (covariates). Observe that y0 given in (1) is a
prefixed limiting value that does the response of the regression model defined in (1) to
be limited (or censored), as mentioned by Tobin (1958).
   Note the similarity between the normal probit model and the normal tobit model
defined in (1). In the normal probit model, the response is an latent (unobserved)
variable described by
                              Yi∗ = x⊤
                                     i β + εi , i = 1, . . . , n,                    (2)
where xi , β and εi are defined analogously as in (1). As it is not possible to observe
the latent variable Yi∗ , the indicator variable
                               (
                                0, Yi∗ ≤ y0 , i = 1, . . . , m;
                         Yi =                                                       (3)
                                1, Yi∗ > y0 , i = m + 1, . . . , n;


                                              3
is defined, However, instead of using x⊤ β, from (2) and (3), the expected response is
formulated as

       E[Y |x] = P(Y = 1) = P(Y ∗ > y0 ) = P(x⊤ β + ε > y0 ) = 1 − Φ(y0 − x⊤ β),         (4)

where Φ is the cumulative distribution function (CDF) of the standard normal distribu-
tion. Note that other CDFs might be assumed for Φ in (4), so expanding the covering
of the probit model.
    Probit and tobit models are the same for the latent variable (Y ∗ ), but models for the
observed response (Y ) are different. In the tobit model, we know the value of Y ∗ when
Y ∗ > y0 , whereas in the probit model we just know that Y ∗ > y0 , but we do not know
its value. Thus, there is more information in the tobit model than in the probit model.
Also, the estimates of β in the tobit model are more efficient than in the probit model.
Moreover, for the censored cases of the probit model, it is not possible to estimate the
variance of Y ∗ . However, in the tobit model, this variance can be estimated from the
data. For more details, see Scott (1997, p. 199).


2.2   The Birnbaum-Saunders distribution
   If a random variable T follows a BS distribution with shape parameter α and scale
parameter σ, we use the notation T ∼ BS(α, σ). This distribution can be defined by its
CDF given by
                                                
                               1 p       p 
             FT (t; α, σ) = Φ       t/σ − σ/t       , t > 0, α > 0, σ > 0.        (5)
                               α

Then, the probability density function (PDF) of T obtained from (5) is expressed as
                              q                             
                  1 p               3      1 p           p 
 fT (t; α, σ) =        1/σt + σ/t 2 φ            t/σ − σ/t        , t > 0, α > 0, σ > 0,
                 2α                        α
                                                                                       (6)
where φ is the standard normal PDF. Thus, the PDF in (6) can be rewritten as
                                             
                  exp(α−2 )       1     t    σ       3
  fT (t; α, σ) =     √      exp − 2       +       t− 2 (t + σ) , t > 0, α > 0, σ > 0. (7)
                  2α 2πσ         2α     σ    t

Note that the results provided in (5) and (6) may be obtained from the transformation
theorem of random variables by using
                                      q          2
                                              2
                           T = σ αZ/2 + (αZ/2) + 1 ,                                     (8)

where Z ∼ N(0, 1). Also from (8), it may be verified that a continuous random vari-
able Tphas a BS  p distribution
                               with parameters α > 0 and σ > 0, if and only if Z =
(1/α) T /σ − σ/T ∼ N(0, 1). Some properties of the BS distribution are presented
as follows. If T ∼ BS(α, σ), then: (i) E(T ) = σ(1 + α2 /2) and Var(T ) = (ασ)2 (1 + 5α2/4);
(ii) for b > 0, bT ∼ BS(α, bσ), which means that the BS distribution is closed under


                                             4
scalar multiplication (proportionality); (iii) 1/T ∼ BS(α, 1/σ), implying that the BS distri-
bution is closed under reciprocation; (iv) the median of the distribution of T is σ, which
can be directly obtained when q = 0.5 from its quantile function given by
                                                     s                  2
                                                                   2
                                            αz(q)          αz(q)
        t(q; α, σ) = FT−1 (q; α, σ) = σ          +                     + 1 ,    0 < q < 1,
                                              2              2

where z(q) is the standard normal quantile function; and (v) the BS distribution is
positively skewed as α increases and approximately symmetrical around σ as α goes
to zero; see Figure 1(left). Properties of proportionality and reciprocation given above
in (ii) and (iii) are easily verified by using once again the mentioned transformation
theorem.
    The survival function (SF) and hazard rate (HR) of T ∼ BS(α, σ) are given respec-
tively by
                                              r     r !!
                                          1     t      σ
                    ST (t; α, σ) = Φ −            −            ,
                                          α     σ      t
                                       q       p σ  t−3/2 (t+σ)
                                        1    t
                                    φ α      σ
                                               − t        2ασ1/2
                    hT (t; α, σ) =            q     p σ         , t > 0.
                                        Φ − α1    t
                                                  σ
                                                    −    t



2.3    The log-Birnbaum-Saunders distribution
   When modeling data with the BS distribution, its logarithmic version (log-BS) is
needed. A random variable Y has a log-BS distribution with shape (α > 0) and
location (µ ∈ R) parameter, which is denoted by log-BS(α, µ), if and only if Z =
(2/α)sinh((Y − µ)/2) ∼ N(0, 1). Then, the CDF of Y is given by
                                            
                                 2        y−µ
              FY (y; α, µ) = Φ     sinh          , y ∈ R, µ ∈ R, α > 0.         (9)
                                 α         2

Consequently, from (9), the PDF of Y is obtained as
                                                    
                 1          y−µ            2    2   y−µ
 fY (y; α, µ) = √ cosh             exp − 2 sinh            ,                   y ∈ R, µ ∈ R, α > 0,
               α 2π          2            α          2
                                                                                                (10)
whereas that the logarithm of the PDF given in (10) is expressed as
                                                                        
                              log(2π)        2        y−µ      2     2   y−µ
log(fY (y; α, µ)) = − log(2)−         +log     cosh          − 2 sinh          ,               y ∈ R.
                                 2           α         2      α           2
                                                                                       (11)
Some properties of the log-BS distribution are presented as follows. If Y ∼ log-BS(α, µ),
then: (i) T = exp(Y ) ∼ BS(α, σ), which means that the log-BS PDF given in (10) can
be obtained from the standard normal PDF as in (9) or from the BS PDF defined in
(7); (ii) E (Y ) = µ; (iii) there is no closed form for the variance of Y , but based upon


                                                5
an asymptotic approximation for the moment generating function of the log-BS distri-
                                                 2   4
bution, it follows√                 √ Var(T ) = α − α /4, whereas that, if α → ∞, then
                   that, if α → 0, then
                 2
Var(T ) = 4(log ( 2α) + 2 −2 log( 2α)); (iv) if X = ±Y + d, then X ∼ log-BS(α, ±µ + d);
and (v) the log-BS distribution is symmetric around µ, unimodal for α ≤ 2 and bimodal
for α > 2; see Figure 1(right).
             1.5




                                       α = 0.5                                                 α = 0.5




                                                          0.8
                                       α = 1.0                                                 α = 1.0
                                       α = 2.0                                                 α = 2.0
                                       α = 4.0                                                 α = 4.0




                                                          0.6
             1.0




                                                   f(y)
      f(t)




                                                          0.4
             0.5




                                                          0.2
             0.0




                   0   1   2       3        4             0.0   −6   −4       −2   0   2   4        6

                           t                                                       y


Figure 1: PDF of (left) BS(α, 1) and (right) log-BS(α, 0) distributions for the indicated
value of α.



3 The tobit-BS model
3.1          Formulation
   Consider the BS regression model

                               Ti = exp(x⊤
                                         i β)δi ,           i = 1, . . . , n,                            (12)

originally proposed by (Rieck and Nedelman, 1991), where Ti is the response, xi and
β are analogously defined as in (2), and δi ∼ BS(α, 1) is the model error. By applying
logarithm in (12), we obtain

                                Yi = x⊤
                                      i β + εi ,          i = 1, . . . , n,                              (13)

where Yi = log(Ti ) is the log-response i, xi and β are similar to (1), and εi = log(δi ) ∼
log-BS(α, 0) is the error term of the model. Then, based on (1) and (13), we propose a
tobit-BS model as
                      (
                        y0 ,          if Yi∗ ≤ y0 , i = 1, . . . , m,
                 Yi =                                                                 (14)
                        x⊤i β + εi ,  if Yi∗ > y0 , i = m + 1, . . . , n,

where Yi∗ = log(Ti∗ ), and β, xi and εi are given in (13).



                                                 6
3.2     Estimation
   We estimate the parameters of the tobit-BS model defined in (14) with the ML
method, in which case the log-likelihood function for θ = (α, β ⊤ )⊤ obtained from (11)
takes the form
                                      m                   n
                            log(2π) X            c
                                                         X
                                                                           2
                                                                                
 l(θ) = −(n−m) log(2)−(n−m)        +     (log Φ(ζi2 ))+       log(ζi1 ) − ζi2 /2 , (15)
                               2     i=1                i=m+1

where
                                                                                                                           
               2              y0 −x⊤i β                   2              yi −x⊤i β                   2              yi −x⊤i β
       ζi2 =
        c
               α
                   sinh           2
                                              ,   ζi1 =   α
                                                              cosh           2
                                                                                         ,   ζi2 =   α
                                                                                                         sinh           2
                                                                                                                                    .   (16)

To obtain the ML estimators, it is necessary to maximize the log-likelihood given in
(15). The score vector ℓ̇ = ∂ℓ(θ)/∂θ = (ℓ̇α , ℓ̇⊤         ⊤
                                                       β ) , containing the first partial derivatives
of (15), where
      ( λ(ζ c )ζ c                                   (
                                                          x cosh(δ)λ(ζ c )
         − i2α i2 , i = 1, . . . , m;                  − ij α i2 ,                      i = 1, . . . , m;
 ℓ̇α = ζi22 −1                                 ℓ̇β = xij sinh(2δi ) xij tanh(δi )
           α
               ,      i = m + 1, . . . , n;                 α2
                                                                   −         2
                                                                                  , i = m + 1, . . . , n;
                                                                                                            (17)
where δi = y0 − x⊤   i  β/2, if i  =  1,  . . . , m, and   δi  =  y i −  x ⊤
                                                                           i β/2,  if i  =  m   +    1, . . . , n,
and λ(ζi2 ) = φ(ζi2)/Φ(ζi2 ). The ML estimator of θ is obtained equating (17) to zero.
         c         c       c


However, the system of equations defined by these two equations does not have an
analytic solution. Leiva et al. (2007) suggested the use of the Broyden-Fletcher-
Goldfarb-Shanno algorithm, using as a starting values for the numerical procedure
b2 = 4(sinh((yi − x⊤
α                        b      2                     b         ⊤     −1     ⊤
                       i β)/2)) /(n − m) and β = (X X) X y, where X is a matrix
composed by the rows xi . Recall that the log-BS distribution can be bimodal if α > 2.
It implicates that the log-likelihood function has more than one maximum value. How-
ever, Rieck and Nedelman (1991) and Leiva (2016) argued that α > 2 is unusual in
practice, which means that the maximum point is often unique.


3.3     Inference
    Assuming that the regularity conditions defined in Cox and Hinkley (1974) are sat-
                          b and βb are consistent and follow a multivariate normal joint
isfied, the ML estimators α
asymptotic distribution. This distribution has an asymptotic mean vector with elements
α and β and have an asymptotic covariance matrix equal to J (θ)−1 , which can be
approximated by the expected Fisher information matrix. Therefore, as n → ∞, we
have that               √                                     
                                        d
                          n(θb − θ) → Np+1 0p+1 , J (θ)−1 ,                        (18)
where J (θ) = limn→∞ (1/n)I(θ), with I(θ) being the expected Fisher information ma-
                    d
trix. In addition, → means convergence in distribution to and 0p+1 is a p × 1 vector of
                   b −1 is a consistent estimator of the asymptotic variance-covariance
zeros. Note that I(θ)
           b J (θ)−1 say. In practice, one may approximate the expected Fisher infor-
matrix of θ,
mation matrix by its observed version (Efron and Hinkley, 1978), whereas the elements


                                                                     7
of the diagonal of the inverse of the observed information matrix can be used to ap-
proximate the corresponding standard errors (SEs). The observed Fisher information
matrix is obtained from the Hessian matrix, which contains the second partial deriva-
tives of (15) and given by                          
                                      tr(G)  k⊤ X
                              ℓ̈ =                     ,                        (19)
                                      X ⊤k X ⊤V X
where V = diag{v1 (θ), v2 (θ), v3 (θ), . . . , vn (θ)}, k = (k1 (θ), k2(θ), k3 (θ), . . . , kn (θ))⊤
and G = diag{g1 (θ), g2 (θ), g3 (θ), . . . , gn (θ)}, with
          (              c )
            sinh(δi )λ(ζi2        c ζ c cosh(δ )λ(ζ c )
                                 ζi1          i              cosh2 (δi )λ2 (ζi2
                                                                              c )

                   2α
                             −       i2
                                           2α
                                                     i2
                                                         −          α  2          ,    i = 1, . . . , m;
 vi (θ) =   1                2       1
                                                                                                                     (20)
            4
              (sech(δi )) ) − α2 cosh(2δi ),                                           i = m + 1, . . . , n;
          (
               1               c 2 c        λ(ζ c ) cosh(δ )     ζc
            − 2α   λ(ζi2
                       c
                          )(ζi2 ) ζi1 + i2 α2 i − αi22 λ2 (ζi2               c
                                                                                ) cosh(δi ),       i = 1, . . . , m;
 ki (θ) =      2
                                                                                                                     (21)
            − α3 sinh(2δi ),                                                                       i = m + 1, . . . , n;
          ( ζc
                         c 2
            − αi22 (((ζi2  ) λ(ζi2 c
                                     ) + ζi2c
                                              λ2 (ζi2 c
                                                        )) − 2λ(ζi2   c
                                                                         )),        i = 1, . . . , m;
 gi (θ) =    1      3ζi2                                                                                             (22)
            α2
                − α2 ,                                                              i = m + 1, . . . , n.

and ζi1 , ζi2 and ζi2 c
                        presented in (16), whereas ζi1  c
                                                          = (2/α) cosh((y0 − x⊤
                                                                              i β)/2), for
i = 1, . . . , m. Asymptotic inference for the tobit-BS model parameters can be made by
using the results given in (18) and (19).


4 Diagnostic analysis
4.1      Residual analysis
    The objective of the residual analysis is to assess if the errors hold the distribu-
tional, heteroscedasticity and autocorrelation assumptions, as well the presence of
atypical data. In classic regression models, Pearson and studentized residuals are
often used. However, in tobit models, in general, even under normality, these type of
residuals are inadequate Barros et al. (2010). For the tobit-BS model, we propose a
deviance component (DC) and martingale-type (MT) residuals. These residuals are
often used in generalized linear models and survival analysis, respectively.
    In general, the DC residual is defined as (McCullagh and Nelder, 1989)
                                    q
                                                       b
                     ri = sign(2δi ) 2(ℓi (θbs ) − ℓi (θ)),
                      DC
                                                            i = 1, . . . , n,

where ℓi (θ) represents the log-likelihood function for the case i, θbs is the ML estimate
of θ for the saturated model (a model with n parameters), θ is the ML estimate of the
model of interest, and µ bi is the expected value of Yi , E(Yi ) say. Davison and Gigli
(1989) specified the DC residual for censored data as
                                    q
                     ri = sign(2δi ) −2 log(SbY (yi ; θ)), i = 1, . . . , n
                      DC
                                                                                       (23)



                                                           8
where SbY is the corresponding SF of the model and the sign function is defined as
sign(x) = {−1, 0, 1}, for x < 0, x = 0 and x > 0, respectively. For the tobit-BS model
and from (23), the DC residual using is described as
                       q
             sign(2δb ) −2 log (Φ(− 2 sinh(δb ))), i = 1, . . . , m;
                      i                α       i
      riDC =            q              b
                                                                                    (24)
             sign(2δb ) 2 log (cosh(δb )) + 2 (sinh(δb ))2 , i = m + 1, . . . , n.
                       i                   i      α2           i


The MT residual in defined as
                               p
              riMT = sign(riM ) −2(riM + ηi log(ηi − riM )),              i = 1, . . . , n,   (25)

where riM is the martingale residual given by

                            riM = ηi + log (SbY (yi )),       i = 1, . . . , n,               (26)

with SbY being the ML estimate for the SF of Y (Klein and Moeschberger, 1997; Ortega
et al., 2003). For the tobit-BS model and from (26), the martingale residual takes the
form
                       riM = ηi + log(Φ( αb2 sinh(δbi ))), i = 1, . . . , n,      (27)
where ηi = 0 indicates that the case i is censored, whereas ηi = 1 indicates that the
case i is uncensored. Barros et al. (2010) noted that the MT residual does not repre-
sent the deviance component of the tobit model, instead it merely is a transformation of
the martingale residual that produces symmetrically distributed residuals around zero.
For more details, the interested reader can see Therneau et al. (1990), Leiva et al.
(2007) and Barros et al. (2010).


4.2    Global influence
   A global influence method commonly used in statistical modeling is the Cook dis-
tance, which allows us to assess the effect of each case on the estimated parameters.
The methodology proposed by Cook (1977) and Cook and Weisberg (1982) suggests
the deletion of each observation and the evaluation of the log-likelihood function with-
out the case i. The generalized Cook distance (GCD) for a standard tobit model was
given by Barros et al. (2010) and it takes the form
                                 1 b b
                  GCDi (θ) =        (θ − θ(i) )ℓ̈−1 (θb − θb(i) ),        i = 1, . . . , n,   (28)
                                p+1

where p is the number of model coefficients and θbi is the ML estimate of θ without the
case i. In order to facilitate the calculations, a first order approximation θb − θbi ≈ ℓ̈−1
                                                                                          (i) ℓ̇(i)
is used in (28) and it becomes
                                  1
                    GCDi (θ) =       (ℓ̇⊤     −1         −1
                                        (i) ℓ̈(i) (−ℓ̈)ℓ̈(i) ℓ̇(i) ),   i = 1, . . . , n,     (29)
                                 p+1

where ℓ̇(i) and ℓ̈(i) are the score vector and the Hessian matrix from the tobit-BS model
defined in (17) and (19), respectively. Without the use of the approximation described

                                                    9
in (29), we must calculate the GCD eliminating each case. However, with this approx-
imation, we need to calculate the GCD just once. Usually, the diagnostics analysis
relies on the vector β of coefficients. Then, in that case, (28) becomes
                            1
                  GCDi (β) = (βb − βb(i) )ℓ̈−1 (βb − βb(i) ),      i = 1, . . . , n.   (30)
                            p
To determine whether the case i is potentially influential on β, we use the same bench-
mark used by Zhu and Zhang (2004) and Barros et al. (2010), which is 2/n. If the value
of the GCD for the case i is greater than 2/n, the case i is potentially influential on the
estimated vector of parameters.


4.3   Local Influence
    One way to assess the effect produced by one case on the ML estimates is the
deletion of each of them from the data set and then evaluate if it exercises influence
on the estimates or not. This approach is known as global influence. However, the
local influence method relies on a geometric differentiation, taking the curvature of
the plane of the log-likelihood function. This method does not require any deletion.
Often the differential comparison is made before and after a perturbation. There are
many ways to conduct a local influence analysis. We use case-weight, response and
covariate perturbation schemes.
                                 ⊤
    Recalling that θ = (α, β ⊤ ) is the vector of parameter, let ℓ(θ|ω) be the log-
likelihood function of the model defined in (14) perturbed by ω, where ω is a subset of
Ω ∈ Rn . One way to evaluate the influence of a perturbation over the estimates of θ is
to use the likelihood displacement (LD), which is given by
                                             b − ℓ(θbω )),
                                 LD(ω) = 2(ℓ(θ)                                        (31)

where θbω is the ML estimate of θ based on ℓ(θ|ω). To detect what case exercises
influence on LD(ω) defined in (31), we use the normal curvature in the direction of
the vector l, with ||l|| = 1. The normal curvature given by Barros et al. (2010) can be
expressed as
                                  Cl (θ) = 2|l⊤ ∆⊤ ℓ̈−1 ∆l|,                       (32)
where ∆ is a matrix of perturbations and ℓ̈ is the Hessian matrix given in (19). The
matrix ∆ has elements
                    ∂ 2 ℓ(θ|ω)/∂θj ∂ωi ,   j = 1, . . . , p + 1, i = 1, . . . , n,

and must be evaluated at θ = θb and ω = ω0 , where ω0 is a non-perturbation vector.
To determine what case are influential under small perturbations, Barros et al. (2010)
proposed an index plot based on the eigenvector of lmax , which can be constructed by
using the maximum eigenvalue of
                                     B(θ) = |∆⊤ ℓ̈−1 ∆|,                               (33)
                 b On the one hand, if the interest relies just on the vector of param-
evaluated at θ = θ.
eter β, (32) becomes
                          Cl (θ) = 2|l⊤ ∆⊤ (ℓ̈−1 − B1 )∆l|.                         (34)

                                               10
Note that (34) removes α from the analysis. Thus, the influence detection is only made
on β, where B1 under a tobit-BS model takes the form
                                                   
                                       tr(G)−1 0
                               B1 =                   .                            (35)
                                           0     0

On the other hand, if the interest is just on α, (32) becomes

                             Cl (θ) = 2 l⊤ ∆⊤ (ℓ̈−1 − B2 )∆l ,                          (36)

where B2 for the tobit-BS model is given by
                                                   
                                      0       0
                            B2 =                      ,                                 (37)
                                      0 (X ⊤ V X)−1

with tr(G) and (X ⊤ V X)−1 being obtained from the Hessian matrix of the tobit-BS
model given in (19).
    The maximum normal curvature vector, denoted by lmax , is an important direction
                                  b however it is not the only one. The vector li = ein
to assess the local influence on θ,
denotes the direction of the case i, where ein is the canonical basis of Rn . It assumes
zero for every case except the case i, which assumes the value one. The normal
curvature of each observation is given by Ci (θ) = 2|bii |, where bii represents the ith
element of the matrix defined in (33) for each observation. A observation is potentially
                               b where C(θ)
                        b > 2C(θ),
influential on θ if Ci (θ)                   b is the mean of the Ci ‘s for i = 1, . . . , n;
see Lesaffre and Verbeke (1998). Below we present three perturbation schemes and
each of their corresponding perturbation matrix ∆

Case-weight Perturbation The case-weight perturbation scheme allows us to eval-
uate the cases that, under different weights, affect P   the ML estimates of θ. Suppose
that the log-likelihood function is given by ℓ(θ|ω) = n=1 ωi ℓi , with ℓi given in (15) and
ωi ∈ [0, 1] is a perturbation vector. Considering the partial derivative with respect to
ω ⊤ , we obtain
                                               m
                                  ∂ℓ(θ|ω) X
                                           =      ℓi (θ)e⊤
                                                         in ,
                                    ∂ω ⊤      i=1

with e⊤
      in denoting a n × 1 vector.
   After evaluating θ at θb we obtain a perturbation matrix
                                             n
                                             X
                                      ∆=           hi e⊤
                                                       in ,                             (38)
                                             i=1

where hi is given by                                       !
                                               ∂ℓi (θ)
                                      hi =       ∂α
                                               ∂ℓi (θ)
                                                ∂β
                                                       .




                                             11
From the log-likelihood function defined in (15) we obtain a explicit expression for hi ,
which is
                                  (
                                      λ(ζ c )ζ c
                                    − i2α i2            i = 1, . . . , m,
               ℓ̇αi (θ|ω) = ai =      1          2
                                    − α (1 + ζi2 )      i = m + 1, . . . , n,
                                  ( λ(ζ c )ζ c
                                   − i22 i1                i = 1, . . . , m,
               ℓ̇βi (θ|ω) = bi = 1                   
                                    2
                                       ζi1 ζi2 − ζζi1
                                                   i2
                                                           i = m + 1, . . . , n.

The case-weight perturbation matrix given by ∆ in (38) can be decomposed in ∆α =
(a1 , . . . , an ) and ∆β = X ⊤ diag{b1 , . . . , bn }.

Response perturbation There are different scenarios that one can consider for the
response perturbation. We consider here a response perturbation scheme with an
additive perturbation, which is defined by

                             Yiω = Yi + ωi SY , i = m + 1, . . . , n,

where SY is a scale component that can be the standard deviation of the response. Let
Pnconsider that the log-likelihood function of the tobit-BS model is given by ℓ(θ|ω) =
us
   i=1 ℓi (θ|ω), with
            (P
                m
                i=1 (log Φ(ζi2ω1 )),                            i = 1, . . . , m;
                             c

 ℓi (θ) =                 log(2π)    Pn             1 2
                                                                                     (39)
             − log(2) − 2 + i=m+1 log(ζi1ω1 ) − 2 (ζi2ω1 ) ,    i = m + 1, . . . , n;

where ζi1ω1 , ζi2ω1 , ζi2ω1
                       c
                            are as defined in (16) after changing Y for Yiω . The process of
obtaining the perturbation matrix in this scheme is composed by two steps, first the
derivative of (39) with respect to ω ⊤ is taken, i.e.,
                              ( ⊤
              ∂ℓi (θ|ωi )       0n ,                        i = 1, . . . , m,
                            =   SY    ζi2ω1                                             (40)
                 ∂ω ⊤            2    ζi1ω1
                                              − ζi2ω1 ζi1ω1 , i = m + 1, . . . , n.

Then, the partial derivative of (40) with respect to θ is computed and evaluated at
    b to obtain the response perturbation matrix ∆ with elements
θ = θ,

                    ∆α = (c1 , . . . , cm ),   ∆β = X ⊤ diag{d1 , . . . , dm },

where                                                                           
                     SY ζi1 ζi2                    1              1            2
                ci =            ,   d i = SY          cosh(2δi ) − (sech (δi )) .
                        α                          α2             4
Note that the response perturbation scheme, in a tobit model, makes sense only for
the non-censored part of the data. This occurs because the censored part of the data
is either unobservable or below the threshold y0 , otherwise, the case i receives the
same value y0 . Then, there is no perturbation in this part of the data.




                                                   12
Covariate Perturbation As in the response scheme there are several ways to insert
covariate perturbation. Here, we insert an additive perturbation that takes the form
                                   xitω = xit + sX ωi ,       i = 1, . . . , n,
where SX can be the standard deviation of the correspond covariate of the P    model. Con-
sidering the log-likelihood function for the tobit-BS model to be ℓ(θ|ω) = ni=1 ℓi (θ|ω)
from (15), we obtain
           (P
               m
               i=1 (log Φ(ζi2ω2 ))                                 i = 1, . . . , m;
                            c

ℓi (θ|ω) =               log(2π)   Pn                  1 2
                                                                                        (41)
            − log(2) − 2 + i=m+1 log(ζi1ω2 ) − 2 (ζi2ω2 )          i = m + 1, . . . , n.

In order to obtain the perturbation matrix of (41) we take the derivative with respect to
θ and then with respect to ω, and then we evaluate at θ = θb to obtain
             (            c c                       c ) sinh (2δ )          c
                                                                                 
                 Sx βt     ζi1 λ(ζi2 )            2λ(ζi2          i       λ2 ζi2
               − α              2
                                       − ζi2  c
                                                         α2
                                                                       + 2          ,     i = 1, . . . , m;
    ∆α =
                  2
               − 3 Sx βt sinh(2δi ),                                                      i = m + 1, . . . , n
              α             c c 2 c                                                   
                 Sx βt xij    λ(ζi2 )(ζi1 ) ζi2        c 2 2
             − 4
                                                + (ζi2   ) λ (ζi2     ) − λ(ζi2   )ζi2
                                                                    c            c    c
                                        c )
                                    Φ(ζi2
                      c λ(ζ c )
                  Sx ζi2
    ∆β =       −            i2
                                ,                                                            i = 1, . . . , m;
                       2
             S β x 1 (sech (δ ))2 − 1 cosh(2δ ) ,
             
                                                                                             i = m + 1, . . . , n,
                 x t ij 4                   i        α2               i

where ∆β is a matrix p × n with elements ∆βij and j 6= t, for j = t, ∆βij becomes
                   c c 2 c                                                    c λ(ζ c )
         Sx βt xij   λ(ζi2 )(ζi1 ) ζi2                                       Sx ζi2
     
      −                                +  (ζ  c 2 2
                                                 ) λ  (ζ c
                                                            ) − λ(ζ i2 i2 −
                                                                    c
                                                                      )ζ c            i2
     
            4                c
                         Φ(ζi2 )              i2         i2                        2
      Sx xij
       − α (cosh(2δi )λ(ζi2          c
                                        )) ,                                               i = 1, . . . , m;
∆β =                                                          
     
                  1                  2      1
       Sx βt xij 4 (sech (δi )) − α2 cosh(2δi )
     
                                                   
     
       +Sx α12 sinh(2δi ) − 12 tanh (δi ) ,                                                i = m + 1, . . . , n.


5 Concluding remarks
    It is widely known that the normal distribution does not model perfectly a consid-
erable part of real data sets. In this paper, we have proposed an extension of the
standard tobit model, the tobit-BS model, by assuming a Birnbaum-Saunders distribu-
tion. We have discussed maximum likelihood estimation of the model parameters. We
have also provided global and local influence tools for the tobit-BS model. In special,
as a global influence tool we have derived the generalized Cook distance, and for local
influence procedures we have derived the normal curvatures under different pertur-
bation schemes. Research regarding the implementation of Monte Carlo simulations
and the application to real data is currently in progress and we hope to report some
findings in a future paper.


References
Amemiya, T. (1984). Tobit models: A survey. Journal of Econometrics, 24:3–61.

                                                       13
Barros, M., Galea, M., Gonzalez, M., and Leiva, V. (2010). Influence diagnostics in the Tobit
  censored response model. Statistical Methods and Applications, 19:379–397.

Birnbaum, Z. W. and Saunders, S. C. (1969). A new family of life distributions. Journal of
   Applied Probability, 6:319–327.

Cook, R. D. (1977). Detection of influential observation in linear regression. Technometrics,
  19:15–18.

Cook, R. D. and Weisberg, S. (1982). Residuals and Influence in Regression. Chapman and
  Hall, London, UK.

Cox, D. and Hinkley, D. (1974). Theoretical Statistics. Chapman and Hall, London, UK.

Davison, A. and Gigli, A. (1989). Deviance residuals and normal scores plots. Biometrika,
  76:211–221.

Efron, B. and Hinkley, D. (1978). Assessing the accuracy of the maximum likelihood estimator:
  Observed vs. expected Fisher information. Biometrika, 65:457–487.

Ferreira, M., Gomes, M. I., and Leiva, V. (2012). On an extreme value version of the Birnbaum-
  Saunders distribution. REVSTAT Statistical Journal, 10:181–210.

Garcia-Papani, F., Uribe-Opazo, M., Leiva, V., and Aykroyd, R. (2016). Birnbaum-Saunders
  spatial modelling and diagnostics applied to agricultural engineering data. Stochastic Envi-
  ronmental Research and Risk Assessment, pages in press available at http://dx.doi.
  org/10.1007/s00477--015--1204--4.

Goldberger, A. (1964). Econometric Theory. Wiley, New York, US.

Helsel, D. R. (2011). Statistics for Censored Environmental Data Using Minitab and R. Wiley,
  New York, US.

Johnson, N., Kotz, S., and Balakrishnan, N. (1995). Continuous Univariate Distributions, vol-
  ume 2. Wiley, New York, US.

Klein, J. and Moeschberger, M. (1997). Survival Analysis: Techniques for Censored and Trun-
  cated Data. Springer, New York, US.

Leiva, V. (2016). The Birnbaum-Saunders Distribution. Academic Press, New York, US.

Leiva, V., Barros, M., Paula, G., and Galea, M. (2007). Influence diagnostics in log-Birnbaum-
  Saunders regression models with censored data. Computational Statistics and Data Analy-
  sis, 51:5694–5707.

Leiva, V., Marchant, C., Ruggeri, F., and Saulo, H. (2015a). A criterion for environmental
  assessment using Birnbaum-Saunders attribute control charts. Environmetrics, 26:463–
  476.

Leiva, V., Rojas, E., Galea, M., and Sanhueza, A. (2014). Diagnostics in Birnbaum-Saunders
  accelerated life models with an application to fatigue data. Applied Stochastic Models in
  Business and Industry, 30:115–131.



                                             14
Leiva, V., Tejo, M., Guiraud, P., Schmachtenberg, O., Orio, P., and Marmolejo, F. (2015b). Mod-
  eling neural activity with cumulative damage distributions. Biological Cybernetics, 109:421–
  433.

Lesaffre, E. and Verbeke, G. (1998). Local influence in linear mixed models. Biometrics,
  54:570–582.

Li, A., Chen, Z., and Xie, F. (2012). Diagnostic analysis for heterogeneous log-Birnbaum-
   Saunders regression models. Statistical and Probability Letters, 89:1690–1698.

Marchant, C., Leiva, V., and Cysneiros, F. (2016a). A multivariate log-linear model for
 Birnbaum-Saunders distributions. IEEE Transactions on Reliability, page in press available
 at http://dx.doi.org/10.1109/TR.2015.2499964.

Marchant, C., Leiva, V., Cysneiros, F., and Vivanco, J. (2016b). Diagnostics in multivariate
 generalized Birnbaum-Saunders regression models. Journal of Applied Statistics, page in
 press available at http://dx.doi.org/10.1080/02664763.2016.1148671.

McCullagh, P. and Nelder, J. (1989). Generalized Linear Models. Chapman and Hall, London,
 UK.

Ortega, E., Bolfarine, H., and Paula, G. (2003). Influence diagnostics in generalized log-
  gamma regression models. Computational Statistics and Data Analysis, 42:165–186.

Qu, H. and Xie, F. (2011). Diagnostics analysis for log-Birnbaum-Saunders regression models
  with censored data. Statistica Neerlandica, 65:1–21.

Rieck, J. and Nedelman, J. (1991). A log-linear model for the Birnbaum-Saunders distribution.
  Technometrics, 3:51–60.

Saulo, H., Leiva, V., Ziegelmann, F. A., and Marchant, C. (2013). A nonparametric method for
  estimating asymmetric densities based on skewed Birnbaum-Saunders distributions applied
  to environmental data. Stochastic Environmental Research and Risk Assessment, 27:1479–
  1491.

Scott, J. (1997). Regression Models of Categorical and Limited Dependent Variables. Sage,
  California, US.

Therneau, T., Grambsch, P., and Fleming, T. (1990). Martingale-based residuals for survival
  models. Biometrika, 77:147–160.

Thorarinsdottir, T. L. and Gneiting, T. (2010). Probabilistic forecasts of wind speed: Ensemble
  model output statistics by using heteroscedastic censored regression. Journal of the Royal
  Statistical Society A, 173:371–388.

Tobin, J. (1958). Estimation of relationships for limited dependent variables. Econometrica,
  26:24–36.

Villegas, C., Paula, G., and Leiva, V. (2011). Birnbaum-Saunders mixed models for censored
   reliability data analysis. IEEE Transactions on Reliability, 60:748–758.

Zhu, H. and Zhang, H. (2004). A diagnostic procedure based on local influence. Biometrika,
  91:579–589.


                                              15
